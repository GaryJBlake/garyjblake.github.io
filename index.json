[{"body":"","link":"http://jadenetworksolutions.co.uk/","section":"","tags":null,"title":""},{"body":"","link":"http://jadenetworksolutions.co.uk/tags/api/","section":"tags","tags":null,"title":"API"},{"body":"","link":"http://jadenetworksolutions.co.uk/categories/","section":"categories","tags":null,"title":"Categories"},{"body":"If your not already familiar with the Intelligent Logging and Analytics for VMware Cloud Foundation validated solution it’s primary purpose is to provide logging, analytics and reporting for VMware Cloud Foundation infrastructure components.\nThis is achieved through the deployment of vRealize Log Insight and the configuration of it's content packs to collect log data from ESXi, vCenter Server, NSX-T Data Center, SDDC Manager, vRealize Suite Lifecycle Manager, and Workspace ONE Access.\nThe roles and personas documented (here) should be considered as a minimum requirement when implementing the Intelligent Logging and Analytics validated solution but there is nothing stopping customers adding more granular roles where possible or even personas that better align with their own organizations roles and responsibilities.\nNow you have a better understanding of what the Intelligent Logging and Analytics for VMware Cloud Foundation validated solution provides let’s look at how we can automate the implementation. Each validated solution provides both UI and Infrastructure-as-code based procedures. The Infrastructure-as-code method is delivered through the use of a PowerShell module specifically created to support validated solutions called PowerValidatedSolutions, each UI based procedure has a PowerShell cmdlet equivalent that not only performs the operation but ensures pre and post validation checks are performed to provide robustness.\nIncluded with the PowerValidatedSolution PowerShell module which can be installed directly from the Microsoft PS Gallery there is a SampleScripts folder and contained within that a folder named ila which contains sample .ps1 script files. These sample scripts demonstrate linking multiple procedures into a single executable script using the Planning and Preparation Workbook as the input for all data.\nFor the Intelligent Logging and Analytics validated solution this is broken down into the following two phases and therefore two scripts are provided:\nDeploy and Configure vRealize Log Insight Configure VMware Cloud Foundation Components As already mentioned the scripts use the Planning and Preparation Workbook to obtain all the required inputs, this is the first step in the execution. The script checks that the path provided to the workbook is valid and then opens the workbook, reading the required information using named cells.\nOnce that step is complete it begins the process of executing each procedure based on the order of steps defined within the implementation guide.\nIn addition to providing the main cmdlets supporting the validated solution implementation procedures a number of cmdlets are included that provide supporting capabilities which are utilized by the scripts.\nStart-SetupLogFile - this cmdlet is used to configure a log file where the output of each step is logged. Write-LogMessage - this cmdlet is used to format the output of messages both to the console and log file. Debug-CatchWriter - this cmdlet is used to provide a consistent way of displaying exception errors should they occur. For each procedure executed by the script, the output is captured into variables and then redirected to the Write-LogMessage cmdlet for display to the console and log in a consistent way. There are three types of output messages:\nINFO - Used for informational messages and successful execution of a procedure. WARNING - Used when a procedure is skipped due to the process already being executed. ERROR - Used to display a failure along with the failure reason. Let’s now take a deeper look at the scripts.\nDeploy and Configure vRealize Log Insight (ilaDeployVrealizeLogInsight.ps1) The ilaDeployVrealizeLogInsight.ps1 script automates all the procedures associated with the deployment and configuration of vRealize Log Insight which includes:\nAdding vRealize Log Insight License to vRealize Suite Lifecycle Manager Importing the vRealize Log Insight Certificate to vRealize Suite Lifecycle Manager Adding the vRealize Log Insight Admin Password to vRealize Suite Lifecycle Manager Deploying vRealize Log Insight by Using vRealize Suite Lifecycle Manager Creating Virtual Machine and Template Folder for vRealize Log Insight Moving the vRealize Log Insight Virtual Machines to the Dedicated Folder Configuring a vSphere DRS Anti-Affinity Rule for vRealize Log Insight Creating a VM Group and Define the Startup Order of the vRealize Log Insight Cluster Adding the vRealize Log Insight Virtual Machines to the First Availability Zone VM Group Configuring SMTP for vRealize Log Insight Configuring Log Retention and Archiving for vRealize Log Insight Activating Authentication for vRealize Log Insight by Using Workspace ONE Access Syncing Active Directory Groups to Workspace ONE Access Assigning vRealize Log Insight Roles to Active Directory Groups Execution of the ilaDeployVrealizeLogInsight.ps1 script is performed by using the following command:\n1.\\SampleScripts\\ila\\ilaDeployVrealizeLogInsight.ps1 -sddcManagerFqdn sfo-vcf01.sfo.rainpole.io -sddcManagerUser administrator@vsphere.local -sddcManagerPass VMw@re1! -workbook F:\\vvs\\PnP.xlsx -filePath F:\\vvs Configure VMware Cloud Foundation Components (ilaConfigureVrealizeLogInsight.ps1) The ilaConfigureVrealizeLogInsight.ps1 script automates the deployment and configuration of the VMware Cloud Foundation components. This includes:\nConnecting a VI Workload Domain to vRealize Log Insight Configuring the NSX Edge Nodes to Forward Log Events to vRealize Log Insight Installing and Configuring the vRealize Log Insight Agent on the Clustered Workspace ONE Access Nodes Configuring the vRealize Log Insight Agent Group for the Clustered Workspace ONE Access Creating a vRealize Log Insight Photon OS Agent Group for the Management Nodes Execution of the ilaConfigureVrealizeLogInsight.ps1 script is performed by using the following command:\n1.\\SampleScripts\\ila\\ilaConfigureVrealizeLogInsight.ps1 -sddcManagerFqdn sfo-vcf01.sfo.rainpole.io -sddcManagerUser administrator@vsphere.local -sddcManagerPass VMw@re1! -workbook F:\\vvs\\PnP.xlsx -filePath F:\\vvs After execution of these scripts in the order described above, and assuming that each step completed successfully your environment is fully configured based on the design and implementation procedures documented within the Intelligent Logging and Analytics for VMware Cloud Foundation validated solution.\n","link":"http://jadenetworksolutions.co.uk/post/vvs/vvs-end-to-end-ila/","section":"post","tags":["API","PowerShell","VVS","ILA"],"title":"End-to-End Automation of Intelligent Logging and Analytics Validated Solution"},{"body":"","link":"http://jadenetworksolutions.co.uk/tags/ila/","section":"tags","tags":null,"title":"ILA"},{"body":"","link":"http://jadenetworksolutions.co.uk/post/","section":"post","tags":["index"],"title":"Posts"},{"body":"","link":"http://jadenetworksolutions.co.uk/tags/powershell/","section":"tags","tags":null,"title":"PowerShell"},{"body":"","link":"http://jadenetworksolutions.co.uk/categories/powervcf/","section":"categories","tags":null,"title":"PowerVCF"},{"body":"","link":"http://jadenetworksolutions.co.uk/tags/","section":"tags","tags":null,"title":"Tags"},{"body":"","link":"http://jadenetworksolutions.co.uk/categories/vmware-validated-solutions/","section":"categories","tags":null,"title":"VMware Validated Solutions"},{"body":"","link":"http://jadenetworksolutions.co.uk/tags/vvs/","section":"tags","tags":null,"title":"VVS"},{"body":"","link":"http://jadenetworksolutions.co.uk/tags/dri/","section":"tags","tags":null,"title":"DRI"},{"body":"If your not already familiar with the Developer Ready Infrastructure for VMware Cloud Foundation validated solution it’s primary purpose is to provide enterprise grade infrastructure, suitable for developers to consume for the deployment of modern applications, using VMware Cloud Foundation as its foundational layer.\nThe Developer Ready Infrastructure validated solution achieves this by walking you through the configuration of each of the required components including NSX-T Data Center, vSphere Storage Policies, vSphere Tanzu and more.\nThe roles and personas documented (here) should be considered as a minimum requirement when implementing the Developer Ready Infrastructure validated solution but there is nothing stopping customers adding more granular roles where possible or even personas that better align with their own organizations roles and responsibilities.\nNow you have a better understanding of what the Developer Ready Infrastructure for VMware Cloud Foundation validated solution provides let’s look at how we can automate the implementation. Each validated solution provides both UI and Infrastructure-as-code based procedures. The Infrastructure-as-code method is delivered through the use of a PowerShell module specifically created to support validated solutions called PowerValidatedSolutions, each UI based procedure has a PowerShell cmdlet equivalent that not only performs the operation but ensures pre and post validation checks are performed to provide robustness.\nIncluded with the PowerValidatedSolution PowerShell module which can be installed directly from the Microsoft PS Gallery there is a SampleScripts folder and contained within that a folder named dri which contains sample .ps1 script files. These sample scripts demonstrate linking multiple procedures into a single executable script using the Planning and Preparation Workbook as the input for all data.\nFor the Developer Ready Infrastructure validated solution this is broken down into the following two phases and therefore two scripts are provided:\nDeploy and Configure the Supervisor Cluster Deploy a Tanzu Kubernetes Cluster As already mentioned the scripts use the Planning and Preparation Workbook to obtain all the required inputs, this is the first step in the execution. The script checks that the path provided to the workbook is valid and then opens the workbook, reading the required information using named cells.\nOnce that step is complete it begins the process of executing each procedure based on the order of steps defined within the implementation guide.\nIn addition to providing the main cmdlets supporting the validated solution implementation procedures a number of cmdlets are included that provide supporting capabilities which are utilised by the scripts.\nStart-SetupLogFile - this cmdlet is used to configure a log file where the output of each step is logged. Write-LogMessage - this cmdlet is used to format the output of messages both to the console and log file. Debug-CatchWriter - this cmdlet is used to provide a consistent way of displaying exception errors should they occur. For each procedure executed by the script, the output is captured into variables and then redirected to the Write-LogMessage cmdlet for display to the console and log in a consistent way. There are three types of output messages:\nINFO - Used for informational messages and successful execution of a procedure. WARNING - Used when a procedure is skipped due to the process already being executed. ERROR - Used to display a failure along with the failure reason. Let’s now take a deeper look at the scripts.\nDeploy and Configure the Supervisor Cluster (driConfigureSupervisorCluster.ps1) The driConfigureSupervisorCluster.ps1 script automates all the procedures associated with the configuration of vSphere, NSX-T Data Center and deploying the Supervisor Cluster. This includes:\nNSX-T Data Center\nAdding a Network Segment Adding IP Prefix Lists Creating a Route Map on the Tier-0 Gateway vSphere\nAssigning a New Tag to the vSAN Datastore Creating a Storage Policy that Uses the New vSphere Tag Creating a Subscribed Content Library Supervisor Cluster\nDeploying a Supervisor Cluster Replacing the Supervisor Cluster Kubernetes API Endpoint Certificate Licensing the Supervisor Cluster Deploying a Supervisor Namespace Assigning the Supervisor Namespace Roles to Active Directory Groups Activating the Registry Service on the Supervisor Cluster Execution of the driConfigureSupervisorCluster.ps1 script is performed by using the following command:\n1.\\SampleScripts\\dri\\driConfigureSupervisorCluster.ps1 -sddcManagerFqdn sfo-vcf01.sfo.rainpole.io -sddcManagerUser administrator@vsphere.local -sddcManagerPass VMw@re1! -workbook F:\\vvs\\PnP.xlsx -filePath F:\\vvs Deploy a Tanzu Kubernetes Cluster (driDeployTanzuCluster.ps1) The driDeployTanzuCluster.ps1 script automates the deployment and configuration of a Tanzu Kubernetes Cluster. This includes:\nDeploying a Namespace for the Tanzu Kubernetes Cluster Assigning the New Tanzu Cluster Namespace Roles to Active Directory Groups Adding a Virtual Machine Class for the Tanzu Kubernetes Cluster Provisioning a Tanzu Kubernetes Cluster Execution of the driDeployTanzuCluster.ps1 script is performed by using the following command:\n1.\\SampleScripts\\dri\\driDeployTanzuCluster.ps1 -sddcManagerFqdn sfo-vcf01.sfo.rainpole.io -sddcManagerUser administrator@vsphere.local -sddcManagerPass VMw@re1! -workbook F:\\vvs\\PnP.xlsx -filePath F:\\vvs After execution of these scripts in the order described above, and assuming that each step completed successfully your environment is fully configured based on the design and implementation procedures documented within the Developer Ready Infrastructure for VMware Cloud Foundation validated solution.\n","link":"http://jadenetworksolutions.co.uk/post/vvs/vvs-end-to-end-dri/","section":"post","tags":["API","PowerShell","VVS","DRI"],"title":"End-to-End Automation of Developer Ready Infrastructure Validated Solution"},{"body":"","link":"http://jadenetworksolutions.co.uk/series/","section":"series","tags":null,"title":"Series"},{"body":"","link":"http://jadenetworksolutions.co.uk/series/vvs-whats-new/","section":"series","tags":null,"title":"VVS Whats New"},{"body":"Last Updated: 25-Oct-2022\nWelcome to Edition #10 of the What's New for VMware Validated Solutions, today we announced the following updates:\nAdded support for VMware Cloud Foundation 4.5.0 Added automation based on the PowerValidatedSolutions v1.9.0 release Release of PowerValidatedSolutions v1.9.0, our PowerShell module developed to ensure robustness, consistency, and accelerate implementation Added Support for VMware Cloud Foundation 4.5.0 Delighted to announce support for VMware Cloud Foundation 4.5.0.\nIdentity and Access Management for VMware Cloud Foundation Developer Ready Infrastructure for VMware Cloud Foundation Intelligent Logging and Analytics for VMware Cloud Foundation Intelligent Operations Management for VMware Cloud Foundation Private Cloud Automation for VMware Cloud Foundation Site Protection and Disaster Recovery for VMware Cloud Foundation Cloud-Based Automation for VMware Cloud Foundation Cloud-Based Automation for VMware Cloud Foundation Delighted to announce the release of a this brand new VMware Validated Solution.\nThe Cloud-Based Automation for VMware Cloud Foundation validated solution enables customers to consume a cloud-based infrastructure automation platform that delivers an agnostic self-service catalog for VMware Cloud Foundation and multi-cloud environments.\nFollowing the solution guide customers can easily and quickly connect vRealize Automation Cloud to their on-prem VMware Cloud Foundation infrastructure for the provisioning of services. As with all VMware Validated Solutions implementation automation is provided, for this solution through the use of Terraform plans that can be pulled from the GitHub repository\nIntelligent Operations Management for VMware Cloud Foundation Updates Implementation Additional PowerValidatedSolutions Automation\nCreate a vCenter Server Single Sign-On User for Integration with vRealize Suite Lifecycle Manager (Add-SsoUser) Configure Service Account Permissions in vSphere for Integration with vRealize Suite Lifecycle Manager (Add-vCenterGlobalPermission) Add the vCenter Server Password for the Additional VMware Cloud Foundation Instance to vRealize Suite Lifecycle Manager (New-vRSLCMLockerPassword) Import the New Certificate for vRealize Operations Manager to vRealize Suite Lifecycle Manager (Import-vRSLCMLockerCertificate) Private Cloud Automation for VMware Cloud Foundation Updates Solution Interoperability Additional PowerValidatedSolutions Automation\nIntegrate vRealize Automation with vRealize Operations Manager (New-vRAvROPSIntegrationItem) Update Placement Policy for Cloud Zones in vRealize Automation (Update-vRACloudAccountZone) Update the vRealize Automation Integration in vRealize Operations Manager (Update-vROPSvRAAdapterCredential) Verify the Integration of vRealize Operations Manager with vRealize Automation (Test-vROPsAdapterStatusByType) Site Protection and Disaster Recovery for VMware Cloud Foundation Updates Detailed Design Added design decisions on network segments, IP addressing scheme, name resolution, and time synchronization. Solution Interoperability Additional PowerValidatedSolutions Automation\nCreate vSphere Single Sign-On Users for Integration of vRealize Operations Manager with Site Protection and Disaster Recovery Solution Components (Add-SsoUser) Configure Service Account Permissions in vSphere for the Integration of vRealize Operations Manager with Site Protection and Disaster Recovery Solution Components (Add-vCenterGlobalPermission) Install the vRealize Operations Manager Management Packs for vSphere Replication and Site Recovery Manager (Enable-vROPSManagementPack) General Availability of PowerValidatedSolutions v1.9.0 Release of PowerValidatedSolutions v1.8.0, which is a PowerShell module that we have developed to not only accelerate the implementation of Validated Solutions, but ensure consistency and robustness. Here's a list of what's changed (this and previous updates can be tracked by reading the CHANGELOG.md file stored in the Git Hub repository):\n","link":"http://jadenetworksolutions.co.uk/post/vvs-whats-new/edition-10/","section":"post","tags":["VVS"],"title":"What's New for VMware Validated Solutions - Edition #10 (Oct 2022)"},{"body":"Last Updated: 27-Sep-2022\nWelcome to Edition #9 of the What's New for VMware Validated Solutions, today we announced the following updates:\nNew Solution - Cloud-Based Automation for VMware Cloud Foundation Added automation based on the PowerValidatedSolutions v1.8.0 release Release of PowerValidatedSolutions v1.8.0, our PowerShell module developed to ensure robustness, consistency, and accelerate implementation Cloud-Based Automation for VMware Cloud Foundation Delighted to announce the release of a this brand new VMware Validated Solution.\nThe Cloud-Based Automation for VMware Cloud Foundation validated solution enables customers to consume a cloud-based infrastructure automation platform that delivers an agnostic self-service catalog for VMware Cloud Foundation and multi-cloud environments.\nFollowing the solution guide customers can easily and quickly connect vRealize Automation Cloud to their on-prem VMware Cloud Foundation infrastructure for the provisioning of services. As with all VMware Validated Solutions implementation automation is provided, for this solution through the use of Terraform plans that can be pulled from the GitHub repository\nIntelligent Operations Management for VMware Cloud Foundation Updates Implementation Additional PowerValidatedSolutions Automation\nCreate a vCenter Server Single Sign-On User for Integration with vRealize Suite Lifecycle Manager (Add-SsoUser) Configure Service Account Permissions in vSphere for Integration with vRealize Suite Lifecycle Manager (Add-vCenterGlobalPermission) Add the vCenter Server Password for the Additional VMware Cloud Foundation Instance to vRealize Suite Lifecycle Manager (New-vRSLCMLockerPassword) Import the New Certificate for vRealize Operations Manager to vRealize Suite Lifecycle Manager (Import-vRSLCMLockerCertificate) Private Cloud Automation for VMware Cloud Foundation Updates Solution Interoperability Additional PowerValidatedSolutions Automation\nIntegrate vRealize Automation with vRealize Operations Manager (New-vRAvROPSIntegrationItem) Update Placement Policy for Cloud Zones in vRealize Automation (Update-vRACloudAccountZone) Update the vRealize Automation Integration in vRealize Operations Manager (Update-vROPSvRAAdapterCredential) Verify the Integration of vRealize Operations Manager with vRealize Automation (Test-vROPsAdapterStatusByType) Site Protection and Disaster Recovery for VMware Cloud Foundation Updates Detailed Design Added design decisions on network segments, IP addressing scheme, name resolution, and time synchronization. Solution Interoperability Additional PowerValidatedSolutions Automation\nCreate vSphere Single Sign-On Users for Integration of vRealize Operations Manager with Site Protection and Disaster Recovery Solution Components (Add-SsoUser) Configure Service Account Permissions in vSphere for the Integration of vRealize Operations Manager with Site Protection and Disaster Recovery Solution Components (Add-vCenterGlobalPermission) Install the vRealize Operations Manager Management Packs for vSphere Replication and Site Recovery Manager (Enable-vROPSManagementPack) General Availability of PowerValidatedSolutions v1.8.0 Release of PowerValidatedSolutions v1.8.0, which is a PowerShell module that we have developed to not only accelerate the implementation of Validated Solutions, but ensure consistency and robustness. Here's a list of what's changed (this and previous updates can be tracked by reading the CHANGELOG.md file stored in the Git Hub repository):\nEnhanced Request-CSPToken cmdlet to request a token from VMware Cloud. Enhanced Update-vRACloudAccountZone and Update-vRACloudZone cmdlets to support placement policy for cloud zones in vRealize Automation. Enhanced Confirm-PSModule cmdlet so its an exported function and can be executed on the command line. Enhanced Enable-vROPSManagementPack cmdlet to support Site Recovery Manager and vSphere Replication Management Packs. Renamed to Get-CSPPoxyAppliance cmdlet to Get-CloudProxy and added: -environment switch to support Production and Staging VMC Support for both Cloud Proxy and Cloud Extensibility Proxy. Support for either downloading or simply providing the URL path. Support for downloading on Core (Linux, Windows and Mac). Added region blocks for easier code navigation. Added the vRealize Automation Cloud to vSphere integration role for Cloud Assembly. Added the vRealize Suite Lifecycle Manager to vSphere integration role. Added Test-vROPsAdapterStatus and Test-vROPsAdapterStatusByType cmdlets to test the status vRealize Operations adapters. Added New-vRAvROPSIntegrationItem cmdlet to configure vRealize Operations Manager integration in vRealize Automation. Added Undo-vRAvROPsIntegrationItem cmdlet to remove vRealize Operations Manager integration from vRealize Automation. Added Add-vRAIntegrationItem cmdlet to add an external system to vRealize Automation. Added Test-vRAIntegrationItem cmdlet to test an integration item in vRealize Automation. Added Remove-vRAIntegrationItem cmdlet to remove an integration item from vRealize Automation. Added Get-CloudProxyOtk cmdlet to retrieve the One Time Key (OTK) for both the Cloud Proxy and the Cloud Extensibility Proxy. Added Get-vROVersion cmdlet with support for standalone, embedded, and cloud extensibility proxy vRealize Orchestrator instance. Added Get-CEPWorkflow cmdlet to return workflows from cloud extensibility proxy's vRealize Orchestrator instance. Added Invoke-CEPWorkflow cmdlet to start a Workflow on a cloud extensibility proxy's vRealize Orchestrator instance. Added Get-CEPWorkflowExecution cmdlet to return the Workflow Execution ID from a cloud extensibility proxy's vRealize Orchestrator instance. Added Get-CEPWorkflowExecutionState cmdlet to return the Workflow Execution State from a cloud extensibility proxy's vRealize Orchestrator instance. Added Add-CEPTrustedCertificate cmdlet to add a trusted cert to a cloud extensibility proxy's vRealize Orchestrator instance. Added Add-CEPvCenterServer cmdlet to add a vCenter server to a cloud extensibility proxy's vRealize Orchestrator instance. Added Update-vROPSvRAAdapterCredential cmdlet to support updating the vRealize Automation integration credential in vRealize Operations Manager. Added Get-vRAAPIVersion and Get-vRAIntegrationDetail cmdlets to support updating the placement policy for cloud zones in vRealize Automation. Added Get-ESXiPasswordPolicy cmdlet to return the password expiration policy for ESXi. Added Get-VCServerPasswordPolicy cmdlet to return the password expiration policy for vCenter Server. Added Set-EsxiPasswordExpirationPeriod cmdlet to set the password expiration period on an ESXi host in number of days. Added Sample Script in SampleScripts\\ppm folder, Password Policy Manager to enable auditing and configuration of password policies across VMware Cloud Foundation. passwordPolicyManager.ps1 generates and audit report or configures the password policies. sampleConfigurationFull.json configuration JSON covering all product configuration parameters. sampleConfigurationSimple.json configuration JSON covering default configuration parameters. README.md providing details on how to use Password Policy Manager. Added Get-vRAvRLIConfig cmdlet to retrieve the vRealize Log Insight logging configuration (CFAPI) on vRealize Automation. Added Set-vRAvRLIConfig cmdlet to configure the vRealize Log Insight logging configuration (CFAPI) on vRealize Automation. Added Remove-vRAvRLIConfig cmdlet to remove the vRealize Log Insight logging configuration (CFAPI) on vRealize Automation. ","link":"http://jadenetworksolutions.co.uk/post/vvs-whats-new/edition-09/","section":"post","tags":["VVS"],"title":"What's New for VMware Validated Solutions - Edition #9 (Sep 2022)"},{"body":"","link":"http://jadenetworksolutions.co.uk/tags/terraform/","section":"tags","tags":null,"title":"Terraform"},{"body":"During the last couple of months I've been working on a new project which has given me the opportunity to delve back into Terraform. I first took a look at Terraform in late 2020 while doing some research around automating VMware Validated Solutions, at the time there were far too many gaps in the providers which made it difficult to justify its use to deliver end to end automation with very short time scales. Jumping forward to today, there has been a lot of traction over the last 24 months with new providers being released as well as enhancements to existing providers and with less time pressures its felt like a good time to roll up my sleeves and dig deeper into what Terraform can do for me now.\nI'm not a Terraform expert by any stretch of the imagination and I certainly don't pretend to be one, and in truth its taken me a while to get my head around the Terraform concepts but the idea of this post is to try and share what I've learnt by explaining in a way that has made sense to me. Hopefully it will help others at least get their heads around the basics and allow them to flourish in their development of Terraform plans.\nTerraform Install First things first, you will need to intsall Terraform on your operating system of choice. For this I would recommend using the Terraform documentation where you will find a number of methods that can be followed.\nTerraform Concepts Let's now take a look at some basic concepts, this is not an exhaustive list but should be enough to get you going.\nFiles and Directories\nTerraform code is stored as plain text within files that have a .tf file extension. All files are kept together within a single directory which is referred to as a module and Terraform evaluates all of these configuration files treating the entire module as a single document.\nTip\nUse Terraform's ability to read multiple .tf files as part of the module, this allows you to split out elements of the code into smaller and easier to manage files.\nResources\nA resource describes the infrastructure object being created or modified and as such are considered the most important element.\nData Sources\nData sources relate to objects defined outside of Terraform.\nProviders\nProviders are referred to as plugins which are used to interact with the infrastructure, each provider adds a set of resource types and/or data sources that Terraform can manage.\nWithout providers, Terraform can't manage any kind of infrastructure, they are distributed separately from Terraform itself.\nVariables and Outputs\nInput variables allow you to customize the code without making changes to the source code. Output values are used to return values from the code which can be used by other modules. Terraform also has the concept of temporary variables which are referred to as local variables.\nBuilt in Functions\nThe Terraform language includes a number of built-in functions which can be called to transform and combine values.\nTerraform CLI The command line interface (CLI) to Terraform is via the terraform command, which accepts a variety of subcommands such as terraform init or terraform plan. For a full breakdown of Terraform CLI commands refer to the the Terraform CLI Documentation but here are a few common ones you should get familiar with:\nValidates the configuration files in a directory, referring only to the configuration and not accessing any remote services such as remote state, provider APIs\n1terraform validate Formats the configuration files to a canonical format and style\n1terraform fmt Initialize a working directory containing Terraform configuration files\n1terraform init Creates an execution plan, which lets you preview the changes that Terraform plans to make to your infrastructure\n1terraform plan -out=tfplan Executes the actions proposed in a Terraform plan\n1terraform apply tfplan Destroys all remote objects managed by a particular Terraform configuration\n1terraform destroy Conclusion In this post we have only scratched the surface of Terraform, but if you can get your head around these basics as you start playing with Terraform yourself you will quickly become familar with additional functionality and will be writing more complex Terraform code in no time.\n","link":"http://jadenetworksolutions.co.uk/post/terraform/terraform-intro/","section":"post","tags":["Terraform"],"title":"Terraform - Learning Some Basics"},{"body":"","link":"http://jadenetworksolutions.co.uk/tags/vcf/","section":"tags","tags":null,"title":"VCF"},{"body":"","link":"http://jadenetworksolutions.co.uk/categories/vmware-cloud-foundation/","section":"categories","tags":null,"title":"VMware Cloud Foundation"},{"body":"With the release of VMware Cloud Foundation 4.4.0, VMware removed a number of the vRealize Suite of products from the Bill of Materials (BoM) with the intent of providing customers more flexibility. For more details refer to Flexible vRealize Suite product upgrades of the What's New section of the release notes.\nWhilst this is great news for our customers, it has led to a bit of confusion. The release notes simply state:\nQuote\nYou can use vRealize Suite Lifecycle Manager to deploy vRealize Automation, vRealize Operations Manager, vRealize Log Insight, and Workspace ONE Access. vRealize Suite Lifecycle Manager determines which versions of these products are compatible and only allows you to install/upgrade to supported versions.\nThe underlying issue here is that customers can no longer use the Product Interoperability Matrix to easily identify the correct version mix between VMware Cloud Foundation itself and anything greater than vRealize Suite Lifecycle Manager 8.6.2, this is due to that fact that patches for vRealize Suite Lifecycle Manager are required and these are not part of the search criteria.\nIn an attempt to help drive clarity a new VMware KB article has been created KB88829, this can be used to work out the upgrade path for vRealize Suite Lifecycle Manager that is needed to then be able to deploy a later release of vRealize Suite product on top of VMware Cloud Foundation.\n","link":"http://jadenetworksolutions.co.uk/post/vcf/vcf-vrealize-flexibility/","section":"post","tags":["VCF"],"title":"VMware Cloud Foundation and vRealize Suite Flexibility"},{"body":"Ever been in the situation where your licenses assigned in VMware Cloud Foundation are due to expire, well whilst doing some work this week in the lab I noticed that some of mine were coming up for expiration, which got me wondering what the process was to remedy. If you have been in this situation, you probably like me started by checking out the License Management section of the VMware Cloud Foundation Administration Guide and like me ended up being disappointed to find that it only covers the following topics:\nAdding a License Key Editing a License Key Description Removing a License Key Next I did a quick google which also turned up little to no information, challenge accepted!!\nIn this post we will take a look at the steps involved, my focus and testing has been isolated to the vSAN License. Time permitting I plan to look at other areas such as NSX-T Data Center and Tanzu.\nFirst thing to call out here is that unfortunately the process is not automated from an SDDC Manager perspective, the only thing that SDDC Manager does do is automatically updates the assignment in its inventory once the new licenses are added to both vCenter Server and SDDC Manager.\nSo lets take a look at the detailed steps, from a high-level the process is as follows:\nIdentify the Expiring vSAN License Adding a New vSAN License to SDDC Manager Adding a New vSAN License to vCenter Server Reassign the vSAN License in vCenter Server Remove the Expiring vSAN License from vCenter Server Remove the Expiring vSAN License from SDDC Manager Identify the Expiring vSAN License Login to SDDC Manager UI. From the navigation, expand Administration and select Licensing. Identity the license that is expiring and make a note of the license key, and the current used allocation. Adding a New vSAN License to SDDC Manager Login into the SDDC Manager UI. From the navigation, expand Administration and select Licensing. Click the + License Key button. On the Add License Key dialog, using the Product Name dropdown select VMware vSAN. In the License Key text box, enter the new license key. In the Description text box, enter a description for the key. Click Add. Adding a New vSAN License to vCenter Server Login into the Management Domain vCenter Server. From the Home menu, select Administration. Under Licensing, select Licenses. Select the License tab, click Add. On the Enter License Keys dialog, enter the new license key and click Next. On the Edit license names dialog, enter a license name and click Next. On the Ready to Complete dialog, click Finish. Reassign the vSAN License in vCenter Server Login into the Management Domain vCenter Server. From the Home menu, select Administration. Under Licensing, select Licenses. Select the Assets tab, and click vSAN Clusters. Select the cluster you want to reassign the license for and click Assign License. On the Assign License dialog, select te new license key and click OK. Remove the Expiring vSAN License from vCenter Server Login into the Management Domain vCenter Server. From the Home menu, select Administration. Under Licensing, select Licenses. Select the License tab. Select the expiring license and click Remove. Remove the Expiring vSAN License from SDDC Manager Login into the SDDC Manager UI. From the navigation, expand Administration and select Licensing. Verify that the old license now has a used count of zero and the new licenses used count has gone up. Click the ellipses next to the expired license and select Remove. On the Remove license key dialog, click Remove. That's it, you have now successfully replaced and cleaned up the the expiring vSAN license.\n","link":"http://jadenetworksolutions.co.uk/post/vcf/vcf-license-update/","section":"post","tags":["VCF"],"title":"Updating a vSAN License in VMware Cloud Foundation"},{"body":"By default NSX-T Data Center passwords (root, admin and audit) on the NSX Manager and NSX Edge nodes are set to expire after 90 days. Unless you rotate passwords on regular basis you may have overlooked this default configuration and suddenly find yourself locked out of being able to perform management tasks.\nFirstly in more recent releases, VMware Cloud Foundation provides the ability to perform scheduled or manual password rotations something to consider looking into from a day-to-day operational process but if your passwords have already expired all bets are off as the VMware Cloud Foundation password rotation workflow can no longer authenticate. Thinking the password rotation feature may be a way out very quickly presents you with the following error message:\nDescription: Password update for resource : sfo-m01-nsx01.sfo.rainpole.io, user : admin and credential type : API\nMessage: Failed to get NSXT user details\nRemediation Message: Please verify that the account is active and is not locked. If the password of the account has expired, manually reset the password in the product and then perform a REMEDIATE operation in the SDDC Manager, to update its stored copy of the password.\nReference Token: HDDF8C\nCause: The credentials were incorrect or the account specified has been locked.\nIn a fairly small deployment the process of resetting the passwords is not a speedy process, for example in a Standard Architecture deployment of VMware Cloud Foundation with a single NSX Edge Cluster deployed in each Workload Domain the NSX Appliance count is already a total of ten (10). Not withstanding this, personally I found very little information on the internet that explained a single end-to-end process or in fact the best approach in order to rectify the situation. For example the message from VMware Cloud Foundation itself suggests a number of steps, including the remediate option which frankly just adds further time to the process.\nBecause of this I decided to spend a little bit of time investigating the options with a view to documenting what I found to be the fastest approach to get things unblocked. In essence this really boils down to adjusting the expiration policy to never expire initially, it removes the need to manually update all of the passwords and then perform remediation within VMware Cloud Foundation and once your unblocked you can either continue using the original passwords and the never expire policy setting or look to use a combination of VMware Cloud Foundation scheduled password rotations and a complementary expiration timeline.\nLet's take a look at the process I followed in my lab, which involves a combination of nsxcli commands executed on the console and some cmdlets that have been recently added to PowerValidatedSolutions which use the NSX REST APIs.\nResolving Expired Passwords for an NSX Management Cluster The first step in the process is unlocking the NSX Management Cluster, this has to be done through a console on one of the NSX Manager appliances, the good news though is that as this is a cluster you only need to make the change on one of the NSX Manager nodes.\nLogin to the Management Domain vCenter Server. Open a remote or web console to the first NSX Manager node of the cluster. Login using the root account and the original password. You will be prompted to change the password immediately, follow the on-screen prompts to change the root password. Now your authenticated we can disable password expiry for each account using the following sudo commands (pay careful attention to the syntax): 1su admin \u0026#39;-c clear user admin password-expiration\u0026#39; 1su admin \u0026#39;-c clear user audit password-expiration\u0026#39; 1su admin \u0026#39;-c clear user root password-expiration\u0026#39; Now the accounts are set to no longer expire, we reset the root account back to the original password also using a sudo command: 1su admin \u0026#39;-c set user root password VMw@re1!VMw@re1! old-password VMware123!VMware123!\u0026#39; All accounts should be available for connection using the original passwords. Resolving Expired Passwords for NSX Edge Nodes The second step in the process is to unlock the NSX Edge Nodes, for this process now we have the admin account of the NSX Manager working again we can use the NSX REST APIs to simplify the process. In this procedure we use a number of PowerShell cmdlets that have been included in PowerValidatedSolutions, you could simply use the APIs directly on the command line but having the APIs wrapped in PowerShell cmdlets simplifies the process for many.\nEnsure you have followed the prerequisites for installing the PowerValidatedSolutions PowerShell module and have it installed.\nStart Windows PowerShell.\nReplace the values in the sample code with values for the instance of VMware Cloud Foundation and run the commands in the PowerShell console.\n1$nsxtManagerFqdn = \u0026#34;sfo-m01-nsx01.sfo.rainpole.io\u0026#34; 2$nsxtManagerUser = \u0026#34;admin\u0026#34; 3$nsxtManagerPass = \u0026#34;VMw@re1!VMw@re1!\u0026#34; Perform the configuration by running the command in the PowerShell console. 1Request-NsxToken -fqdn $nsxtManagerFqdn -username $nsxtManagerUser -password $nsxtManagerPass 2$transportNodeIds = (Get-NsxtEdgeCluster).members.transport_node_id 3$userIds = @(\u0026#34;0\u0026#34;,\u0026#34;10000\u0026#34;,\u0026#34;10002\u0026#34;) 4foreach ($id in $transportNodeIds ) { 5 foreach ($userId in $userIds) { 6 Set-NsxtApplianceUserExpirationPolicy -userId $userId -days 0 -transportNodeId $id 7 } 8} All your NSX Edge Node accounts should also now be unblocked and set to never expire. ","link":"http://jadenetworksolutions.co.uk/post/vcf/vcf-nsxt-passwords/","section":"post","tags":["VCF","NSX"],"title":"Fixing Expired Passwords on NSX Manager and Edge Nodes"},{"body":"","link":"http://jadenetworksolutions.co.uk/tags/nsx/","section":"tags","tags":null,"title":"NSX"},{"body":"","link":"http://jadenetworksolutions.co.uk/categories/nsx-t-data-center/","section":"categories","tags":null,"title":"NSX-T Data Center"},{"body":"If you have been through the process of performing an upgrade of VMware Cloud Foundation you will know the process involves downloading a number of bundles. VMware Cloud Foundation includes the following types of bundles.\nInstall Bundles, An install bundle includes software binaries to install VI workload domains and vRealize Suite Lifecycle Manager. Update or Upgrade Bundle, An update or upgrade bundle includes software binaries to update the appropriate VMware Cloud Foundation software components. In most cases, an upgrade bundle must be applied to the management domain before it can be applied to VI workload domains. Async Patch Bundle, An async patch bundle allows you to apply critical patches to certain VMware Cloud Foundation components (NSX-T Manager, vCenter Server, and ESXi) when an update or upgrade bundle is not available. See Async Patch Tool. This process can be a little overwhelming if you are new to VMware Cloud Foundation due to the nature in which the bundles are displayed under the Bundle Management section of the SDDC Manager UI. One of my biggest gripes here is there is no way to filter the bundles based on VMware Cloud Foundation version, product or even date. This coupled with the way they are actually displayed in the UI from a layout perspective, a table list would be easier to consume in my opinion. When you start the process of walking through the upgrade process itself, the SDDC Manager UI is actually very good at leading you down the What's Next path as you can actually only upgrade components in a particular order and this is illustrated when you select Available Updates from within a Workload Domain. If you have not pre-downloaded all the required bundles you then waste time within your change window completing this task before you can continue and so are back to needing to traverse the overwhelming Bundle Management section of the SDDC Manager UI again.\nIts for this reason that I decided to put together a very simple PowerShell script that utilizes PowerVCF to automate the process of downloading all of the bundles required for a particular release.\nUsing a JSON file, you first populate it with the bundle IDs of each bundle required. This can be done by reviewing the details of each bundle in the Bundle Management section of the SDDC Manager UI for the release you wish to prepare for. Here is a sample for VMware Cloud Foundation 4.4.1.0. You can also download it from GitHub.\n1{ 2 \u0026#34;bundles\u0026#34;: [ 3 { 4 \u0026#34;bundleId\u0026#34;: \u0026#34;13d87a53-298d-4ee5-98ca-b9e10eece7a5\u0026#34;, 5 \u0026#34;product\u0026#34;: \u0026#34;SDDC_MANAGER\u0026#34; 6 }, 7 { 8 \u0026#34;bundleId\u0026#34;: \u0026#34;8c178f33-b28d-47d0-88da-aa94f309a042\u0026#34;, 9 \u0026#34;product\u0026#34;: \u0026#34;SDDC_MANAGER_CONFIG_DRIFT\u0026#34; 10 }, 11 { 12 \u0026#34;bundleId\u0026#34;: \u0026#34;05be2afd-990d-45bd-9472-fab032e8c696\u0026#34;, 13 \u0026#34;product\u0026#34;: \u0026#34;VCENTER_SERVER_UPGRADE\u0026#34; 14 }, 15 { 16 \u0026#34;bundleId\u0026#34;: \u0026#34;043e2b99-b36f-45b9-a4a2-1632a24764ef\u0026#34;, 17 \u0026#34;product\u0026#34;: \u0026#34;ESXI_UPGRADE\u0026#34; 18 }, 19 { 20 \u0026#34;bundleId\u0026#34;: \u0026#34;193486eb-53f5-40c7-8012-b5dcab515ebf\u0026#34;, 21 \u0026#34;product\u0026#34;: \u0026#34;NSXT_UPGRADE\u0026#34; 22 }, 23 { 24 \u0026#34;bundleId\u0026#34;: \u0026#34;05be2afd-990d-45bd-9472-fab032e8c696\u0026#34;, 25 \u0026#34;product\u0026#34;: \u0026#34;VCENTER_SERVER\u0026#34; 26 }, 27 { 28 \u0026#34;bundleId\u0026#34;: \u0026#34;3c32c5d6-b5e0-49c6-9a86-90bcd3de671e\u0026#34;, 29 \u0026#34;product\u0026#34;: \u0026#34;NSXT_INSTALL\u0026#34; 30 } 31 ] 32} Next we simply execute the vcfBundleDownload.ps1 script passing in the JSON file. The script reads the JSON, then loops through each entry first checking if the bundle has been downloaded and if not requests a download. It then monitors the download until complete before moving onto the next bundle item. You can execute the the script over and over in case a download fails and you need to re-run safe in the knowledge that it will only download missing bundles.\n1.\\vcfBundleDownload.ps1 -json .\\vcfBundleDownloadList.json Download the script from GitHub.\n","link":"http://jadenetworksolutions.co.uk/post/vcf/vcf-bundle-download/","section":"post","tags":["API","VCF","PowerShell"],"title":"Automating the Download of VCF Bundles for a Release"},{"body":"Last Updated 31-05-2022 VMware Validated Solutions are byte sized solutions developed to extend the foundational capabilities of VMware Cloud Foundation, for background reading see my previous post here. Over time the team intends to add incremental value where opportunities arise and I plan to share as much detail as I can with each new update using my What's New for VMware Validated Solutions series of blog posts. I've decided to create this single landing page where I will provide a consolidated list of links to the relevant Editions of this series so you can bookmark this single page for ease of use.\nRemember to check back from time to time!\nWhat’s New for VMware Validated Solutions - Edition #1 (Oct 2021) What's New for VMware Validated Solutions - Edition #2 (Oct 2021) What's New for VMware Validated Solutions - Edition #3 (Nov 2021) What's New for VMware Validated Solutions - Edition #4 (Jan 2022) What's New for VMware Validated Solutions - Edition #5 (Feb 2022) What's New for VMware Validated Solutions - Edition #6 (Mar 2022) What's New for VMware Validated Solutions - Edition #7 (Apr 2022) What's New for VMware Validated Solutions - Edition #8 (May 2022) ","link":"http://jadenetworksolutions.co.uk/post/vvs-whats-new/whats-new-index/","section":"post","tags":["VVS"],"title":"What's New for VMware Validated Solutions - Blog Index"},{"body":"Last Updated: 31-May-2022\nWelcome to Edition #8 of the What's New for VMware Validated Solutions, today we are announcing the following updates:\nAdded support for VMware Cloud Foundation 4.4.1 Added automation based on the PowerValidatedSolutions v1.7.0 release Release of PowerValidatedSolutions v1.7.0, our PowerShell module developed to ensure robustness, consistency, and accelerate implementation Added Support for VMware Cloud Foundation 4.4.1 Delighted to announce support for VMware Cloud Foundation 4.4.1.\nIdentity and Access Management for VMware Cloud Foundation Developer Ready Infrastructure for VMware Cloud Foundation Intelligent Logging and Analytics for VMware Cloud Foundation Intelligent Operations Management for VMware Cloud Foundation Private Cloud Automation for VMware Cloud Foundation Site Protection and Disaster Recovery for VMware Cloud Foundation Site Protection and Disaster Recovery for VMware Cloud Foundation Updates Implementation Additional PowerValidatedSolutions Automation\nAdd a Network Adapter and Configure Static Routes for vSphere Replication (Set-vSRNetworkConfig) Create a VMkernel Adapter on the ESXi Hosts for vSphere Replication Traffic (New-vSRVMkernelPort) Configure ESXi Host Static Routes for vSphere Replication (New-vSREsxiStaticRoute) Assign Licenses to Site Recovery Manager (Set-SRMLicenseConfig) General Availability of PowerValidatedSolutions v1.7.0 Release of PowerValidatedSolutions v1.7.0, which is a PowerShell module that we have developed to not only accelerate the implementation of Validated Solutions, but ensure consistency and robustness. Here's a list of what's changed (this and previous updates can be tracked by reading the CHANGELOG.md file stored in the Git Hub repository):\nAdded Set-vSRNetworkConfig cmdlet to configure a secondary ethernet adapter and the required routing for vSphere Replication appliances in the protected and recovery sites Added Undo-vSRNetworkConfig cmdlet to remove the secondary ethernet adapter and its configuration from vSphere Replication appliances in the protected and recovery sites Added New-vSRVMkernelPort cmdlet to create VMkernel ports on ESXi hosts for vSphere Replication traffic in the protected and recovery sites. Added Undo-vSRVMkernelPort cmdlet to remove VMkernel ports on ESXi hosts for vSphere Replication traffic in the protected and recovery sites. Added New-vSREsxiStaticRoute cmdlet to create a static route on ESXi hosts for vSphere Replication traffic in the protected and recovery sites. Added Undo-vSREsxiStaticRoute cmdlet to remove a static route on ESXi hosts for vSphere Replication traffic in the protected and recovery sites. Added Set-SRMLicenseConfig cmdlet to configure the license for Site Recovery Manager in the protected and recovery sites. Added Undo-SRMLicenseConfig cmdlet to remove the license configuration from Site Recovery Manager in the protected and recovery sites. ","link":"http://jadenetworksolutions.co.uk/post/vvs-whats-new/edition-08/","section":"post","tags":["VVS"],"title":"What's New for VMware Validated Solutions - Edition #8 (May 2022)"},{"body":" It's been a while since the last update but I'm pleased to announce the general availability of PowerVCF v2.2.0 for download from the PowerShell Library. PowerVCF is a open source project and the team works on adding support when time permits.\nDownload It Here: PowerVCF v2.2.0 PowerShell Library Download\nFixes Fixed Get-VCFApplicationVirtualNetwork cmdlet when passing the ID of the Application Virtual Network the response was failing. Enhancements Updated Get-VCFFederation cmdlet to check the system version, multi-instance management is deprecated in VMware Cloud Foundation v4.4.0. Updated Set-VCFFederation cmdlet to check the system version, multi-instance management is deprecated in VMware Cloud Foundation v4.4.0. Updated Remove-VCFFederation cmdlet to check the system version, multi-instance management is deprecated in VMware Cloud Foundation v4.4.0. Updated Get-VCFFederationMember cmdlet to check the system version, multi-instance management is deprecated in VMware Cloud Foundation v4.4.0. Updated New-VCFFederationInvite cmdlet to check the system version, multi-instance management is deprecated in VMware Cloud Foundation v4.4.0. Updated Join-VCFFederation cmdlet to check the system version, multi-instance management is deprecated in VMware Cloud Foundation v4.4.0. Updated Get-VCFFederationTask cmdlet to check the system version, multi-instance management is deprecated in VMware Cloud Foundation v4.4.0. Updated Request-VCFToken cmdlet to support -skipCertificateCheck switch and removed the alias for Connect-VCFToken. Updated Connect-CloudBuilder cmdlet to support -skipCertificateCheck switch. Updated Get-VCFCredentialTask cmdlet to support -status validation set. Additions Added Get-VCFHealthSummaryTask cmdlet to retrieve health summary tasks Added Start-VCFHealthSummary cmdlet to start a health check Added Request-VCFHealthSummaryBundle cmdlet to download the health summary bundle Added Get-VCFSupportBundleTask cmdlet to retrieve support bundle tasks Added Start-VCFSupportBundle cmdlet to start a support bundle collection Added Request-VCFSupportBundle cmdlet to download the support bundle Added Get-VCFPSC cmdlet to support the retrieval of Platform Services Controllers from the SDDC Manager inventory. ","link":"http://jadenetworksolutions.co.uk/post/powervcf/powervcf-ga-220/","section":"post","tags":["API","PowerShell","VCF"],"title":"PowerVCF v2.2.0 - General Availability"},{"body":"Last Updated: 28-Apr-2022\nWelcome to Edition #7 of the What's New for VMware Validated Solutions, today we are announcing the following updates:\nAdditional automation based on the PowerValidatedSolutions v1.6.0 release Release of PowerValidatedSolutions v1.6.0, our PowerShell module developed to ensure robustness, consistency, and accelerate implementation Identity and Access Management for VMware Cloud Foundation Solution Interoperability Additional PowerValidatedSolutions Automation\nAdd a VMware Identity Manager Adapter for the Standalone Workspace ONE Access Instance (Add-vROPSAdapterIdentityManager) Intelligent Logging and Analytics for VMware Cloud Foundation Updates Solution Interoperability Additional PowerValidatedSolutions Automation\nReconfigure the Remote Collector Group for the vRealize Log Insight Integration (Update-vROPSAdapterCollecterGroup) Site Protection and Disaster Recovery for VMware Cloud Foundation Updates Implementation Additional PowerValidatedSolutions Automation\nReconfigure DNS and Domain Search on the vRealize Automation Nodes (Set-vRADnsConfig) Reconfigure NTP on vRealize Automation (Set-vRANtpConfig) Create a Port Group for vSphere Replication Traffic (New-vSRPortGroup) Create a Site Pair Between the Protected and Recovery VMware Cloud Foundation Instances (New-SRMSitePair) Configure Mappings between the Protected and the Recovery VMware Cloud Foundation Instances (Add-SRMMapping) General Availability of PowerValidatedSolutions v1.6.0 Release of PowerValidatedSolutions v1.6.0, which is a PowerShell module that we have developed to not only accelerate the implementation of Validated Solutions, but ensure consistency and robustness. Here's a list of what's changed (this and previous updates can be tracked by reading the CHANGELOG.md file stored in the Git Hub repository):\nFixed Add-vROPSAdapterNsxt cmdlet so that the description is maintained when validating the certificate of the NSX-T Adapter Added Add-vROPSAdapterIdentityManager cmdlet to support adding a new Identity Manager Adapter in vRealize Operations Manager. Added Undo-vROPSAdapter cmdlet to support the removal of an Adapter from vRealize Operations Manager. Added Undo-vROPSCredential cmdlet to support the removal of an Adapter Credential from vRealize Operations Manager. Added Update-vROPSAdapterCollecterGroup cmdlet tto support updating the collector group for an Adapter in vRealize Operations Manager Added Set-vRADnsConfig cmdlet to configure the DNS server(s) and DNS search domain(s) on vRealize Automation to use custom settings. Added Undo-vRADnsConfig cmdlet to revert the DNS configuration of vRealize Automation to match SDDC Manager. Added Set-vRANtpConfig cmdlet to configure the NTP server(s) on vRealize Automation to use custom settings. Added Undo-vRANtpConfig cmdlet to revert the NTP configuration of vRealize Automation to match SDDC Manager. Added Add-SRMMapping cmdlet to create a mapping between objects (folder, network, or compute resource) in the protected and failover VCF instances in Site Recovery Manager Added Undo-SRMMapping cmdlet to remove a mapping between objects (folder, network, or compute resource) in the protected and failover VCF instances in Site Recovery Manager Added New-SRMSitePair cmdlet to create a site pair between Site Recovery Manager instances Added Undo-SRMSitePair cmdlet to remove an existing site pair between Site Recovery Manager instances. Added New-vSRPortGroup cmdlet to create port groups for vSphere Replication appliances in the protected and recovery sites. Added Undo-vSRPortGroup cmdlet to remove port groups for vSphere Replication appliances in the protected and recovery sites. ","link":"http://jadenetworksolutions.co.uk/post/vvs-whats-new/edition-07/","section":"post","tags":["VVS"],"title":"What's New for VMware Validated Solutions - Edition #7 (Apr 2022)"},{"body":"Last Updated: 29-Mar-2022\nWelcome to Edition #6 of the What's New for VMware Validated Solutions, today we are announcing the following changes:\nAdditional automation based on the PowerValidatedSolutions v1.5.0 release Additional Operational Guidance (example Personas) Additional automation for procedures within Solution Interoperability section Identity and Access Management for VMware Cloud Foundation Solution Interoperability Design Decision Changes\nIAM-WSA-LOG-003 - Configure a dedicated Workspace ONE Access agent group and assign the standalone Workspace ONE Access FQDN (NEW) IAM-WSA-LOG-004 - Configure a dedicated Photon OS agent group and assign the standalone Workspace ONE Access FQDN. (NEW) Procedure Changes\nCombined the below procedures into Install and Configure the vRealize Log Insight Agent on the Standalone Workspace ONE Access Appliance Download and Install the vRealize Log Insight Agent on the Standalone Workspace ONE Access Appliance Configure the vRealize Log Insight Agent on the Standalone Workspace ONE Access Appliance Additional PowerValidatedSolutions Automation\nInstall and Configure the vRealize Log Insight Agent on the Standalone Workspace ONE Access Appliance (Install-vRLIPhotonAgent) Create a vRealize Log Insight Identity Manager Agent Group for the Standalone Workspace ONE Access (Add-vRLIAgentGroup) Create a vRealize Log Insight Photon OS Agent Group for the Standalone Workspace ONE Access (Add-vRLIAgentGroup) Developer Ready Infrastructure for VMware Cloud Foundation Implementation Additional PowerValidatedSolutions Automation\nReplace the Supervisor Cluster Kubernetes API Endpoint Certificate (Request-SignedCertificate) License the Supervisor Cluster (Add-SupervisorClusterLicense) Intelligent Logging and Analytics for VMware Cloud Foundation Updates Operational Guidance Example Personas to illustrate product role to organization role assignments Solution Interoperability Design Decision Changes\nILA-VRLI-MON-005 - Configure the vRealize Log Insight adapter to use the remote collector group (NEW) ILA-VRLI-MON-006 - Add a Ping adapter for the vRealize Log Insight cluster nodes (NEW) Additional PowerValidatedSolutions Automation\nAdd a Ping adapter for the vRealize Log Insight cluster nodes (Add-vROPSAdapterPing) Intelligent Operations Management for VMware Cloud Foundation Updates Operational Guidance Example Personas to illustrate product role to organization role assignments Solution Interoperability Design Decision Changes\nIOM-VROPS-LOG-005 - Configure a dedicated Photon OS agent group and assign the vRealize Operations Manager Cluster and Remote Collector Node FQDNs (CHANGED) Procedure Changes\nChanged from Add the vRealize Operations Manager Nodes to the vRealize Log Insight Photon OS Agent Group to Create a vRealize Log Insight Photon OS Agent Group for the vRealize Operations Manager Nodes Additional PowerValidatedSolutions Automation\nCreate a vRealize Log Insight Photon OS Agent Group for the vRealize Operations Manager Nodes (Add-vRLIAgentGroup) Private Cloud Automation for VMware Cloud Foundation Updates Operational Guidance Example Personas to illustrate product role to organization role assignments Solution Interoperability Design Decision Changes\nPCA-VRA-MON-005 - Add a Ping adapter for the vRealize Automation cluster nodes (NEW) Original PCA-VRA-MON-005 becomes PCA-VRA-MON-006 (CHANGED) Original PCA-VRA-MON-006 becomes PCA-VRA-MON-007 (CHANGED) PCA-VRA-LOG-004 - Configure a dedicated Photon OS agent group and assign the vRealize Automation Cluster FQDNs (CHANGED) Procedure Changes\nChanged from Add the vRealize Automation Cluster Nodes to the vRealize Log Insight Photon OS Agent Group to Create a vRealize Log Insight Photon OS Agent Group for the vRealize Automation Cluster Nodes Additional PowerValidatedSolutions Automation\nAdd a Ping adapter for the vRealize Automation cluster nodes (Add-vROPSAdapterPing) Create a vRealize Log Insight Photon OS Agent Group for the vRealize Automation Cluster Nodes (Add-vRLIAgentGroup) Site Protection and Disaster Recovery for VMware Cloud Foundation Updates Implementation Additional PowerValidatedSolutions Automation\nReconfigure DNS and Domain Search on the vRealize Suite Lifecycle Manager Appliance (Set-vRSLCMDnsConfig) Reconfigure NTP on the vRealize Suite Lifecycle Manager Appliance (Add-vRSLCMNtpServer) Reconfigure DNS and Domain Search on the Clustered Workspace ONE Access Nodes (Set-WorkspaceOneDnsConfig) Reconfigure NTP on the Clustered Workspace ONE Access Nodes (Set-WorkspaceOneNtpConfig) Reconfigure DNS and Domain Search on the vRealize Operations Manager Analytics Cluster Nodes (Set-vROPSDnsConfig) Reconfigure NTP on the vRealize Operations Manager Analytics Cluster Nodes (Add-vROPSNtpServer) Solution Interoperability Design Decision Changes\nSPR-SRM-LOG-002 - Configure the vRealize Log Insight agent to transmit logs from the Site Recovery Manager instance to the adjacent vRealize Log Insight in the VMware Cloud Foundation instance using the vRealize Log Insight ingestion API, cfapi, on port 9000 (NEW) Original SPR-SRM-LOG-002 becomes SPR-SRM-LOG-003 (CHANGED) SPR-SRM-LOG-004 - Configure the vRealize Log Insight agent to transmit logs from the vSphere Replication instance to the adjacent vRealize Log Insight in the VMware Cloud Foundation instance using the vRealize Log Insight ingestion API, cfapi, on port 9000 (NEW) SPR-SRM-LOG-005 - Configure a dedicated Photon OS agent group and assign the Site Recovery Manager and vSphere Replication FQDNs (CHANGED) Procedure Changes\nCombined the below procedures into Install and Configure the vRealize Log Insight Agent on the Site Recovery Manager and vSphere Replication Appliances Download and Install the vRealize Log Insight Agent on the Site Recovery Manager and vSphere Replication Appliances Configure the vRealize Log Insight Agent on the Site Recovery Manager and vSphere Replication Appliances Changed from Add the Site Recovery Manager and the vSphere Replication Appliances to the vRealize Log Insight Photon OS Agent Group to Create a vRealize Log Insight Photon OS Agent Group for Site Recovery Manager and the vSphere Replication Additional PowerValidatedSolutions Automation\nInstall and Configure the vRealize Log Insight Agent on the Site Recovery Manager and vSphere Replication Appliances (Install-vRLIPhotonAgent) Create a vRealize Log Insight Photon OS Agent Group for Site Recovery Manager and the vSphere Replication (Add-vRLIAgentGroup) General Availability of PowerValidatedSolutions v1.5.0 Release of PowerValidatedSolutions v1.5.0, which is a PowerShell module that we have developed to not only accelerate the implementation of Validated Solutions, but ensure consistency and robustness. Here's a list of what's changed (this and previous updates can be tracked by reading the CHANGELOG.md file stored in the Git Hub repository):\nEnhanced Add-SsoPermission cmdlet to verify that the SSO Group exists in vCenter Single Sign-On. Enhanced Enable-SupervisorCluster cmdlet additional enhancements around pre-validation of inputs. Enhanced Add-vRLIAgentGroup cmdlet to support adding multiple Agent Groups of the same type. Enhanced Add-vROPSAdapterNsxt cmdlet to support defaulting to Default collector group rather than using custom remote collector group. Enhanced Add-vROPSAdapterPing cmdlet to support defaulting to Default collector group rather than using custom remote collector group. Enhanced Set-WorkspaceOneNtpConfig cmdlet to support updating NTP configuration for Clustered Workspace ONE Access Added Undo-WorkspaceOneNsxtIntegration cmdlet to disable the integration between NSX Manager and Workspace ONE Access. Added Undo-SsoPermission cmdlet to remove a user or group's access from vCenter Single Sign-On. Added Undo-NsxtVidmRole cmdlet to remove user or group's access from NSX-T Data Center. Added Undo-ClusterGroup cmdlet to remove a vSphere DRS Cluster Group. Added Undo-vCenterGlobalPermission cmdlet to remove vSphere Global Permissions from vCenter Server. Added Undo-vSphereRole cmdlet to remove a custom vSphere Role from vCenter Server. Added Undo-AntiAffinityRule cmdlet to remove an Anti-Affinity Rule from vCenter Server. Added Undo-VmStartupRule cmdlet to remove a VM to VM vSphere DRS Rule from vCenter Server. Added Undo-WorkspaceOneDirectoryGroup cmdlet to remove Active Directory Groups from Workspace ONE Access Directory sync. Added Add-SupervisorClusterLicense cmdlet to install and assign a license to a Supervisor Cluster. Added Request-SignedCertificate cmdlet to request a signed certificate from a Microsoft Certificate Authority. Added Set-vRSLCMDnsConfig cmdlet to update the DNS configuration of vRealize Suite Lifecycle Manager. Added Undo-vRSLCMDnsConfig cmdlet to revert the DNS configuration of vRealize Suite Lifecycle Manager to match SDDC Manager. Added Add-vRSLCMNtpServer cmdlet to add NTP Servers to vRealize Suite Lifecycle Manager. Added Undo-vRSLCMNtpServer cmdlet to revert the NTP configuration of vRealize Suite Lifecycle Manager to match SDDC Manager. Added Set-WorkspaceOneDnsConfig cmdlet to update the DNS configuration of Workspace ONE Access. Added Undo-WorkspaceOneDnsConfig cmdlet to revert the DNS configuration of Workspace ONE Access to match SDDC Manager. Added Set-vROPSDnsConfig cmdlet to update the DNS configuration of vRealize Operations Manager. Added Undo-vROPSDnsConfig cmdlet to revert the DNS configuration of vRealize Operations Manager to match SDDC Manager. Added Add-vROPSNtpServer cmdlet to add NTP Servers to vRealize Operations Manager. Added Undo-vROPSNtpServer cmdlet to revert the NTP configuration of vRealize Operations Manager to match SDDC Manager. Added Sample Scripts in the SampleScripts\\iam folder, each script uses the Planning and Preparation Workbook as the input source: iamUndoDeployment.ps1 automates the removal of the Identity and Access Management for VMware Cloud Foundation validated solution. Updated Sample Scripts in the SampleScripts\\iam folder, each script uses the Planning and Preparation Workbook as the input source: iamConfigureWorkspaceOne.ps1 updated input values to use latest VCF 4.4.x Planning and Prep Workbook. Added Sample Scripts in the SampleScripts\\dri folder, each script uses the Planning and Preparation Workbook as the input source: driConfigureSupervisorCluster.ps1 automates the configuration of vSphere, NSX and enables the Supervisor Cluster. driDeployTanzuCluster.ps1 automates the the deployment of a Tanzu Kubernetes Cluster. driUndoDeployment.ps1 automates the removal of the Developer Ready Infrastructure for VMware Cloud Foundation validated solution. Added Sample Scripts in the SampleScripts\\ila folder, each script uses the Planning and Preparation Workbook as the input source: ilaUndoVrealizeLogInsight.ps1 automates the removal of Intelligent Logging and Analytics for VMware Cloud Foundation validated solution. ","link":"http://jadenetworksolutions.co.uk/post/vvs-whats-new/edition-06/","section":"post","tags":["VVS"],"title":"What's New for VMware Validated Solutions - Edition #6 (Mar 2022)"},{"body":"Last Updated: 22-Feb-2022\nWelcome to Edition #5 of the What's New for VMware Validated Solutions, today we are announcing the following changes:\nAdditional support for VMware Cloud Foundation 4.4.0 Additional automation across solutions based on the PowerValidatedSolutions v1.4.0 release Added Support for VMware Cloud Foundation 4.4.0 Delighted to announce support for VMware Cloud Foundation 4.4.0.\nIdentity and Access Management for VMware Cloud Foundation Developer Ready Infrastructure for VMware Cloud Foundation Intelligent Logging and Analytics for VMware Cloud Foundation Intelligent Operations Management for VMware Cloud Foundation Private Cloud Automation for VMware Cloud Foundation Site Protection and Disaster Recovery for VMware Cloud Foundation Advanced Load Balancer for VMware Cloud Foundation Identity and Access Management for VMware Cloud Foundation Added a procedure for configuring a Ping adapter for the standalone Workspace ONE Access. Uses PowerValidatedSolutions PowerShell module version 1.4.0. Validated solution now requires installation of the ImportExcel PowerShell module, when reading directly from the Planning and Preparation Workbook. Developer Ready Infrastructure for VMware Cloud Foundation Enhanced all Developer Ready Infrastructure Solution cmdlets for better error handling and message output Added Undo cmdlets to allow the rollback of procedures. Uses PowerValidatedSolutions PowerShell module version 1.4.0. Validated solution now requires installation of the ImportExcel PowerShell module, when reading directly from the Planning and Preparation Workbook. Intelligent Logging and Analytics for VMware Cloud Foundation Updates Added support for the Create Alerts in vRealize Log Insight procedure. Starting with VMware Cloud Foundation 4.4, installation and life cycle management of vRealize Log Insight is performed by using vRealize Suite Lifecycle Manager. Uses PowerValidatedSolutions PowerShell module version 1.4.0. Validated solution now requires installation of the ImportExcel PowerShell module, when reading directly from the Planning and Preparation Workbook. Intelligent Operations Management for VMware Cloud Foundation Updates Added a procedure for configuring Ping adapters for the clustered Workspace ONE Access. Starting with VMware Cloud Foundation 4.4, installation and life cycle management of vRealize Log Insight is performed by using vRealize Suite Lifecycle Manager. Uses PowerValidatedSolutions PowerShell module version 1.4.0. Validated solution now requires installation of the ImportExcel PowerShell module, when reading directly from the Planning and Preparation Workbook. Private Cloud Automation for VMware Cloud Foundation Updates Starting with VMware Cloud Foundation 4.4, installation and life cycle management of vRealize Log Insight is performed by using vRealize Suite Lifecycle Manager. Required storage for installation of vRealize Automation 8.6.2 is 738 GB compared to 708 GB for vRealize Automation 8.5 and earlier. Added design decision and procedure to install and use the vRealize Orchestrator content pack for vRealize Log Insight as part of the logging section in the solution. Uses PowerValidatedSolutions PowerShell module version 1.4.0. Validated solution now requires installation of the ImportExcel PowerShell module, when reading directly from the Planning and Preparation Workbook. Site Protection and Disaster Recovery for VMware Cloud Foundation Updates Uses PowerValidatedSolutions PowerShell module version 1.4.0. Advanced Load Balancer for VMware Cloud Foundation Updates Extend support for VMware Cloud Foundation 4.3.1 and 4.4.0. Enable support for Avi with Cloud Services (SaaS subscription). General Availability of PowerValidatedSolutions v1.4.0 Release of PowerValidatedSolutions v1.4.0, which is a PowerShell module that we have developed to not only accelerate the implementation of Validated Solutions, but ensure consistency and robustness. Here's a list of what's changed (this and previous updates can be tracked by reading the CHANGELOG.md file stored in the Git Hub repository):\nEnhanced all Developer Ready Infrastructure Solution cmdlets for better error handling and message output. Added Undo-NetworkSegment cmdlet to remove an NSX segment from an NSX Management Cluster. Added Undo-PrefixList cmdlet to remove an NSX Prefix List from an NSX Management Cluster. Added Undo-RouteMap cmdlet to remove an NSX Route Map from an NSX Management Cluster. Added Undo-DatastoreTag cmdlet to remove the vSphere Tag and Category from a datastore in vCenter Server. Added Undo-StoragePolicy cmdlet to remove a VM vSphere Storage Policy from vCenter Server. Added Undo-Registry cmdlet to disable the Embedded Harbor Registry on the Supervisor Cluster. Added Undo-SupervisorCluster cmdlet to remove the Supervisor Cluster. Added Undo-ContentLibrary cmdlet to remove a Content Library from the Workload Domain vCenter Server. Added Undo-Namespace cmdlet to remove a Namespace from the Supervisor Cluster. Added Undo-NamespacePermission cmdlet to remove permissions from a Namespace. Added Undo-TanzuKubernetesCluster cmdlet to remove a Tanzu Kubernetes Cluster from the Supervisor Cluster. Added Add-NsxtNodeProfileSyslogExporter cmdlet to add a syslog exporter to the default node profile or specified node profile id. Added Undo-NsxtNodeProfileSyslogExporter cmdlet to remove all syslog exporter from the default node profile or specified node profile id. ","link":"http://jadenetworksolutions.co.uk/post/vvs-whats-new/edition-05/","section":"post","tags":["VVS"],"title":"What's New for VMware Validated Solutions - Edition #5 (Feb 2022)"},{"body":"Last Updated: 25-Jan-2022\nWelcome to Edition #4 of the What's New for VMware Validated Solutions, today we are announcing the following changes:\nAdditional support for Dell VxRail Additional automation across solutions based on the PowerValidatedSolutions v1.3.0 release Added Support for VMware Cloud Foundation 4.3.0 / 4.3.1 on VxRail Delighted to announce support for the following Validated Solutions running on Dell VxRail based systems in addition to vSAN Ready Nodes.\nSite Protection and Disaster Recovery for VMware Cloud Foundation Intelligent Logging and Analytics for VMware Cloud Foundation Updates Implementation Added PowerValidatedSolutions automation to the following procedures:\nCreate Alerts in vRealize Log Insight (Add-vRLIAlertVirtualMachine and Add-vRLIAlertDatacenter) Intelligent Operations Management for VMware Cloud Foundation Updates Implementation Added PowerValidatedSolutions automation to the following procedures:\nConfigure User Access in vRealize Operations Manager (Import-vROPSUserGroup) Configure Email Alert Plug-in Settings for vRealize Operations Manager (Add-vROPSAlertPluginEmail) Install the SDDC Health Monitoring Solution in vRealize Operations Manager (Enable-vROPSManagementPack) Rename the SDDC Health Adapters for the vRealize Operations Manager Analytics Cluster Nodes (Update-vROPSAdapterSddcHealth) Add SDDC Health Adapters for the vRealize Operations Manager Remote Collector Nodes (Add-vROPSAdapterSddcHealth) Activate the Ping Management Pack in vRealize Operations Manager (Register-vROPSManagementPack) Add Ping Adapters for the vRealize Operations Manager Nodes (Add-vROPSAdapterPing) Create Notifications in vRealize Operations Manager for VMware Cloud Foundation Issues (Import-vROPSNotification) Private Cloud Automation for VMware Cloud Foundation Updates Implementation Added PowerValidatedSolutions automation to the following procedures:\nCreate a Virtual Machine and Template Folder and a Resource Pool for the vRealize Automation-Managed Workloads on the VI Workload Domain vCenter Server (Add-VMFolder and Add-ResourcePool) Configure the Organization Name for vRealize Automation (Update-vRAOrganizationDisplayName) Add Cloud Accounts for the VI Workload Domains to vRealize Automation (New-vRACloudAccount) Configure the Cloud Zones in vRealize Automation (Update-vRACloudAccountZone) Import the Trusted Certificates to vRealize Orchestrator (Add-vROTrustedCertificate) Restrict the vRealize Automation and vRealize Orchestrator Service Accounts Access to Virtual Machine and Datastore Folders in the VI Workload Domain (Set-vCenterPermission) Configure Email Alerts in Service Broker (Add-vRANotification) Configure Service Account Permissions for the vRealize Automation to NSX-T Data Center Integration on the VI Workload Domain NSX Manager Cluster (Add-NsxtVidmRole) Add the VI Workload Domain vCenter Server to vRealize Orchestrator (Add-vROvCenterServer) Assign Organization and Service Roles to the vRealize Operations Manager Service Account in vRealize Automation (Add-vRAUser) Assign Organization and Service Roles to the Groups for vRealize Automation (Add-vRAGroup) Developer Ready Infrastructure for VMware Cloud Foundation Updates Implementation Updates to the following procedures based on PowerValidatedSolutions v1.3.0.\nImprovements to the pre-validation of the PowerShell procedure for Deploy a Supervisor Cluster for Developer Ready Infrastructure Updated the Replace the Supervisor Cluster Kubernetes API Endpoint Certificate for Developer Ready Infrastructure PowerShell procedure (Enable-SupervisorCluster) Site Protection and Disaster Recovery for VMware Cloud Foundation Updates Implementation Added PowerValidatedSolutions automation to the following procedures:\nCreate Anti-Affinity Rules for the Placeholder Virtual Machines in the Recovery VMware Cloud Foundation Instance (Add-AntiAffinityRule) Create Virtual Machine Groups and Restart Order in the Recovery VMware Cloud Foundation Instance (Add-ClusterGroup and Add-VmStartupRule) General Availability of PowerValidatedSolutions v1.3.0 Release of PowerValidatedSolutions v1.3.0, which is a PowerShell module that we have developed to not only accelerate the implementation of Validated Solutions, but ensure consistency and robustness. Here's a list of what's changed (this and previous updates can be tracked by reading the CHANGELOG.md file stored in the Git Hub repository):\nFixed Fixed New-vRSLCMLockerLicense cmdlet where depending on the speed of the system the license would be added but POST_VALIDATION would fail. Enhancements Enhanced all Identity and Access Management Solution cmdlets for better error handling and message output. Enhanced all vRealize Operations Manager cmdlets for better error handling and message output. Enhanced all vRealize Log Insight cmdlets for better error handling and message output. Enhanced all vRealize Automation cmdlets for better error handling and message output. Enhanced Set-vCenterPermission cmdlet to set permissions on non-nested folders. Enhanced Enable-SupervisorCluster cmdlet with better pre-validation. Renamed Add-NsxtVidmGroupRole cmdlet to Add-NsxtVidmRole, to add support for assigning both users and groups roles in NSX-T Data Center. Additions Added Add-ResourcePool cmdlet to create a resource pool in the Workload Domain specified. Added Undo-ResourcePool cmdlet to remove a resource pool based on the Workload Domain specified. Added Update-vRAOrganizationDisplayName cmdlet to configure the Organization Display Name in vRealize Automation. Added Add-vROPSAdapterPing cmdlet to add a Ping Adapter to vRealize Operations Manager Added Enable-vROPSManagementPack cmdlet to upload and install the SDDC Health Management Pack to vRealize Operations Manager Added Update-vROPSAdapterSddcHealth cmdlet to rename the SDDC Health Adapters in vRealize Operations Manager Added Add-vROPSAdapterSddcHealth cmdlet to add SDDC Health Adapters for the Remote Collectors in vRealize Operations Manager Added Add-vROPSAlertPluginEmail cmdlet to add an Email Alert Plugin to vRealize Operations Manager Added Register-vROPSManagementPack cmdlet to activate / deactivate Native Management Packs in vRealize Operations Manager Added Import-vROPSUserGroup cmdlet to import a user group and assign access in vRealize Operations Manager Added Add-vROvCenterServer cmdlet to add a workload domain vCenter Server instance to the embedded vRealize Orchestrator. Added Remove-vROvCenterServer cmdlet to remove a workload domain vCenter Server instance from the embedded vRealize Orchestrator. Added Add-vROTrustedCertificate cmdlet to import a trusted certificate to the embedded vRealize Orchestrator using a PEM-encoded file. Added Import-vROPSNotification cmdlet to import notifications using comma separated value file to vRealize Operations Manager. Added Add-vRANotification cmdlet to configure the smtp notification settings in vRealize Automation. Added New-vRACloudAccount cmdlet to add Cloud Accounts for a Workload Domains vCenter Server and NSX Management Cluster in vRealize Automation. Added Undo-vRACloudAccount cmdlet to remove the Cloud Accounts for a Workload Domains vCenter Server and NSX Management Cluster in vRealize Automation. Added Update-vRACloudAccountZone cmdlet to update the configuration of the Cloud Account Zone for a Workload Domain in vRealize Automation. Added Add-vRAUser cmdlet to add an organization role and a service role to a user account in vRealize Automation. Added Undo-vRAUser cmdlet to remove an organization role and all service roles from a user account in vRealize Automation. Added Add-vRAGroup cmdlet to add an organization role and a service role to a group in vRealize Automation. Added Undo-vRAGroup cmdlet to remove an organization role and all service roles from a group account in vRealize Automation. Added Undo-IdentitySource cmdlet to remove an Identity Provider from vCenter Server. Added Undo-SddcManagerRole cmdlet to remove access for a user in SDDC Manager. Added Add-SsoUser cmdlet to add a Single Sign-On domain user. Added New-vRSLCMDatacenter cmdlet to add a datacenter in vRealize Suite Lifecycle Manager. Added Undo-vRSLCMDatacenter cmdlet to remove a datacenter from vRealize Suite Lifecycle Manager. Added New-vRSLCMDatacenterVcenter cmdlet to add a vCenter Server to a datacenter in vRealize Lifecycle Manager. Added Export-WSAJsonSpec cmdlet to generate the deployment JSON for Clustered Workspace ONE Access. Added New-WSADeployment cmdlet to trigger the deployment of Clustered Workspace ONE Access via vRealize Suite Lifecycle Maneger. Added Add-WorkspaceOneDirectoryConnector cmdlet to add a connector to the Identity Provider in Workspace ONE Access. Added Add-vRLIAlertDatacenter cmdlet to create vRealize Log Insight alerts by datacenter Added Add-vRLIAlertVirtualMachine cmdlet to create vRealize Log Insight alerts by virtual machine Added Undo-vRLIAlert cmdlet to remove alerts from vRealize Log Insight. Added Sample Notification Templates in the SampleNotifications folder: vrli-vcf-datacenter.json defines the vRealize Log Insight alerts that should be configured for VMware Cloud Foundation at the datacenter level vrli-vcf-vmVrslcm.json defines the vRealize Log Insight alerts that should be configured for vRealize Suite Lifecycle Manager Added Sample Scripts in the SampleScripts\\iom folder, each script uses the Planning and Preparation Workbook as the input source: iomDeployVrealizeOperations.ps1 automates the install and config of vRealize Operations for Intelligent Operations Management for VMware Cloud Foundation. iomConfigureVrealizeOperations.ps1 automates the integration config of vRealize Operations for Intelligent Operations Management for VMware Cloud Foundation. Check them out now at https://vmware.com/go/vvs\n","link":"http://jadenetworksolutions.co.uk/post/vvs-whats-new/edition-04/","section":"post","tags":["VVS"],"title":"What's New for VMware Validated Solutions - Edition #4 (Jan 2022)"},{"body":"If your not already familiar with the Identity and Access Management for VMware Cloud Foundation Validated Solution it’s primary purpose is to provide customers a consistent way of integrating the foundational components of VMware Cloud Foundation (vCenter Server, NSX-T Data Center and SDDC Manager) with an organizations identify provider delivering operational consistency and flexibility.\nThe Identity and Access Management solution achieves this by connecting components using Active Directory over LDAP/LDAPS and utilizing Active Directory Global Groups to assign individual component level role access and then nested Global Groups to assign a collection of roles based on personas.\nThe roles and personas documented (here) should be considered as a minimum requirement when implementing the Identity and Access Management solution but there is nothing stopping customers adding more granular roles where possible or even personas that better align with their own organizations roles and responsibilities.\nNow you have a better understanding of what the Identity and Access Management for VMware Cloud Foundation Validated Solution provides let’s look at how we can automate the implementation. Each Validated Solution provides both UI and Infrastructure-as-code based procedures. The Infrastructure-as-code method is delivered through the use of a PowerShell module specifically created to support Validated Solutions called PowerValidatedSolutions, each UI based procedure has a PowerShell cmdlet equivalent that not only performs the operation but ensures pre and post validation checks are performed to provide robustness.\nIncluded with the PowerValidatedSolution PowerShell module which can be installed directly from the Microsoft PS Gallery there is a SampleScripts folder and contained within that a folder named iam which contains sample .ps1 script files. These sample scripts demonstrate linking multiple procedures into a single executable script using the Planning and Preparation Workbook as the input for all data.\nFor the Identity and Access Management solution this is broken down into three phases and therefore three scripts as follows:\nvSphere and SDDC Manager Workspace ONE Access NSX-T Data Center As already mentioned the scripts use the Planning and Preparation Workbook to obtain all the required inputs, this is the first step in the execution. The script checks that the path provided to the workbook is valid and then opens the workbook, reading the required information using named cells.\nOnce that step is complete it begins the process of executing each procedure based on the order of steps defined within the implementation guide.\nIn addition to providing the main cmdlets supporting the validated solution implementation procedures a number of cmdlets are included that provide supporting capabilities which are utilised by the scripts.\nStart-SetupLogFile - this cmdlet is used to configure a log file where the output of each step is logged. Write-LogMessage - this cmdlet is used to format the output of messages both to the console and log file. Debug-CatchWriter - this cmdlet is used to provide a consistent way of displaying exception errors should they occur. For each procedure executed by the script, the output is captured into variables and then redirected to the Write-LogMessage cmdlet for display to the console and log in a consistent way. There are three types of output messages :\nINFO - Used for informational messages and successful execution of a procedure. WARNING - Used when a procedure is skipped due to the process already being executed. ERROR - Used to display a failure along with the failure reason. Let’s now take a deeper look at the scripts.\nvSphere and SDDC Manager (iamConfigureVsphere.ps1) The iamConfigureVsphere.ps1 script automates all the procedures associated with ESXi, vCenter Server and SDDC Manager. This includes:\nAdd Identity Provider to vCenter Server. This adds Active Directory over LDAP or LDAPS to vCenter Server making Active Directory users and groups available to both vCenter Server and SDDC Manager for assigning access control. Assign Global Permissions. This assigns the vCenter Server Administrator and Read Only roles to corresponding groups in Active Directory. Assign Single Sign-On Permissions. This assigns the Single Sign-On Administrator role to a corresponding group in Active Directory. Configure vCenter Server Appliance password expiration policy. Configure Single Sign-On password and lockout polices. Assign SDDC Manager Roles. This assigns the Admin, Operator and Viewer roles to corresponding groups in Active Directory. Configure ESXi password and lockout polices. Execution of the iamConfigureVsphere.ps1 script is performed by using the following command:\n1.\\SampleScripts\\iam\\iamConfigureVsphere.ps1 -sddcManagerFqdn sfo-vcf01.sfo.rainpole.io -sddcManagerUser administrator@vsphere.local -sddcManagerPass VMw@re1! -workbook F:\\vvs\\PnP.xlsx -filePath F:\\vvs Workspace ONE Access (iamConfigureWorkspaceOne.ps1) The iamConfigureWorkspaceOne.ps1 script automates the deployment and configuration of Workspace ONE Access. This includes:\nCreating a Virtual Machine folder in vCenter Server. Deploying the Workspace ONE Access .ova. Performing the configuration of Workspace ONE Access: Initial configuration. This assigns the root, admin and sshuser credentials. Configure NTP settings. Configure SMTP server settings. Install a signed-certificate. Configure password policy. Add Identity Provider to Workspace ONE Access. This adds Active Directory over LDAP or LDAPS to Workspace ONE Access making Active Directory users and groups available. Assign Workspace ONE Access Permissions. This assigns the Super Admin, Directory Admin and Read Only Admin to corresponding groups in Active Directory. Create VM Group. This creates a VM Group in vCenter Server and assigns the Workspace ONE Access virtual machine to it. Execution of the iamConfigureWorkspaceOne.ps1 script is performed by using the following command:\n1.\\SampleScripts\\iam\\iamConfigureWorkspaceOne.ps1 -sddcManagerFqdn sfo-vcf01.sfo.rainpole.io -sddcManagerUser administrator@vsphere.local -sddcManagerPass VMw@re1! -workbook F:\\vvs\\PnP.xlsx -filePath F:\\vvs NSX-T Data Center (iamConfigureNsx.ps1) The iamConfigureNsx.ps1 script automates the integration between the NSX Managers and Workspace ONE Access. Whilst it is possible to configure NSX-T Data Center with a direct connection to Active Directory over LDAP, the Identity and Access Management solution uses Workspace ONE Access which provides additional methods for connecting to authentication sources. This includes:\nEnable Integration between NSX Manager and Workspace ONE Access. Assign NSX-T Data Center Permissions. This assigns Enterprise Admin, Network Engineer and Auditor roles to corresponding groups in Active Directory for both the Management and Workload Domains. Configure Authentication Policies. This configure the authentication policies on the NSX Manager and NSX Edge Nodes for both the Management and Workload Domains. Create a custom role in vCenter Server. Assign Single Sign-On Permissions. This assigns the License Administration role to the NSX Manager service account used by SDDC Manager. Reduce vCenter Server Permissions. This reduces the permissions a specific vCenter Server service account has for other vCenter Servers within the Single Sign-On domain. Execution of the iamConfigureNsx.ps1 script is performed by using the following command:\n1.\\SampleScripts\\iam\\iamConfigureNsx.ps1 -sddcManagerFqdn sfo-vcf01.sfo.rainpole.io -sddcManagerUser administrator@vsphere.local -sddcManagerPass VMw@re1! -workbook F:\\vvs\\PnP.xlsx -filePath F:\\vvs After execution of these scripts in the order described above, and assuming that each step completed successfully your environment is fully configured based on the design and implementation procedures documented within the Identity and Access Management for VMware Cloud Foundation Validated Solution.\n","link":"http://jadenetworksolutions.co.uk/post/vvs/vvs-end-to-end-iam/","section":"post","tags":["API","PowerShell","VVS","IAM"],"title":"End-to-End Automation of Identity and Access Management Validated Solution"},{"body":"","link":"http://jadenetworksolutions.co.uk/tags/iam/","section":"tags","tags":null,"title":"IAM"},{"body":"","link":"http://jadenetworksolutions.co.uk/categories/powercli/","section":"categories","tags":null,"title":"PowerCLI"},{"body":"","link":"http://jadenetworksolutions.co.uk/series/powervalidatedsolutions/","section":"series","tags":null,"title":"PowerValidatedSolutions"},{"body":"","link":"http://jadenetworksolutions.co.uk/series/vvs-tip/","section":"series","tags":null,"title":"VVS-Tip"},{"body":"Are you using the PowerValidatedSolutions PowerShell module? Have you found an issue that you want to report? Maybe you have an enhancement idea!\nThe source code for PowerValidatedSolutions can be found on Git Hub at https://github.com/vmware-samples/power-validated-solutions-for-cloud-foundation, from here you can log issues and enhancements. Fork the branch and provide direct contributions.\n","link":"http://jadenetworksolutions.co.uk/post/vvs-tips/vvs-tip-07/","section":"post","tags":["API","PowerShell"],"title":"VVS-Tip - Contributing to PowerValidatedSolutions Source Code"},{"body":"Did you know that the PowerShell module PowerValidatedSolution can be used for more than implementing the VMware Validated Solutions?\nWhilst the primary goal for the PowerShell module has been to enable a robust and automated way to implement the various procedures across solutions, its very nature unlocks the power for cmdlet's to be used across the VMware portfolio. One of the fundamental directives for our development work was to minimize the reliance on other PowerShell modules. There are many community based modules on PS Gallery some of which already provided some of the functionality we required however because they are community based future development is not guaranteed and we have no direct control to fix issues in a timely manner.\nWe do utilize PowerCLI first and foremost and for VMware Cloud Foundation APIs PowerVCF both of which are VMware developed but beyond that we have created an array of functions which support the following products:\nvCenter Server NSX-T Data Center Workspace ONE Access vRealize Suite Lifecycle Manager vRealize Log Insight vRealize Operations Manager vRealize Automation Download PowerValidatedSolutions and check them out.\n","link":"http://jadenetworksolutions.co.uk/post/vvs-tips/vvs-tip-06/","section":"post","tags":["API","PowerShell"],"title":"VVS-Tip - Unlocking Automation Capabilities with PowerValidatedSolutions"},{"body":" I'm pleased to announce the general availability of PowerVCF v2.1.7 for download from the PowerShell Library. PowerVCF is a open source project and the team works on adding support when time permits.\nDownload It Here: PowerVCF PowerShell Library Download\nFixes Fixed New-VCFClustercmdlet where incorrect braces prevented the ability to retrieve response information. Enhancements Renamed Set-VCFvRLIConnection cmdlet from Set-VCFvRLI to align with new Get-VCFvRLIConnection cmdlet. Renamed Set-VCFvROPSConnection cmdlet from Set-VCFvROPs to align with new Get-VCFvROPSConnection cmdlet. Updated New-VCFLicenseKey cmdlet to support additonal license types \u0026quot;WCP\u0026quot;, \u0026quot;NSXV\u0026quot;, \u0026quot;HORIZON_VIEW\u0026quot;. Updated Get-VCFvROPs cmdlet to display API output in an easier to read format. Updated Get-VCFWSA cmdlet to display API output in an easier to read format. Updated Get-VCFvRA cmdlet to display API output in an easier to read format. Updated Get-VCFvRLI cmdlet to display API output in an easier to read format. Additions Added Get-VCFvRLIConnection cmdlet to get the connection status of VI Workload Domains to vRealize Log Insight. Added Get-VCFvROPSConnection cmdlet to get the connection status of VI Workload Domains to vRealize Operations Manager. If you would like to learn more about VMware Cloud Foundation or PowerVCF, check out these links:\nVMware Cloud Foundation Documentation PowerVCF Documentation PowerVCF v2.1.7 PowerShell Library Download ","link":"http://jadenetworksolutions.co.uk/post/powervcf/powervcf-ga-217/","section":"post","tags":["API","PowerShell","VCF"],"title":"PowerVCF v2.1.7 - General Availability"},{"body":"Last Updated: 30-Nov-2021\nWelcome to Edition #3 of the What's New for VMware Validated Solutions, today we are announcing the following changes:\nGeneral Availability of PowerValidatedSolutions v1.2.0 Release of PowerValidatedSolutions v1.2.0, which is a PowerShell module that we have developed to not only accelerate the implementation of Validated Solutions, but ensure consistency and robustness. Here's a list of what's changed (this and previous updates can be tracked by reading the CHANGELOG.md file stored in the Git Hub repository here):\nFixed Add-GlobalPermission where an error is thrown when Internet Explorer has not been launched in the operating system. Fixed Set-DatastoreTag where it was failing to create a single tag and catagory when multiple vCenter Servers in the Single-Sign On domain. Fixed Add-StoragePolicy where is was failing to add the storage policy when multiple vCenter Servers in the Single-Sign On domain Enhanced Move-VMtoFolder cmdlet to check the name of VM provided and skip if it does not exist. Enhanced Add-WorkspaceOneDirectory cmdlet so that it can be used with Clustered Workspace ONE Access. Enhanced Set-WorkspaceOneSmtpConfig cmdlet to skip the configuration if the SMTP Server configuration is already performed. Added Export-vRLIJsonSpec cmdlet to generate the Json specification file needed to deploy vRealize Log Insight via vRealize Lifecycle Suite Manager. Added New-vRLIDeployment cmdlet to deploy vRealize Log Insight via vRealize Lifecycle Suite Manager in VMware Cloud Foundation aware mode. Added Add-vRLIAuthenticationWSA cmdlet to support configuring Workspace ONE Access integration with vRealize Log Insight. Added Add-WorkspaceOneDirectoryGroup cmdlet to Sync additional Active Directory groups with Workspace ONE Access. Added Export-vROPSJsonSpec cmdlet to generate the Json specification file needed to deploy vRealize Operations Manager via vRealize Lifecycle Suite Manager. Added New-vROPSDeployment cmdlet to deploy vRealize Operations Manager via vRealize Lifecycle Suite Manager in VMware Cloud Foundation aware mode. Added Export-vRASJsonSpec cmdlet to generate the Json specification file needed to deploy vRealize Automation via vRealize Lifecycle Suite Manager. Added New-vRADeployment cmdlet to deploy vRealize Automation via vRealize Lifecycle Suite Manager in VMware Cloud Foundation aware mode. Added Install-vRLIPhotonAgent cmdlet to download, install and configure the vRealize Log Insight Agent on Photon Operating System. Added Add-vRLIAgentGroup cmdlet to create an Agent Group in vRealize Log Insight Added Register-vRLIWorkloadDomain cmdlet to connect/disconnect a Workload Domain with vRealize Log Insight. Added Set-vRLISyslogEdgeCluster cmdlet to configure the Syslog settings for each NSX Edge node within a Workload Domains NSX Edge Cluster. Added Add-vRLISmtpConfiguation cmdlet to configure the SMTP Server settings for vRealize Log Insight Added Add-vRLILogArchive cmdlet to configure Email Notifications, Retention and Archive Location for vRealize Log Insight Added Register-vROPSWorkloadDomain cmdlet to connect/disconnect a Workload Domain with vRealize Operations Manager. Added Add-vROPSCurrency cmdlet to configure the currency for vRealize Opertations Manager Added Add-vROPSGroupRemoteCollectors cmdlet to create a Remote Collector Group and assign the remote collectors in vRealize Operations Manager Added Update-vROPSAdapterVcenter cmdlet to update the Remote Collector Group assignment for the vCenter Server Adapter in vRealize Operations Manager Added Add-vROPSCredentialNsxt cmdlet to create an NSX credential in vRealize Operations Manager Added Add-vROPSAdapterNsxt cmdlet to create an NSX Adapter and Start Collection in vRealize Operations Manager Added Undo-vRSLCMLockerPassword cmdlet to remove a password from the vRealize Suite Lifecycle Manager Locker. Added Undo-vRSLCMLockerCertificate cmdlet to remove a certificate from the vRealize Suite Lifecycle Manager Locker. Added Undo-vRSLCMLockerLicense cmdlet to remove a license from the vRealize Suite Lifecycle Manager Locker. Added Undo-VMFolder cmdlet to remove a folder from vCenter Server Added Add-vRLIAuthenticationGroup cmdlet to assign vRealize Log Insight roles to Workspace ONE Access Groups. Added Sample Scripts in the SampleScripts\\iam folder, each script uses the Planning and Preparation Workbook as the input source: iamConfigureVsphere.ps1 automates all the configuration of vSphere/SDDC Manager elements for Identity and Access Management for VMware Cloud Foundation. iamConfigureWorkspaceOne.ps1 automates all the configuration of Workspace ONE Access elements for Identity and Access Management for VMware Cloud Foundation. iamConfigureNsx.ps1 automates all the configuration of the NSX elements for Identity and Access Management for VMware Cloud Foundation. Added Sample Scripts in the SampleScripts\\ila folder, each script uses the Planning and Preparation Workbook as the input source: ilaDeployVrealizeLogInsight.ps1 automates the install and config of vRealize Log Insight for Intelligent Logging and Analytics for VMware Cloud Foundation. ilaConfigureVrealizeLogInsight.ps1 automates the integration config of vRealize Log Insight for Intelligent Logging and Analytics for VMware Cloud Foundation. Added New-SupervisorClusterCSR cmdlet to create a new certificate signing request for the defined Supervisor Cluster Added Add-SupervisorClusterCertificate cmdlet to add a signed TLS certificate for the defined Supervisor Cluster Added Add-NamespaceVmClass cmdlet to add an existing VM Class to a Supervisor Namespace Intelligent Logging and Analytics for VMware Cloud Foundation Updates Implementation Combined the following procedures:\nDownload and Install the vRealize Log Insight Agent on the Clustered Workspace ONE Access Nodes Configure the vRealize Log Insight Agent on the Clustered Workspace ONE Access Nodes Into a new single procedure:\nDownload, Install and Configure the vRealize Log Insight Agent on the Clustered Workspace ONE Access Nodes Added PowerValidatedSolutions automation to the following procedures:\nDeploy vRealize Log Insight by Using vRealize Suite Lifecycle Manager (New-vRLIDeployment) Configure SMTP for vRealize Log Insight (New-vRLIDeployment) Configure Log Retention and Archiving for vRealize Log Insight (Add-vRLILogArchive) Enable Authentication for vRealize Log Insight by Using Workspace ONE Access (Add-vRLIAuthenticationWSA) Sync Active Directory Groups to Workspace ONE Access (Add-WorkspaceOneDirectoryGroup) Assign vRealize Log Insight Roles to Active Directory Groups (Add-vRLIAuthenticationGroup) Connect a VI Workload Domain to vRealize Log Insight (Register-vRLIWorkloadDomain) Configure the NSX Edge Nodes to Forward Log Events to vRealize Log Insight (Set-vRLISyslogEdgeCluster) Download, Install and Configure the vRealize Log Insight Agent on the Clustered Workspace ONE Access Nodes (Install-vRLIPhotonAgent) Configure the vRealize Log Insight Agent Group for the Clustered Workspace ONE Access (Add-vRLIAgentGroup) Create a vRealize Log Insight Photon OS Agent Group for the Management Nodes (Add-vRLIAgentGroup) Intelligent Operations Management for VMware Cloud Foundation Updates Implementation Added PowerValidatedSolutions automation to the following procedures:\nDeploy vRealize Operations Manager by Using vRealize Suite Lifecycle Manager (New-vROPSDeployment) Synchronize the Groups for vRealize Operations Manager from the Identity Provider into Workspace ONE Access (Add-WorkspaceOneDirectoryGroup) Group the vRealize Operations Manager Remote Collector Nodes (Add-vROPSGroupRemoteCollectorsy) Set the Currency for Cost Calculation in vRealize Operations Manager (Add-vROPSCurrency) Connect vRealize Operations Manager to the VI Workload Domains in the First VMware Cloud Foundation Instance (Register-vROPSWorkloadDomain) Modify the vCenter Server Adapters for the First VMware Cloud Foundation Instance in vRealize Operations Manager (Update-vROPSAdapterVcenter) Add NSX-T Data Center Adapters in vRealize Operations Manager (Add-vROPSAdapterNsxt) Private Cloud Automation for VMware Cloud Foundation Updates Implementation Added PowerValidatedSolutions automation to the following procedures:\nDeploy vRealize Automation by Using vRealize Suite Lifecycle Manager (New-vRADeployment) Synchronize the Groups for vRealze Automation from the Identity Provider into Workspace ONE Access (Add-WorkspaceOneDirectoryGroup) Developer Ready Infrastructure for VMware Cloud Foundation Updates Implementation Added PowerValidatedSolutions automation to the following procedures:\nReplace the Supervisor Cluster Kubernetes API Endpoint Certificate (New-SupervisorClusterCSR and Add-SupervisorClusterCertificate) Enable a Virtual Machine Class for the Tanzu Kubernetes Cluster (Add-NamespaceVmClass) Site Protection and Disaster Recovery for VMware Cloud Foundation Updates Operational Guidance Added Shutdown and Startup procedures Navigation Improvements on core.vmware.com And lastly based on feedback we are making a few adjustments to the navigation experience on core.vmware.com which is the marketplace for all VMware Validated Solutions, here’s a list of what’s new:\nRenamed Quick Links to Solution Quick Links - to remove confusion we have renamed the Quick Links menu bar to Solution Quick Links, so when your looking at a specific solution resource page there is a difference between this quick link label and the main VMware Validated Solutions landing page. Added Quick Link to Update History – each time the documentation for a VMware Validated Solution is updated, what’s changed is tracked in an Update History table within the solution documentation. This new Quick Link will take you directly to this section of the documentation. ","link":"http://jadenetworksolutions.co.uk/post/vvs-whats-new/edition-03/","section":"post","tags":["VVS"],"title":"What's New for VMware Validated Solutions - Edition #3 (Nov 2021)"},{"body":"Each VMware Validated Solution places certain configuration requirements on VMware Cloud Foundation, this detailed is documented within the Before You Apply This Guidance section of the Solution Guide.\nTo locate the Before You Apply This Guidance use the following process:\nConnect to the VMware Validated Solutions landing page on core.vmware.com.\nClick View Resource Page for the Validated Solution your interested in.\nClick Read More under the Design Objectives tile.\nClick on the top page of the docs.vmware.com page. Using the right-hand menu under In this article select Before You Apply This Guidance. ","link":"http://jadenetworksolutions.co.uk/post/vvs-tips/vvs-tip-05/","section":"post","tags":["VVS"],"title":"VVS-Tip - Identify What’s Required from a VMware Cloud Foundation Perspective"},{"body":"","link":"http://jadenetworksolutions.co.uk/tags/backup/","section":"tags","tags":null,"title":"Backup"},{"body":"By default when VMware Cloud Foundation is deployed, SDDC Manager and NSX-T Data Center are configured to use an SFTP service running locally on the SDDC Manager Appliance. For production environments its critical that this is changed before going live to ensure that you have the ability to recover in the event of a disaster.\nThe requirements of using an SFTP in my experience seem to fall through the gaps during most initial deployments and as a result it takes organizations some time to get all the requirements put in place. Such delays simply place a risk on the implementation until addressed.\nOne way to reduce this risk, and of course for use in a lab environment is to use VMware Cloud Builder as an alternative short term solution as it too has an SFTP service running, this can be achieved through a simple three step process:\nCreate a Backup Service Account on the VMware Cloud Builder Appliance Create a Backup Folder on the VMware Cloud Builder Appliance Re-Configure the Backup in SDDC Manager Create a Backup Service Account on the VMware Cloud Builder Appliance First step is to create a local account on the VMware Cloud Builder Appliance, this will be used as the service account and is supplied when re-configuring the backup configuration in SDDC Manager.\nConnect to the SDDC Manager Appliance using an SSH client such as Putty, and authenticate as admin.\nSwitch to root by entering the following command:\n1su Create the service account by entering the following command: 1useradd -m -p $(openssl passwd -1 VMw@re1!) svc-vcf-bck Create a Backup Folder on the VMware Cloud Builder Appliance The next step is to create a target backup folder on the VMware Cloud Builder Appliance and assign the appropriate access to allow the service account to store backup jobs.\nCreate a new folder by entering the following command: 1mkdir /tmp/vcf-backups Configure access to the folder for the service account by entering the following command: 1chown svc-vcf-bck:users /tmp/vcf-backups Re-Configure the Backup in SDDC Manager And finally you re-configure the backup configuration to use the new SFTP target for backups, performing this task will trigger SDDC Manager to automatically reconfigure SDDC Manager and NSX-T Data Center.\nLogin to the SDDC Manager UI with a user assigned with the ADMIN role.\nUsing the navigation paine, select Administration \u0026gt; Backup.\nOn the Backup paine, select Site Settings and click Register External. Enter the values, and click Save.\nSetting Value Host FQDN or IP sfo-cb01.sfo.rainpole.io Port 22 Transfer Protocol SFTP Username svc-vcf-bck Password VMw@re1! Backup Directory /tmp/vcf-backups Confirm Fingerprint Selected Encryption Passphares VMw@re1!VMw@re1! On the Confirm your changes to backup settings dialog, click Confirm. Your details will be saved and the Configure Backup of VCF Components (SDDC Manager and NSX Managers) task will start. NOTE\nThe SDDC Manager UI procedure is valid for VMware Cloud Foundation 4.3.0 and later.\n","link":"http://jadenetworksolutions.co.uk/post/vcf/vcf-cb-backup/","section":"post","tags":["API","VCF","PowerShell","Backup"],"title":"Configure VMware Cloud Builder as a Backup Target for SDDC Manager"},{"body":"","link":"http://jadenetworksolutions.co.uk/categories/vmware-cloud-builder/","section":"categories","tags":null,"title":"VMware Cloud Builder"},{"body":"Last Updated: 10-Nov-2021\nVMware Validated Solutions are byte sized solutions developed to extend the foundational capabilities of VMware Cloud Foundation, for background reading see my previous post here. To help customers get the most out of VMware Validated Solutions I've put together a number of short tips, bookmark this page for easy access.\nRemember to check back from time to time!\nQuickly Identify the Version of VMware Cloud Foundation Supported Quickly Identify the Last Time Content Was Updated Review Detailed Update History for a Validated Solution Quickly Identify the Architecture Supported Identify What’s Required from a VMware Cloud Foundation Perspective Unlocking Automation Capabilities with PowerValidatedSolutions Contributing to PowerValidatedSolutions Source Code ","link":"http://jadenetworksolutions.co.uk/post/vvs-tips/vvs-tip-index/","section":"post","tags":["VVS"],"title":"VMware Validated Solutions - Tips Index"},{"body":"Each VMware Validated Solution is validated against a specific architecture configuration of VMware Cloud Foundation, to confirm and identify if your configuration is supported you use the Design Objectives table.\nConnect to the VMware Validated Solutions landing page on core.vmware.com.\nClick View Resource Page for the Validated Solution your interested in.\nClick Read More under the Design Objectives tile.\nReview the VMware Cloud Foundation architecture support and Workload domain type support rows to confirm support. ","link":"http://jadenetworksolutions.co.uk/post/vvs-tips/vvs-tip-04/","section":"post","tags":["VVS"],"title":"VVS-Tip - Quickly Identify the Architecture Supported"},{"body":"When updates are made to VMware Validated Solutions the changes could affect a section of the guide or the whole guide, each page within the guide itself has an Updated on value at the top of the page.\nIn addition its possible to identify where content has changed from individual Validated Solution resource page on core.vmware.com, each tile which provides a link to a particular section of the content has a date too, this is updated each time changes are made within that section.\n","link":"http://jadenetworksolutions.co.uk/post/vvs-tips/vvs-tip-02/","section":"post","tags":["VVS"],"title":"VVS-Tip - Quickly Identify the Last Time Content Was Updated"},{"body":"As each VMware Validated Solution is updated its important that you as the customer are able to obtain a precise and accurate account of what has changed within the guide, Validated Solutions do this through the use of an Update History table that is published within the About section of the document.\nTo locate the Update History use the following process:\nConnect to the VMware Validated Solutions landing page on core.vmware.com.\nClick View Resource Page for the Validated Solution your interested in.\nClick Read More under the Design Objectives tile.\nClick on the top page of the docs.vmware.com page. Using the right-hand menu under In this article select Update History. ","link":"http://jadenetworksolutions.co.uk/post/vvs-tips/vvs-tip-03/","section":"post","tags":["VVS"],"title":"VVS-Tip - Review Detailed Update History for a Validated Solution"},{"body":"VMware Validated Solutions have been developed so that they can support multiple versions of VMware Cloud Foundation, this means they only need to be updated when absolutely necessary which is typically driven by significant architecture changes.\nThere are two methods that you can use to identify if a particular solution is supported for the VMware Cloud Foundation release you have deployed.\nMethod One - Viewing Tags on core.vmware.com VMware utilizes a single landing page within the Cloud Platform Tech Zone website known as core.vmware.com once you select VMware Validated Solutions, you are presented with tiles where each tile represents a single Validated Solution.\nInside each tile there is a Tags label, if you simply click Tags a dialog window will open and from here under Products you can quickly identify which releases of VMware Cloud Foundation are supported.\nMethod Two - View the Solution Guide Support Matrix Contained within each Validated Solution guide there is a Support Matrix table, this is contained within the About page. In the example below taken from the Identity and Access Management for VMware Cloud Foundation Validated Solution you can see the table contains a link to the VMware Cloud Foundation Release Notes and clearly calls out the version of the products added by the solution.\nTo locate this Support Matrix use the following process:\nConnect to the VMware Validated Solutions landing page on core.vmware.com.\nClick View Resource Page for the Validated Solution your interested in.\nClick Read More under the Design Objectives tile.\nClick on the top page of the docs.vmware.com page.\nUsing the right-hand menu under In this article select Support Matrix. Quick Links Below are quick links to each Validated Solutions Support Matrix:\nIdentity and Access Management for VMware Cloud Foundation - Support Matrix Developer Ready Infrastructure for VMware Cloud Foundation - Support Matrix Private Cloud Automation for VMware Cloud Foundation - Support Matrix Intelligent Logging and Analytics for VMware Cloud Foundation - Support Matrix Intelligent Operations Management for VMware Cloud Foundation - Support Matrix Site Protection and Disaster Recovery for VMware Cloud Foundation - Support Matrix Advanced Load Balancing for VMware Cloud Foundation - Support Matrix ","link":"http://jadenetworksolutions.co.uk/post/vvs-tips/vvs-tip-01/","section":"post","tags":["VVS"],"title":"VVS-Tip - Quickly Identify the Version of VMware Cloud Foundation Supported"},{"body":"Last Updated: 26-Oct-2021\nWelcome to Edition #2 of the What's New for VMware Validated Solutions, today we are announcing a number of incremental changes:\nAdditional support for Dell VxRail Additional automation across solutions based on the PowerValidatedSolutions v1.1.0 release Additional Operational Guidance Added Support for VMware Cloud Foundation 4.3.0 / 4.3.1 on VxRail Delighted to announce support of the following Validated Solutions running on Dell VxRail based systems in addition to vSAN Ready Nodes.\nIntelligent Logging and Analytics for VMware Cloud Foundation Intelligent Operations Management for VMware Cloud Foundation Private Cloud Automation for VMware Cloud Foundation Intelligent Logging and Analytics for VMware Cloud Foundation Updates Implementation Added PowerValidatedSolutions automation to the following procedures:\nAdd vRealize Log Insight License to vRealize Suite Lifecycle Manager (New-vRSLCMLockerLicense) Add the vRealize Log Insight Admin Password to vRealize Suite Lifecycle Manager (New-vRSLCMLockerPassword) Add the vRealize Log Insight Virtual Machines to the First Availability Zone VM Group (Add-VmGroup) Operational Guidance Added Shutdown and Startup procedures Intelligent Operations Management for VMware Cloud Foundation Updates Implementation Added PowerValidatedSolutions automation to the following procedures:\nAdd vRealize Operations Manager License to vRealize Suite Lifecycle Manager (New-vRSLCMLockerLicense) Add the vRealize Operations Manager Password to vRealize Suite Lifecycle Manager (New-vRSLCMLockerPassword) Add the vRealize Operations Manager Virtual Machines to the First Availability Zone VM Group (Add-VmGroup) Operational Guidance Added Shutdown and Startup procedures Private Cloud Automation for VMware Cloud Foundation Updates Implementation Added PowerValidatedSolutions automation to the following procedures:\nAdd vRealize Automation License to vRealize Suite Lifecycle Manager (New-vRSLCMLockerLicense) Add the vRealize Automation Password to vRealize Suite Lifecycle Manager (New-vRSLCMLockerPassword) Add the vRealize Automation Cluster Virtual Machines to the First Availability Zone VM Group (Add-VmGroup) Restrict the vRealize Automation and vRealize Orchestrator Service Accounts Access to the Management Domain (Set-vCenterPermission) Configure a Publishing Content Library on the First VI Workload Domain vCenter Server (Add-ContentLibrary) Configure Subscribed Content Libraries on an Additional VI Workload Domain vCenter Server (Add-ContentLibrary) Operational Guidance Added Shutdown and Startup procedures Identity and Access Management for VMware Cloud Foundation Updates Implementation Added a new procedure which is used when vRealize Log Insight is deployed under the Intelligent Logging and Analytics for VMware Cloud Foundation\nCreate a VM Group for the Standalone Workspace ONE Access Instance Operational Guidance Added Shutdown and Startup procedures Developer Ready Infrastructure for VMware Cloud Foundation Updates Operational Guidance Added Shutdown and Startup procedures ","link":"http://jadenetworksolutions.co.uk/post/vvs-whats-new/edition-02/","section":"post","tags":["VVS"],"title":"What's New for VMware Validated Solutions - Edition #2 (Oct 2021)"},{"body":"Last Updated: 05-Oct-2021\nLast month we released VMware Validated Solutions for background reading check out my original post here, this fundamental shift in developing VMware Validated Solutions now allows us to deliver incremental value over time, this is just the first of what I hope to be many updates but I'm really excited to share the following announcements with you all today:\nGeneral Availability of Site Protection and Disaster Recovery for VMware Cloud Foundation The Site Protection and Disaster Recovery for VMware Cloud Foundation Validated Solution, illustrates adapting a dual-instance software-defined data center (SDDC), deployed on top of VMware Cloud Foundation, to provide disaster recovery of the vRealize Automation and vRealize Operations Manager components within the Management Domain as well as lay the foundation to protected customer workloads within the VI Workload Domain.\nCheck out the following blog posts from my colleagues Brian O'Connell and Ken Gould who are the driving force behind the development and delivery of this Validated Solution:\nKen Gould Blog: Planning \u0026amp; Preparation for Site Protection and Disaster Recovery with VMware Cloud Foundation Brian O'Connell Blog: Site Protection \u0026amp; Disaster Recovery for VMware Cloud Foundation Validated Solution VMworld Sessions If you're registered for VMworld 2021, then check out the following sessions for more information on a few of our Validated Solutions, if your not registered for VMworld what are you doing get signed up now!\n[MCL2371] Enabling Security and Automation Services in VMware Cloud Foundation Fleets [MCL1544] Meet the Experts: Site Protection and Disaster Recovery for VMware Cloud Foundation [MCL1543] Meet the Experts: Intelligent Operations Management for VMware Cloud Foundation Added Support for VMware Cloud Foundation 4.3.1 Since the initial release of VMware Validated Solutions, VMware has shipped an updated version of VMware Cloud Foundation. The team has been validating each solution based on VMware Cloud Foundation 4.3.1 and has officially updated the support matrix accordingly for the following Validated Solutions:\nIdentity and Access Management for VMware Cloud Foundation Develop Ready Infrastructure for VMware Cloud Foundation Intelligent Logging and Analytics for VMware Cloud Foundation Intelligent Operations Management for VMware Cloud Foundation Private Cloud Automation for VMware Cloud Foundation Added Support for VMware Cloud Foundation 4.3.0 / 4.3.1 on VxRail In addition to updated support for VMware Cloud Foundation 4.3.1 we are also delighted to announce support of the following Validated Solutions running on Dell VxRail based systems in addition to vSAN Ready Nodes. We plan to validate the remaining Validated Solutions and update the support status in due course.\nIdentity and Access Management for VMware Cloud Foundation Develop Ready Infrastructure for VMware Cloud Foundation General Availability of PowerValidatedSolutions v1.1.0 And finally I'm excited to share the release of PowerValidatedSolutions v1.1.0, which is a PowerShell module that we have developed to not only accelerate the implementation of Validated Solutions, but ensure consistency and robustness. Here's a list of what's changed:\nA number of new functions have been added to support automation of the Site Protection and Disaster Recovery solution: Install-SiteRecoveryManager Install-vSphereReplicationManager Connect-DRSolutionTovCenter Install-VAMICertificate Backup-VMOvfProperties Restore-VMOvfProperties Copy-vRealizeLoadBalancer Added New-vRSLCMLockerPassword cmdlet to support adding passwords to the vRealize Lifecycle Suite Manager Locker Added New-vRSLCMLockerLicense cmdlet to support adding licenses to the vRealize Lifecycle Suite Manager Locker Enhanced Add-VmStartupRule to check both VM Groups exists before attempting to create the VM-to-VM Group Enhanced Add-ContentLibrary to support creation of both Published and Subscription Content Libraries Added Add-VmGroup cmdlet to support adding Virtual Machines to existing VM Groups (Availability Zones in particular) Fixed Set-vCenterPermission where a failure can occur if the workload domain does not follow the same naming as the vCenter Server ","link":"http://jadenetworksolutions.co.uk/post/vvs-whats-new/edition-01/","section":"post","tags":["VVS"],"title":"What's New for VMware Validated Solutions - Edition #1"},{"body":" I'm pleased to announce the general availability of PowerVCF v2.1.3 for download from the PowerShell Library. PowerVCF is a open source project and the team works on adding support when time permits.\nDownload It Here: PowerVCF PowerShell Library Download\nEnhancements Updated ResponseException cmdlet to improve the error handling message output. Additions Added Add-VCFApplicationVirtualNetwork cmdlet to create the Application Virtual Networks. If you would like to learn more about VMware Cloud Foundation or PowerVCF, check out these links:\nVMware Cloud Foundation Documentation PowerVCF Documentation PowerVCF v2.1.3 PowerShell Library Download ","link":"http://jadenetworksolutions.co.uk/post/powervcf/powervcf-ga-213/","section":"post","tags":["API","PowerShell","VCF"],"title":"PowerVCF v2.1.3 - General Availability"},{"body":"Background For those of you who are not familiar with VMware Cloud Builder its a virtual appliance that is shipped as part of VMware Cloud Foundation. It's primary goal is to bootstrap the deployment and configuration of the Management Domain which includes ESXi, vCenter Server, NSX-T Data Center and SDDC Manager.\nVMware Cloud Builder was first released to support the automated deployment of the VMware Validated Design 5.0 and as part of that development work the team started with a virtual appliance known as Cloud VM which was used by Service Providers to deploy a different version of VMware Cloud Foundation back in the 2.x days. There were two challenges that the team had to overcome with the Cloud VM and they were no User Interface for easy use as it was an API only driven tool and more importantly there was no validation capabilities.\nAs part of this validation development work I had the pleasure of leading a very small team which produced a Python based utility called PlatformAudit. It's purpose was to expose the ability to perform any validation requirements we could define in a modular way. When VMware Cloud Foundation 3.0 was released it too started to consume the VMware Cloud Builder virtual appliance and naturally we extended the capabilities of PlatformAudit to handle both VMware Cloud Foundation and VMware Cloud Foundation on VxRail.\nAs VMware Cloud Foundation has evolved in terms of features naturally the validation requirements evolved too but rather than add new validation tasks into the Python modules we took a decision some time ago to build any new validation directly into the Bring-up service. This decision was made for a number of reasons but the main driver was the ability to consolidate the tasks into a single framework and code-base that could then be consumed by both VMware Cloud Builder during bring-up but more importantly by SDDC Manager for day N workflows.\nAs you can imagine these types of changes don't happen over night so the team had to combine both methods for a period of time whilst they worked on the migration of all the existing Python based validation tasks. Frankly the team did a fantastic job of this, those reading this post that are already familiar with VMware Cloud Builder were probably not even aware this ongoing transition was happening.\nThe release of VMware Cloud Foundation v4.2 sees this transitional work conclude, and not only do we now have all validation tasks being completed by the Bring-up service directly we also now have the ability to trigger validations on an individual basis (via the API only) something which was a number one requirement for the Python modules when I started on the journey with the team back then. The ability to execute single modules helps with early validation of some areas and accelerates troubleshooting on specific failures as running all validations steps each time takes some time.\nPlatformAudit is still present within VMware Cloud Builder for now but officially it has been deprecated, none of the new validation tasks exist within it and it will be removed in a future release.\nTriggering Individual Validations Let's now take a look at how you trigger individual validations, as mentioned already this is possible only by using the API right now and this can be achieved either directly from the console of VMware Cloud Builder using a curl command or by using PowerVCF a PowerShell Module that has been written to support all VMware Cloud Foundation Public APIs.\nFor both methods \u0026lt;PATH_TO_JSON_SPEC\u0026gt; is the path to the VMware Cloud Builder JSON spec to be used and \u0026lt;VALIDATION_NAME\u0026gt; is the name of the validation module you want to execute.\nUsing CURL the format of the command is:\n1curl -d @\u0026lt;PATH_TO_JSON_SPEC\u0026gt; -X POST -H \u0026#34;Content-Type\u0026#34;:\u0026#34;application/json\u0026#34; http://localhost:9080/bringup-app/v1/sddcs/validations?\u0026lt;VALIDATION_NAME\u0026gt; Using PowerVCF (v2.1.1 or later) the format of the command is:\u0026lt;\n1Start-CloudBuilderSDDCValidation -json \u0026lt;PATH_TO_JSON_SPEC\u0026gt; -validation \u0026lt;VALIDATION_NAME\u0026gt; Validation Modules We now have two methods that we can use to perform individual validations but what validation options do we have, use the following table to identity the validation module you want to execute (I'm planning a separate post with more details on what each validation module actually does in the near future):\nValidation Name for API Validation Name in the UI SECURE_PLATFORM_AUDIT Preparing Security Requirements for Running Validation JSON_SPEC_VALIDATION JSON Spec validation CLOUDBUILDER_READY_VALIDATION Cloud Builder Configuration Validation LICENSE_KEY_VALIDATION License Key Validation PASSWORDS_VALIDATION Password Validation NETWORK_IP_POOLS_VALIDATION Network IP Pool Validation HOST_IP_DNS_VALIDATION DNS Resolution Validation TIME_SYNC_VALIDATION Time Synchronization Validation NETWORK_CONFIG_VALIDATION Network Configuration Validation MANAGEMENT_NETWORKS_VALIDATION vMotion Network Connectivity Validation\nvSAN Network Connectivity Validation ESXI_VERSION_VALIDATION ESXi Version Validation ESXI_HOST_READINESS_VALIDATION ESXi Host Configuration Validation VSAN_AVAILABILITY_VALIDATION vSAN Disk Availability Validation NSXT_NETWORKS_VALIDATION NSX-T Data Center Host Overlay Network Connectivity Validation AVN_NETWORKS_VALIDATION NSX-T Data Center Edge Overlay Network Connectivity Validation\nNSX-T Data Center Uplink 1 Network Connectivity Validation\nNSX-T Data Center Uplink 2 Network Connectivity Validation\nNSX-T Data Center Host Overlay to Edge Overlay Network Connectivity Validation ","link":"http://jadenetworksolutions.co.uk/post/vcf/vcf-cb-validation/","section":"post","tags":["VCF"],"title":"VMware Cloud Builder - Bringup Validation for VMware Cloud Foundation"},{"body":" I'm pleased to announce the general availability of PowerVCF v2.1.2 for download from the PowerShell Library. PowerVCF is a open source project and the team works on adding support when time permits.\nDownload It Here: PowerVCF PowerShell Library Download\nThis latest release is a very minor update containing a few bug fixes as well as adding support for the new VIEWER Role added in VMware Cloud Foundation 4.2 within the New-VCFGroup cmdlet.\nIf you would like to learn more about VMware Cloud Foundation or PowerVCF, check out these links:\nVMware Cloud Foundation Documentation PowerVCF Documentation PowerVCF v2.1.2 PowerShell Library Download ","link":"http://jadenetworksolutions.co.uk/post/powervcf/powervcf-ga-212/","section":"post","tags":["API","PowerShell","VCF"],"title":"PowerVCF v2.1.2 - General Availability"},{"body":"On February 9th VMware released VMware Cloud Foundation 4.2, and with it a number of new security enhancements, one of which means that each ESXi host used for either a Management Domain or Workload Domain now requires the self-signed certificate for the ESXi host to have its common name matching the real FQDN assigned to the host.\nFailure to follow the procedure will result in the validation task failing with the error message: 'SSL Certificate common name doesn’t match ESXi FQDN'.\nThe VMware Cloud Foundation documentation includes details regarding this requirement as well as the procedure that must be followed to fix the issue.\nVMware Cloud Foundation Deployment Guide VMware Cloud Foundation Operations and Administration Guide Assuming you have stumbled across this post after seeing the error mentioned, I've included a document extract and the procedure you need to follow.\nDocumentation Extract\nDuring the installation of ESXi, the installer generates a self-signed certificate for each ESXi host but the process is performed prior to the ESXi identity being configured. This means all ESXi hosts have a common name in their self-signed certificate of localhost.localdomain. All communication between VMware Cloud Builder and the ESXi hosts is performed securely over HTTPS and as a result it validates the identify when making a connection by comparing the common name of the certificate against the FQDN provided within the VMware Cloud Builder configuration file.\nTo ensure that the connection attempts and validation does not fail, you must manually regenerate the self-signed certificate after hostname has been configured.\nRegenerate the Self-Signed Certificate on All Hosts Log in to the ESXi host using an SSH client such as Putty.\nRegenerate the self-signed certificate by executing the following command:\n1/sbin/generate-certificates Restart the hostd and vpxa services by executing the following command: 1/etc/init.d/hostd restart \u0026amp;\u0026amp; /etc/init.d/vpxa restart Repeat this procedure for all remaining hosts. ","link":"http://jadenetworksolutions.co.uk/post/vcf/vcf-cb-esxi-certs/","section":"post","tags":["VCF"],"title":"VMware Cloud Builder Validation: SSL Certificate common name doesn’t match ESXi FQDN"},{"body":"","link":"http://jadenetworksolutions.co.uk/archive/","section":"archive","tags":null,"title":"Archives"},{"body":"","link":"http://jadenetworksolutions.co.uk/archive/2020/","section":"archive","tags":["index"],"title":"Posts"},{"body":"This week I was doing some testing in my home lab, and purely by accident I entered some details incorrect into the VI Configuration Wizard which walks you through the inputs to deploy a Workload Domain in VMware Cloud Foundation. I had wrongly entered the FQDN of the Management Domain vCenter Server instead of the new Workload Domain vCenter server, I didn't notice this until I found the deployment task in a failed state.\nFor those not familiar with VMware Cloud Foundation when a task fails SDDC Manager does give you the ability to retry the task from the Task list but unfortunately it does not give you the opportunity to modify any of the input data. At first I thought I was in no man's land and would not be able to complete the new Workload Domain deployment but after talking to a colleague who referred me to this KB70602 article as a reference I proceeded to attempt translating the procedure and test in my setup. Low and behold it worked and I was able to recover from my issue and complete the deployment, so I thought I would document the steps here in case it helps get someone else out of jail.\nProcedure\nIn the SDDC Manager UI, navigate to the Task list and click the failed task to see the sub-tasks.\u0026lt; In the browser URL make a note of the workflow ID of the task. Connect to the SDDC Manager appliance using and SSH client such as Putty using the vcf user.\nEnter su to switch to the root user and enter the password.\nObtain the Workflow Spec information by running the following command, using the Workflow ID from Step 2.\n1curl -s http://localhost/domainmanager/internal/vault/1faab6e8-4dfb-46bb-8860-8133df44b196 | json_pp \u0026gt; /tmp/workflow.json Edit the Workload Spec json, and replace the input details that are incorrect. 1vi /tmp/workflow.json Update the Workflow Spec by passing the edited json file with the new details by running the following command. 1curl -H \u0026#39;Content-Type:text/plain\u0026#39; -X PUT http://localhost/domainmanager/internal/vault/1faab6e8-4dfb-46bb-8860-8133df44b196 -d @/tmp/workflow.json In the SDDC Manager UI, navigate to the Task list and click Retry Task for the failed workflow. Your workflow should now complete.\n","link":"http://jadenetworksolutions.co.uk/archive/2020/vcf-retry-failure/","section":"archive","tags":["VCF"],"title":"VMware Cloud Foundation - Retrying a Failed Workflow"},{"body":" I'm pleased to announce the general availability of PowerVCF v2.1.1 for download from the PowerShell Library. PowerVCF is a open source project and the team works on adding support when time permits.\nDownload It Here: PowerVCF PowerShell Library Download\nThe following table provides a detailed breakdown of all the cmdlet changes for this release.\nCategorycmdlet NameDescriptionCommentUsers and GroupsGet-VCFCredentialRetrieves a list of credentials.UPDATE: Added support for the vRealize credentialsBundlesStart-VCFBundleUploadStarts upload of bundle to SDDC ManagerUPDATE: Allows the import of a bundle based on offline download.FederationNew-VCFFederationInviteInvite new member to VCF FederationUPDATE: Added support to specify if the new system is a MEMBER or CONTROLLER. SDDCStart-CloudBuilderSDDCValidationStarts validation on VMware Cloud BuilderUPDATE: Added support for individual validation tasks.Workspace ONE AccessGet-VCFWSAGet details of the existing Workspace ONE AccessNEWvRealize AutomationGet-VCFvRAGet details of the the existing vRealize AutomationNEWvRealize OperationsGet-VCFvROPsGet details of the existing vRealize Operations ManagerNEWvRealize OperationsSet-VCFvROPsConnect or disconnect Workload Domains to vRealize Operations ManagerNEWvRealize Log InsightGet-VCFvRLIGet details of the existing vRealize Log InsightNEWvRealize Log InsightSet-VCFvRLIConnect or disconnect Workload Domains to vRealize Log InsightNEWvRealize Suite LifecycleGet-VCFvRSLCMGet details of the existing vRealize Suite Lifecycle ManagerUPDATE: Fixed an issue with the API URI and addressed response output If you would like to learn more about VMware Cloud Foundation or PowerVCF, check out these links:\nVMware Cloud Foundation Documentation VMware Cloud Foundation General FAQ PowerVCF Documentation PowerVCF v2.1.1 PowerShell Library Download ","link":"http://jadenetworksolutions.co.uk/post/powervcf/powervcf-ga-211/","section":"post","tags":["API","PowerShell","VCF"],"title":"PowerVCF v2.1.1 - General Availability"},{"body":" This is the sixth and final blog in a series that discusses automating VMware Cloud Foundation using the Public APIs and PowerVCF. The series illustrates deploying the Management Domain, creating a Network Pool, commissioning ESXi host, deploying a Workload Domain including NSX-T Edge Cluster and vRealize Suite Lifecycle Manager.\nIn this post, we will take a look at how to initiate the vRealize Suite Lifecycle Manager deployment workflow in SDDC Manager.\nVMware Cloud Foundation APIs Used\nGET /v1/bundles POST /v1/bundles POST /v1/vrslcms GET /v1/tasks/{id} PowerVCF Cmdlets\nGet-VCFBundle Request-VCFBundle New-VCFvRSLCM Get-VCFTask PowerShell Scripts\ncreateDeployVrslcmAvnSpec.ps1 Procedure\nDownload and populate the Planning and Preparation Workbook for your target platform.\nTo generate the JSON spec using inputs from the Planning and Preparation Workbook run the following command:\n1.\\createDeployVrslcmAvnSpec.ps1 -Workbook \u0026#34;E:\\pnpWorkbook.xlsx\u0026#34; -Json \u0026#34;E:\\MyLab\\sfo\\sfo-vrslcmDeploy.json\u0026#34; -sshPassword \u0026#34;VMw@re1!\u0026#34; -apiPassword \u0026#34;VMw@re1!\u0026#34; The createDeployVrslcmAvnSpec.ps1 script will open the supplied Planning and Preparation Workbook, read the 'Management Domain' tab into a variable and then proceed to generate the JSON spec required by the Public API.\nAuthenticate to the SDDC Manager appliance by running the following command: 1Request-VCFToken -fqdn \u0026#34;sfo-vcf01.sfo.rainpole.io\u0026#34; -username \u0026#34;administrator@vsphere.local\u0026#34; -password \u0026#34;VMw@re1!\u0026#34; Obtain the bundle ID of for vRealize Suite Lifecycle Manager by running the following command: 1$bundleDetails = Get-VCFBundle | Where {$_.description -Match \u0026#34;vRealize\u0026#34;} In this step we use the Get-VCFBundle cmdlet to capture the bundle ID for vRealize Suite Lifecycle Manager. We will use this in the next step to download the bundle.\nObtain the vRealize Suite Lifecycle Manager bundle by running the following command: 1Request-VCFBundle -id $bundleDetails.id In this procedure we are using the Request-VCFBundle cmdlet to request the download of the vRealize Suite Lifecycle Manager bundle.\nPoll the status of the bundle download, by running the following command: 1Do { $status = Get-VCFBundle -id $bundleDetails.id} While ($status.downloadStatus -eq \u0026#34;IN_PROGRESS\u0026#34;) Start the vRealize Suite Lifecycle Manager deployment workflow by running the following command: 1$deployVrslcm = New-VCFvRSLCM -json \u0026#34;E:\\MyLab\\sfo\\sfo-vrslcmDeploy.json\u0026#34; Using the New-VCFvRSLCM cmdlet, we trigger the vRealize Suite Lifecycle Manager deployment workflow, here I'm capturing the output of the command into a variable to be used in the next step.\nPoll the status of the vRealize Suite Lifecycle Manager deployment workflow, by running the following command: 1Do { $status = Get-VCFTask -id $deployVrslcm.id ;} While ($status.status -eq \u0026#34;In Progress\u0026#34;) Here we are polling the status of the workflow, using the unique ID from the New-VCFvRSLCM cmdlet which we retrieve from the variable $deployVrslcm.id and pass to the Get-VCFTask cmdlet. We perform a Do / While loop where we are looking for status of \u0026quot;In Progress\u0026quot;, once the state changes from \u0026quot;In Progress\u0026quot; we break from the loop.\nThat completes the process of generating a vRealize Suite Lifecycle Manager JSON spec used by the public API and running the deployment workflow in SDDC Manager.\nOther Posts in Series Automating VMware Cloud Foundation with APIs/PowerVCF/PowerShell Automating VCF - Deploy Management Domain Automating VCF - Create Network Pool Automating VCF - Commission Hosts Automating VCF - Deploy Workload Domain Automating VCF - Deploy NSX-T Edge Cluster Automating VCF - Deploy vRealize Suite Lifecycle Manager ","link":"http://jadenetworksolutions.co.uk/archive/2020/powervcf-automation-06/","section":"archive","tags":["API","PowerShell","VCF"],"title":"Automating VCF – Deploy vRealize Suite Lifecycle Manager"},{"body":"","link":"http://jadenetworksolutions.co.uk/series/vcf-automation/","section":"series","tags":null,"title":"VCF Automation"},{"body":" I'm pleased to announce the general availability of PowerVCF v2.1.0 for download from the PowerShell Library. PowerVCF is a open source project and the team works on adding support when time permits.\nDownload It Here: PowerVCF PowerShell Library Download\nWhat's New in PowerVCF v2.1.0 Here's a run down of what's new in this release:\nRename of a few existing cmdlets to align with approved verbsEnhancements to execution response messagesRemoval of the use of Write-Host The following table provides a detailed breakdown of all the cmdlet changes for this release.\nCategorycmdlet NameDescriptionCommentUsers and GroupsNew-VCFGroupCreate a GroupNEWUsers and GroupsGet-VCFUser\u0026nbsp;Users and GroupsGet-VCFUser\u0026nbsp;Get all Users in SDDC ManagerUPDATED - Support input value of -type (USER, GROUP, SERVICE)Users and GroupsGet-VCFUserGet all Users in SDDC ManagerUPDATED - Support input value of -domain to retrieve all accounts by domainUpgradablesGet-VCFUpgradableGet list of upgradablesUPDATED - Improved outputUpgradesGet-VCFUpgradeGets list of upgradable components in the SystemNEWUpgradesStart-VCFUpgradeStarts the upgradeNEWSDDCRestart-CloudBuilderSDDCRestarts deployment in Cl;oud GeneralRequest-VCFTokenRequests API access \u0026amp; refresh tokensUPDATED - Renamed from Connect-VCFManagerHostsNew-VCFCommissionedHostCommission a HostUPDATED - Renamed from Commission-VCFHostHostsRemove-VCFCommissionedHostDecommission a HostUPDATED - Renamed from Decommission-VCFHostDNS and NTP ConfigurationGet-VCFConfigurationDNSGets the current DNS ConfigurationNEWDNS and NTP ConfigurationGet-VCFConfigurationDNSValidationGet the status of the validation of the input for the DNS ConfigurationNEWDNS and NTP ConfigurationSet-VCFConfigurationDNSConfigures DNS for all systemsNEWDNS and NTP ConfigurationGet-VCFConfigurationNTP\u0026nbsp;Gets the current NTP ConfigurationNEWDNS and NTP ConfigurationGet-VCFConfigurationNTPValidationet the status of the validation of the input for the NTP ConfigurationNEWDNS and NTP ConfigurationSet-VCFConfigurationNTPConfigures NTP for all systemsNEWLicense KeysGet-VCFLicenseKeyGets all License Keys in SDDC ManagerUPDATED - Added -productType and -status as command line inputsLicense KeysNew-VCFLicenseKeyAdds a new License Key to SDDC ManagerUPDATED - No longer requires a JSON spec all command lineFederationSet-VCFFederationBootstrap a VMware Cloud Foundation to form a federationUPDATED - Now supports JSON file or a JSON variable as inputCEIPSet-VCFCeipSets the CEIP status (Enabled/Disabled)UPDATED - Code improvement and command line inputs for -ceipSettingBackup and RestoreSet-VCFBackupConfigurationConfigure backup settings for NSX and SDDC managerUPDATED - Now supports JSON file or a JSON variable as inputSystem PrechecksStart-VCFSystemPrecheckStarts system level health checksUPDATED - Now supports JSON file or a JSON variable as input If you would like to learn more about VMware Cloud Foundation or PowerVCF, check out these links:\nVMware Cloud Foundation DocumentationVMware Cloud Foundation General FAQVMware Cloud Foundation 4.0 Release NotesPowerVCF DocumentationPowerVCF v2.1.0 PowerShell Library Download ","link":"http://jadenetworksolutions.co.uk/post/powervcf/powervcf-ga-210./","section":"post","tags":["API","PowerShell","VCF"],"title":"PowerVCF v2.1.0 - General Availability"},{"body":" This is the fifth of six blogs in a series that discusses automating VMware Cloud Foundation using the Public APIs and PowerVCF. The series illustrates deploying the Management Domain, creating a Network Pool, commissioning ESXi host, deploying a Workload Domain including NSX-T Edge Cluster and vRealize Suite Lifecycle Manager.\nIn this post, we take a look at how to initiate the NSX-T edge cluster deployment in SDDC Manager.\nVMware Cloud Foundation APIs Used\nGET /v1/clusters POST /v1/edge-clusters GET /v1/tasks/{id} **PowerVCF Cmdlets\nGet-VCFCluster New-VCFEdgeCluster Get-VCFTask PowerShell Scripts\ncreateWorkloadEdgeSpec.ps1 Procedure\nDownload and populate the Planning and Preparation Workbook for your target platform.\nTo generate the JSON spec using inputs from the Planning and Preparation Workbook run the following command:\n1.\\createWorkloadEdgeSpec.ps1 -Workbook \u0026#34;E:\\pnpWorkbook.xlsx\u0026#34; -Json \u0026#34;E:\\MyLab\\sfo\\sfo-workloadEdge.json\u0026#34; -nsxtPassword \u0026#34;VMw@re1!VMw@re1!\u0026#34; The createWorkloadEdgeSpec.ps1 script will open the supplied Planning and Preparation Workbook, read the Workload Domain tab into a variable and then proceed to generate the JSON spec required by the Public API.\nYou will notice that we are passing in an additional value relating to passwords for NSX-T, this is because the Planning and Preparation Workbook does not store any passwords.\nAuthenticate to the SDDC Manager appliance by running the following command: 1Request-VCFToken -fqdn \u0026#34;sfo-vcf01.sfo.rainpole.io\u0026#34; -username \u0026#34;administrator@vsphere.local\u0026#34; -password \u0026#34;VMw@re1!\u0026#34; Obtain details around the workload domain from the JSON spec created during the workload domain workflow by running the following command: 1$workloadDomain = (Get-Content \u0026#34;E:\\MyLab\\sfo\\sfo-workloadDomain.json\u0026#34;) | ConvertFrom-Json In this step we are capturing all of the details from the JSON spec of the workload domain. We will use this in the next step to obtain the workload domain name.\nObtain the VCF Cluster details by running the following command: 1$cluster = Get-VCFCluster | Where {$_.name -eq $($workloadDomain.computeSpec.clusterSpecs.name)} In this procedure we are using the Get-VCFCluster cmdlet to obtain the cluster information with a name that matches the value from $workloadDomain.computeSpec.clusterSpecs.name.\nUpdate the CLUSTER-ID value in the JSON spec with the unique ID of the workload domain cluster by running the following command: 1(Get-Content \u0026#34;E:\\MyLab\\sfo\\sfo-workloadEdge.json\u0026#34;) | Foreach-Object {$_ -replace ‘CLUSTER-ID\u0026#39;, $($cluster.id)} | Set-Content \u0026#34;E:\\MyLab\\sfo\\sfo-workloadEdge.json\u0026#34; In this procedure we are performing a search and replace in the sfo-workloadEdge.json where we replace CLUSTER-ID with the unique id of the VMware Cloud Foundation Cluster contained in the $cluster.id element of the variable from step 5.\nStart the edge cluster deployment workflow by running the following command: 1$workloadEdge = New-VCFEdgeCluster -json \u0026#34;E:\\MyLab\\sfo\\sfo-workloadEdge.json\u0026#34; Using the New-VCFEdgeCluster cmdlet, we trigger the edge cluster deployment workflow, here I'm capturing the output of the command into a variable to be used in the next step.\nAs part of the New-VCFEdgeCluster cmdlet we also execute the validation API to check the JSON spec prior to actually triggering the workflow, if an error exists the process will abort allowing you fix things up before trying again.\nPoll the status of the edge cluster deployment workflow, by running the following command: 1Do { $status = Get-VCFTask -id $workloadEdge.id} While ($status.status -eq \u0026#34;In Progress\u0026#34;) Here we are polling the status of the workflow, using the unique ID from the New-VCFEdgeCluster cmdlet which we retrieve from the variable $workloadEdge.id and pass to the Get-VCFTask cmdlet. We perform a Do / While loop where we are looking for status of \u0026quot;In Progress\u0026quot;, once the state changes from \u0026quot;In Progress\u0026quot; we break from the loop.\nThat completes the process of generating a edge cluster JSON spec used by the public API and running the edge cluster deployment workflow in SDDC Manager.\nOther Posts in Series Automating VMware Cloud Foundation with APIs/PowerVCF/PowerShell Automating VCF - Deploy Management Domain Automating VCF - Create Network Pool Automating VCF - Commission Hosts Automating VCF - Deploy Workload Domain Automating VCF - Deploy NSX-T Edge Cluster Automating VCF - Deploy vRealize Suite Lifecycle Manager ","link":"http://jadenetworksolutions.co.uk/archive/2020/powervcf-automation-05/","section":"archive","tags":["API","PowerShell","VCF"],"title":"Automating VCF – Deploy NSX-T Edge Cluster"},{"body":" This is the fourth of six blogs in a series that discusses automating VMware Cloud Foundation using the Public APIs and PowerVCF. The series illustrates deploying the Management Domain, creating a Network Pool, commissioning ESXi host, deploying a Workload Domain including NSX-T Edge Cluster and vRealize Suite Lifecycle Manager.\nIn this post, we take a look at how to initiate the workload domain deployment in SDDC Manager.\nVMware Cloud Foundation APIs Used\nPOST /v1/domains POST /v1/domains/validations GET /v1/hosts GET /v1/tasks/{id} PowerVCF Cmdlets\nNew-VCFWorkloadDomain Get-VCFHost Get-VCFTask PowerShell Scripts\ncreateWorkloadDomainSpec.ps1 Procedure\nDownload and populate the Planning and Preparation Workbook for your target platform.\nTo generate the JSON spec using inputs from the Planning and Preparation Workbook run the following command:\n1.\\createWorkloadDomainSpec.ps1 -Workbook \u0026#34;E:\\pnpWorkbook.xlsx\u0026#34; -Json \u0026#34;E:\\MyLab\\sfo\\sfo-workloadDomain.json\u0026#34; -vCenterPassword \u0026#34;VMw@re1!\u0026#34; -nsxtPassword \u0026#34;VMw@re1!VMw@re1!\u0026#34; The createWorkloadDomainSpec.ps1 script will open the supplied Planning and Preparation Workbook, read the Workload Domain tab into a variable and then proceed to generate the JSON spec required by the Public API.\nYou will notice that we are passing in a couple of additional values relating to passwords for vCenter and NSX-T, this is because the Planning and Preparation Workbook does not store any passwords.\nAuthenticate to the SDDC Manager appliance by running the following command: 1Request-VCFToken-fqdn \u0026#34;sfo-vcf01.sfo.rainpole.io\u0026#34; -username \u0026#34;administrator@vsphere.local\u0026#34; -password \u0026#34;VMw@re1!\u0026#34; Obtain details about the ESXi host from SDDC Manager by running the following command: 1$host01 = Get-VCFHost -Status UNASSIGNED_USEABLE | Select-Object fqdn,id | Where-Object {$_.fqdn -eq \u0026#34;sfo01-w01-esx01.sfo.rainpole.io\u0026#34;} In this step we use the Get-VCFHost cmdlet to retrieve into the variable $host01 details about the ESXi host stored in the SDDC Manager inventory with a status of UNASSIGNED_USEABLE, we only need the unique ID really but I'm using the Select-Object command to limit the details to fqdn and id. We will use the variable in the next step.\nUpdate the HOST-1 value in the JSON spec with the unique ID of the first ESXi host by running the following command: 1(Get-Content \u0026#34;E:\\MyLab\\sfo\\sfo-workloadDomain.json\u0026#34;) | Foreach-Object {$_ -replace \u0026#34;HOST-1\u0026#34;, $($host01.id)} | Set-Content \u0026#34;E:\\MyLab\\sfo\\sfo-workloadDomain.json\u0026#34; In this procedure we are performing a search and replace in the sfo-workloadDomain.json where we replace HOST-1 with the unique id of the ESXi host contained in the $host01.id element of the variable from step 4.\nRepeat Step 4 and 5 for the remaining three ESXi hosts by running the following commands: 1$host02 = Get-VCFHost -Status UNASSIGNED_USEABLE | Select-Object fqdn,id | Where-Object {$_.fqdn -eq \u0026#34;sfo01-w01-esx02.sfo.rainpole.io\u0026#34;} 2 3(Get-Content \u0026#34;E:\\MyLab\\sfo\\sfo-workloadDomain.json\u0026#34;) | Foreach-Object {$_ -replace \u0026#34;HOST-2\u0026#34;, $($host02.id)} | Set-Content \u0026#34;E:\\MyLab\\sfo\\sfo-workloadDomain.json\u0026#34; 4 5$host03 = Get-VCFHost -Status UNASSIGNED_USEABLE | Select-Object fqdn,id | Where-Object {$_.fqdn -eq \u0026#34;sfo01-w01-esx03.sfo.rainpole.io\u0026#34;} 6 7(Get-Content \u0026#34;E:\\MyLab\\sfo\\sfo-workloadDomain.json\u0026#34;) | Foreach-Object {$_ -replace \u0026#34;HOST-3\u0026#34;, $($host03.id)} | Set-Content \u0026#34;E:\\MyLab\\sfo\\sfo-workloadDomain.json\u0026#34; 8 9$host04 = Get-VCFHost -Status UNASSIGNED_USEABLE | Select-Object fqdn,id | Where-Object {$_.fqdn -eq \u0026#34;sfo01-w01-esx04.sfo.rainpole.io\u0026#34;} 10 11(Get-Content \u0026#34;E:\\MyLab\\sfo\\sfo-workloadDomain.json\u0026#34;) | Foreach-Object {$_ -replace \u0026#34;HOST-4\u0026#34;, $($host04.id)} | Set-Content \u0026#34;E:\\MyLab\\sfo\\sfo-workloadDomain.json\u0026#34; Start the workload domain deployment workflow by running the following command: 1$workloadDeployment = New-VCFWorkloadDomain -json \u0026#34;E:\\MyLab\\sfo\\sfo-workloadDomain.json\u0026#34; Using the New-VCFWorkloadDomain cmdlet, we trigger the workload domain deployment workflow, here I'm capturing the output of the command into a variable to be used in the next step.\nAs part of the New-VCFWorkloadDomain cmdlet we also execute the validation API to check the JSON spec prior to actually triggering the workload domain deployment workflow, if an error exists the process will abort allowing you fix things up before trying again.\nPoll the status of the workload domain deployment workflow, by running the following command: 1Do { $status = Get-VCFTask -id $workloadDeployment.id} While ($status.status -eq \u0026#34;In Progress\u0026#34;) Here we are polling the status of the workflow, using the unique ID from the New-VCFWorkloadDomain cmdlet which we retrieve from the variable $workloadDeployment.id and pass to the Get-VCFTask cmdlet. We perform a Do / While loop where we are looking for status of \u0026quot;In Progress\u0026quot;, once the state changes from \u0026quot;In Progress\u0026quot; we break from the loop.\nThat completes the process of generating a workload domain JSON spec used by the public API and running the workload domain deployment workflow in SDDC Manager.\nOther Posts in Series Automating VMware Cloud Foundation with APIs/PowerVCF/PowerShell Automating VCF - Deploy Management Domain Automating VCF - Create Network Pool Automating VCF - Commission Hosts Automating VCF - Deploy Workload Domain Automating VCF - Deploy NSX-T Edge Cluster Automating VCF - Deploy vRealize Suite Lifecycle Manager ","link":"http://jadenetworksolutions.co.uk/archive/2020/powervcf-automation-04/","section":"archive","tags":["API","PowerShell","VCF"],"title":"Automating VCF – Deploy Workload Domain"},{"body":" This is the third of six blogs in a series that discusses automating VMware Cloud Foundation using the Public APIs and PowerVCF. The series illustrates deploying the Management Domain, creating a Network Pool, commissioning ESXi host, deploying a Workload Domain including NSX-T Edge Cluster and vRealize Suite Lifecycle Manager.\nIn this post, we take a look at how to commission hosts in SDDC Manager, and consume the new network pool to support a workload domain deployment.\nVMware Cloud Foundation APIs Used\nPOST /v1/hosts GET /v1/network-pools GET /v1/tasks/{id} PowerVCF Cmdlets\nCommission-VCFHost Get-VCFNetworkPool Get-VCFTask PowerShell Scripts\ncreateCommissionHostSpec.ps1 Procedure\nDownload and populate the Planning and Preparation Workbook for your target platform.\nTo generate the JSON spec using inputs from the Planning and Preparation Workbook run the following command:\n1.\\createCommissionHostSpec.ps1 -Workbook \u0026#34;E:\\MyLab\\pnpWorkbook.xlsx\u0026#34; -Json \u0026#34;E:\\MyLab\\sfo\\sfo-workloadCommissionHosts.json\u0026#34; The createCommissionHostSpec.ps1 script will open the supplied Planning and Preparation Workbook, read the Workload Domain tab into a variable and then proceed to generate the JSON spec required by the Public API.\nAuthenticate to the SDDC Manager appliance by running the following command: 1Request-VCFManager -fqdn \u0026#34;sfo-vcf01.sfo.rainpole.io\u0026#34; -username \u0026#34;administrator@vsphere.local\u0026#34; -password \u0026#34;VMw@re1!\u0026#34; Obtain the details of the network pool by running the following command: 1$networkPool = Get-VCFNetworkPool | Where {$_.name -eq $networkPoolName} Using the Get-VCFNetworkPool cmdlet we want to retrieve the details of the new network pool from SDDC Manager and store them in a variable which is used in the next step. Here we are using the $networkPoolName variable which is created during the execution of the createCommissionHostSpec.ps1 script to identify the name of the network pool as defined in the Planning and Preparation Workbook.\nUpdate the POOL-ID value in the JSON spec with the unique ID of the network pool by running the following command: 1(Get-Content \u0026#34;E:\\MyLab\\sfo\\sfo-workloadCommissionHosts.json\u0026#34;) | Foreach-Object {$_ -replace \u0026#39;POOL-ID\u0026#39;, $($networkPool.id)} | Set-Content \u0026#34;E:\\MyLab\\sfo\\sfo-workloadCommissionHosts.json\u0026#34; In this procedure we are performing a search and replace in the sfo-workloadCommissionHosts.json where we replace POOL-ID with the unique id of the network pool contained in the $networkPool.id element of the variable from step 5.\nStart the commissioning host workflow by running the following command: 1$commissionHosts = Commission-VCFHost -json :E:\\MyLab\\sfo\\sfo-workloadCommissionHosts.json\u0026#34; Using the Commission-VCFHosts cmdlet, we trigger the commissioning hosts workflow, here I'm capturing the output of the command into a variable to be used in the next step.\nPoll the status of the commission host workflow, by running the following command: 1Do { $status = Get-VCFTask -id $commissionHosts.id} While ($status.status -eq \u0026#34;In Progress\u0026#34;) Here we are polling the status of the workflow, using the unique ID from the Commission-VCFHost cmdlet which we retrieve from the variable $commissionHosts.id and pass this time to the Get-VCFTask cmdlet. We perform a Do / While loop where we are looking for status of \u0026quot;In Progress\u0026quot;, once the state changes from \u0026quot;In Progress\u0026quot; we break from the loop.\nThat completes the process of generating a commission hosts JSON spec used by the public API and running the commission hosts workflow in SDDC Manager.\nOther Posts in Series Automating VMware Cloud Foundation with APIs/PowerVCF/PowerShell Automating VCF - Deploy Management Domain Automating VCF - Create Network Pool Automating VCF - Commission Hosts Automating VCF - Deploy Workload Domain Automating VCF - Deploy NSX-T Edge Cluster Automating VCF - Deploy vRealize Suite Lifecycle Manager ","link":"http://jadenetworksolutions.co.uk/archive/2020/powervcf-automation-03/","section":"archive","tags":["API","PowerShell","VCF"],"title":"Automating VCF – Commission Hosts"},{"body":" This is the second of six blogs in a series that discusses automating VMware Cloud Foundation using the Public APIs and PowerVCF. The series illustrates deploying the Management Domain, creating a Network Pool, commissioning ESXi host, deploying a Workload Domain including NSX-T Edge Cluster and vRealize Suite Lifecycle Manager.\nIn this post, we take a look at how to create a new network pool in SDDC Manager to support a workload domain deployment.\nVMware Cloud Foundation APIs Used\nPOST /v1/network-pools PowerVCF Cmdlets\nNew-VCFNetworkPool PowerShell Scripts\ncreateNetworkPool.ps1 Procedure\nDownload and populate the Planning and Preparation Workbook for your target platform.\nTo generate the JSON spec using inputs from the Planning and Preparation Workbook run the following command:\n1.\\createNetworkPoolSpec.ps1 -Workbook \u0026#34;E:\\MyLab\\pnpWorkbook.xlsx\u0026#34; -Json \u0026#34;E:\\MyLab\\sfo\\sfo-workloadNetworkPool.json\u0026#34; The createNetworkPool.ps1 script will open the supplied Planning and Preparation Workbook, read the Workload Domain tab into a variable and then proceed to generate the JSON spec required by the Public API.\nAuthenticate to the SDDC Manager appliance by running the following command: 1Request-VCFToken -fqdn \u0026#34;sfo-vcf01.sfo.rainpole.io\u0026#34; -username \u0026#34;administrator@vsphere.local\u0026#34; -password \u0026#34;VMw@re1!\u0026#34; Create the new network pool by running the following command: 1New-VCFNetworkPool -json \u0026#34;E:\\MyLab\\sfo\\sfo-workloadNetworkPool.json\u0026#34; That completes the process of generating a network pool JSON spec used by the public API and creating the network pool in SDDC Manager.\nOther Posts in Series Automating VMware Cloud Foundation with APIs/PowerVCF/PowerShell Automating VCF - Deploy Management Domain Automating VCF - Create Network Pool Automating VCF - Commission Hosts Automating VCF - Deploy Workload Domain Automating VCF - Deploy NSX-T Edge Cluster Automating VCF - Deploy vRealize Suite Lifecycle Manager ","link":"http://jadenetworksolutions.co.uk/archive/2020/powervcf-automation-02/","section":"archive","tags":["API","PowerShell","VCF"],"title":"Automating VCF – Create Network Pool"},{"body":" This is the first of six blogs in a series that discusses automating VMware Cloud Foundation using the Public APIs and PowerVCF. The series illustrates deploying the Management Domain, creating a Network Pool, commissioning ESXi host, deploying a Workload Domain including NSX-T Edge Cluster and vRealize Suite Lifecycle Manager.\nIn this post, we take a look at how to deploy the Management Domain using VMware Cloud Builder.\nThe first step would typically be to download and populate the Deployment Parameters Workbook that is provided as part of VMware Cloud Builder, but in this series of blog posts we are going to generate everything we need using the new Planning and Preparation Workbook.\nVMware Cloud Builder APIs Used\nPOST /v1/sddcs/validations GET /v1/sddcs/validations/{id} POST /v1/sddcs GET /v1/sddcs/validations/{id} PowerVCF Cmdlets\nConnect-CloudBuilder Start-CloudBuilderSDDCValidation Get-CloudBuilderSDDCValidation Start-CloudBuilderSDDC Get-CloudBuilderSDDC PowerShell Scripts\ncreateManagementDomainSpec Procedure\nDownload and populate the Planning and Preparation Workbook for your target platform.\nTo generate the JSON spec using inputs from the Planning and Preparation Workbook run the following command:\n1.\\createManagementDomainSpec.ps1 -Workbook \u0026#34;E:\\MyLab\\pnpWorkbook.xlsx\u0026#34; -Json \u0026#34;E:\\MyLab\\sfo\\sfo-managementDomain.json\u0026#34; -defaultPassword \u0026#34;VMw@re1!\u0026#34; -nsxtPassword \u0026#34;VMw@re1!VMw@re1!\u0026#34; The createManagementDomainSpec script will open the supplied Planning and Preparation Workbook, read the 'Workload Domain' tab into a variable and then proceed to generate the JSON spec required by the VMware Cloud Builder Public API. Because no passwords are stored in the Workbook we also need to pass default passwords for NSX-T (-nsxtPassword switch) and all other components (-defaultPassword switch), these are passed as part of the command line input of the script.\nAuthenticate to the VMware Cloud Builder appliance by running the following command: 1Connect-CloudBuilder -fqdn \u0026#34;sfo-cb01.sfo.rainpole.io\u0026#34; -username \u0026#34;admin\u0026#34; -password \u0026#34;VMw@re1!\u0026#34; Perform a validation of the JSON spec file and the target platform by running the following command:\n1$sddcValidation = Start-CloudBuilderSDDCValidation -json \u0026#34;E:\\MyLab\\sfo\\sfo-managementDomain.json\u0026#34; Using the Start-CloudBuilderSDDCValidation cmdlet, we trigger the validation process, here I'm capturing the output of the command into a variable to be used in the next step.\nPoll the status of the validation task, by running the following command: 1Do { $status = Get-CloudBuilderSDDCValidation -id $sddcValidation.id;} While ($status.executionStatus -eq \u0026#34;IN_PROGRESS\u0026#34;) Here we are using the unique ID from the Start-CloudBuilderSDDCValidation cmdlet which we retrieve from the variable $sddcValidation.id and then pass to the Get-CloudBuilderSDDCValidation cmdlet. Then we are doing a Do / While loop where we are looking for an executionStatus of \u0026quot;IN_PROGRESS\u0026quot;, once the state changes from \u0026quot;IN_PROGRESS\u0026quot; we break from the loop.\nAssuming the validation process completed without any issues, we can then start the actual deployment by running the following command: 1$sddcDeployment = Start-CloudBuilderSDDC -json \u0026#34;E:\\MyLab\\sfo\\sfo-managementDomain.json\u0026#34; Using the Start-CloudBuilderSDDC cmdlet, we trigger the deployment process and again capture the output of the command into a variable which is used in the next step.\nPoll the status of the deployment task, by running the following command: 1Do { $status = Get-CloudBuilderSDDC -id $sddcDeployment.id} While ($status.status -eq \u0026#34;IN_PROGRESS\u0026#34;) Like before we are going to poll the status of the deployment, using the unique ID from the Start-CloudBuilderSDDC cmdlet which we retrieve from the variable $sddcDeployment.id and pass this time to the Get-CloudBuilderSDDC cmdlet. Again we are doing a Do / While loop where we are looking for an executionStatus of \u0026quot;IN_PROGRESS\u0026quot;, once the state changes from \u0026quot;IN_PROGRESS\u0026quot; we break from the loop.\nThat completes the process of deploying the Management Domain using VMware Cloud Builder without using the User Interface.\nOther Posts in Series Automating VMware Cloud Foundation with APIs/PowerVCF/PowerShell Automating VCF - Deploy Management Domain Automating VCF - Create Network Pool Automating VCF - Commission Hosts Automating VCF - Deploy Workload Domain Automating VCF - Deploy NSX-T Edge Cluster Automating VCF - Deploy vRealize Suite Lifecycle Manager ","link":"http://jadenetworksolutions.co.uk/archive/2020/powervcf-automation-01/","section":"archive","tags":["API","PowerShell","VCF"],"title":"Automating VCF – Deploy Management Domain"},{"body":" Deploying VMware Cloud Foundation using the Public APIs allows customers to automate tasks, with PowerVCF the capabilities are extended to PowerShell / PowerCLI experts.\nAs part of an internal project I've been working on recently we have been using PowerShell to help automate some of the repetitive steps whilst performing validation and testing of VMware Cloud Foundation and VMware Validated Design. A key part of this has involved using the cmdlets within PowerVCF, but one of the challenges we face is that a lot of the VMware Cloud Foundation APIs require a JSON spec to be passed as part of the API call.\nThis means that for each of our physical test beds we have to maintain separate JSON spec files, and some of the JSON specs additionally require unique IDs that have to be obtained from the fresh deployment of VMware Cloud Foundation.\nAnother disadvantage is that each time we deploy to save on the effort around maintaining these JSON specs the team rely on using the same naming conventions over and over.\nThis got me thinking that there must be a better way where we could maintain a single source of input dedicated to each physical environment and remove those silly keying mistakes at the same time.\nWith VMware Cloud Foundation v4.0 / VMware Validated Design v6.0 we introduced a new approach around the Planning and Preparation content where we replaced static web content with an Excel Workbook known as the Planning and Preparation Workbook, the idea behind the Workbook is that it can now be used as a tool for capturing all the input data needed to be successful when deploying either just VMware Cloud Foundation or extending it further with the VMware Validated Design capabilities. For a more detailed explanation check out my friend and colleague Ken Gould's blog on the topic VMware Validated Design 6.0 / VMware Cloud Foundation 4.0 Planning \u0026amp; Preparation.\nAs this pretty much contains everything we need except for passwords I decided to look at ways of generating the JSON specs directly from it.\nIn the interests of sharing with the wider community, I thought I would write a series of blog posts on the topic and share my code snippets in the hope it may help or inspire others. I hope you find the information useful.\nHere are a list of the topics covered:\nAutomating VCF - Deploy Management Domain Automating VCF - Create Network Pool Automating VCF - Commission Hosts Automating VCF - Deploy Workload Domain Automating VCF - Deploy NSX-T Edge Cluster Automating VCF - Deploy vRealize Suite Lifecycle Manager ","link":"http://jadenetworksolutions.co.uk/archive/2020/powervcf-automation/","section":"archive","tags":["API","PowerShell","VCF"],"title":"Automating VMware Cloud Foundation with APIs/PowerVCF/PowerShell"},{"body":" In this part three of this blog series, I'm going to take a look at how you perform the restore of SDDC Manager using PowerVCF v2.0.\nPrerequisites\nIn order to perform the restore process you will need the following information:\nBackup file name and location of the backup file.Encryption passphrase used to encrypt the backup file (this is the password you set when configuring the external backup target). Performing a Restore of SDDC Manager Procedure\n1. First power off the original SDDC Manager virtual appliance and rename the virtual machine in vCenter Server to something like sfo-vcf01-original.\n2. In order to restore SDDC Manager you have to deploy a clean OVA, see 2.14.5. Initiate Restore of SDDC Manager for details on how to obtain the correct OVA file. Then deploy a new SDDC Manager virtual appliance to the vCenter Server. I'm using the OVF Tool for speed, here is the syntax, copy and paste into a command window:\n\"C:\\Program Files\\VMware\\VMware OVF Tool\\ovftool.exe\" --noSSLVerify --skipManifestCheck --powerOn --diskMode=thin --acceptAllEulas --allowExtraConfig --ipProtocol=IPv4 --ipAllocationPolicy=fixedPolicy --prop:ROOT_PASSWORD=\"VMw@re1!\" --prop:VCF_PASSWORD=\"VMw@re1!\" --prop:BASIC_AUTH_PASSWORD=\"VMw@re1!\" --prop:BACKUP_PASSWORD=\"VMw@re1!\" --prop:vami.hostname=\"sfo-vcf01.sfo.rainpole.io\" --prop:guestinfo.ntp=\"ntp.sfo.rainpole.io\" --prop:vami.gateway.SDDC-Manager=\"172.28.211.1\" --prop:vami.domain.SDDC-Manager=\"sfo.rainpole.io\" --prop:vami.searchpath.SDDC-Manager=\"sfo.rainpole.io,rainpole.io\" --prop:vami.DNS.SDDC-Manager=\"172.28.211.4,172.28.211.5\" --prop:vami.ip0.SDDC-Manager=\"172.28.211.59\" --prop:vami.netmask0.SDDC-Manager=\"255.255.255.0\" --datastore=\"sfo-m01-cl01-ds-vsan01\" --name=\"sfo-vcf01\" --network=\"sfo-m01-cl01-vds01-pg-mgmt\" --X:injectOvfEnv --X:waitForIp E:\\VCF-SDDC-Manager-Appliance-4.0.0.0-15956695_OVF10.ova \"vi://administrator@vsphere.local:VMw@re1!@sfo-m01-vc01.sfo.rainpole.io/sfo-m01-dc01/host/sfo-m01-cl01//Resources/sfo-m01-cl01-rp-sddc-mgmt\" 3. Verify that the new SDDC Manager appliance has been deployed correctly, ssh in to the VM as the vcf user.\n4. Take a snapshot of the new SDDC Manager virtual appliance.\n5. Transfer into the new SDDC Manager the encrypted backup file to the /tmp directory. Because I'm using VMware Cloud Builder as my external backup target I can transfer directly into the new SDDC Manager virtual appliance. Enter the following command:\nscp svc-vcf-bck@172.28.211.60:/tmp/backups/sddc-manager-backup/vcf-backup-sfo-vcf01-sfo-rainpole-io-2020-04-22-15-51-39.tar.gz /tmp 6. Open a PowerShell console and connect to SDDC Manager using the PowerVCF cmdlet Connect-VCFManager. Enter the following command:\nConnect-VCFManager sfo-vcf01.sfo.rainpole.io admin VMw@re1! -basicAuth 7. Trigger a restore using the PowerVCF cmdlet Start-VCFRestore. Enter the following command:\nStart-VCFRestore -backupFile \"/tmp/vcf-backup-sfo-vcf01-sfo-rainpole-io-2020-04-22-15-51-39.tar.gz\" -passphrase \"VMw@re1!VMw@re1!\" 8. Check the status of the task by using the PowerVCF cmdlet Get-VCFRestoreTask. Enter the following command:\nGet-VCFRestoreTask -id 88e05f65-c388-41a2-8b14-4b3a9d6f22d4 9. The restore process takes a little bit if time but repeat step 3 until you have a status of Successful.\nThere you have it that completes the steps for triggering a restore of SDDC Man\n","link":"http://jadenetworksolutions.co.uk/archive/2020/powervcf-backup-restore-03/","section":"archive","tags":["API","PowerShell","VCF","Backup","Restore"],"title":"PowerVCF v2.0 - Backup and Restore of SDDC Manager - Restore (Part 3)"},{"body":"","link":"http://jadenetworksolutions.co.uk/tags/restore/","section":"tags","tags":null,"title":"Restore"},{"body":" In part two of this blog series, I'm going to take a look at how you perform the backup of SDDC Manager using PowerVCF v2.0.\nPerforming a Backup of SDDC Manager Procedure\n1. Open a PowerShell console and connect to SDDC Manager using the PowerVCF cmdlet Connect-VCFManager. Enter the following command:\nConnect-VCFManager sfo-vcf01.sfo.rainpole.io administrator@vsphere.local VMw@re1! 2. Trigger a backup using the PowerVCF cmdlet Start-VCFBackup. Enter the following command:\nStart-VCFBackup 3. Check the status of the task by using the PowerVCF cmdlet Get-VCFTask. Enter the following command:\nGet-VCFTask -id 5b396a6d-27c4-45d8-b0e5-a2b03b47f145 4. Locate the backup file from the external backup server. This will be located in the /tmp/backups/sddc-manager-backup folder.\nThere you have it that completes the steps for triggering a backup of SDDC Manager with PowerVCF 2.0 using an external backup target.\n","link":"http://jadenetworksolutions.co.uk/archive/2020/powervcf-backup-restore-02/","section":"archive","tags":["API","PowerShell","VCF","Backup","Restore"],"title":"PowerVCF v2.0 - Backup and Restore of SDDC Manager - Backup (Part 2)"},{"body":" In this blog series, I'm going to take a look at how you perform the configuration, backup and restore of SDDC Manager using PowerVCF v2.0. Why use PowerVCF you might be asking well the simple answer is that in order to perform the backup and restore procedures of SDDC Manager you have to use the Public APIs for VMware Cloud Foundation. From a VMware Cloud Foundation documentation perspective the relevant information can be found at the following locations:\nOperations and Administration Guide - Backing Up and Restoring SDDC Manager and NSX ManagerAPI Documentation - Backup and Restore Configuring a Backup Target for SDDC Manager Part one of this blog series will take a look at configuring SDDC Manager with an external backup target.\nBy default following a successful deployment of VMware Cloud Foundation, SDDC Manager is configured to backup to itself, and when you log into the administration user interface a banner message is displayed stating that you should reconfigure. For the purpose of testing I use my VMware Cloud Builder appliance as this is enabled with an SFTP service but before performing the reconfiguration of SDDC Manager I need to perform some additional steps on the VMware Cloud Builder appliance itself.\nProcedure\n1. Connect to the VMware Cloud Builder appliance using and SSH client such as Putty and log in using the admin user.\n2. Create a new local service account called svc-vcf-bck. Enter the following command:\nsudo useradd -m -p $(openssl passwd -1 'VMw@re1!') svc-vcf-bck NOTE: There is a requirement in VMware Cloud Foundation 4.0 where you must have a home directory, this is becuase when the backup API is run it checks for the existence, this is something that will be addressed in the next release. 3. Sudo as the new service account and create the target folder for backups. Enter the following commands:\nsudo su - svc-vcf-bck\nmkdir /tmp/backups 4. Create the JSON spec for configuring an external backup target in SDDC Manager. To obtain the sshFingerprint run the following command on the VMware Cloud Builder Appliance and copy / paste into the JSON spec:\nssh-keygen -lf \u0026lt;(ssh-keyscan -t ssh-rsa -p 22 172.28.211.60 2\u0026gt;/dev/null) { \"backupLocations\": [ { \"directoryPath\": \"/tmp/backups/\", \"password\": \"VMw@re1!\", \"port\": 22, \"protocol\": \"SFTP\", \"server\": \"172.28.211.60\", \"sshFingerprint\": \"SHA256:sptZq0mdjboC9AT8hZ8sz16c1JWIQxaFof/T407RnQg\", \"username\": \"svc-vcf-bck\" } ], \"encryption\": { \"passphrase\": \"VMw@re1!VMw@re1!\" } } 5. Open a PowerShell console and connect to SDDC Manager using the PowerVCF cmdlet Connect-VCFManager. Enter the following command:\nConnect-VCFManager sfo-vcf01.sfo.rainpole.io administrator@vsphere.local VMw@re1! 6. Configure SDDC Manager with the external backup target using the PowerVCF cmdlet Set-VCFBackupConfiguration. Enter the following command:\nSet-VCFBackupConfiguration -json E:\\MyLab\\backupConfiguration.json 7. Check the status of the task by using the PowerVCF cmdlet Get-VCFTask. Enter the following command:\nGet-VCFTask -id 60f7fc20-ab69-4e51-8730-57258f9af7d7 8. Check the configuration using the PowerVCF cmdlet Get-VCFBackupConfiguration. Enter the following command:\nGet-VCFBackupConfiguration There you have it that completes the steps for configuring SDDC Manager to use an external backup source. In my next post I will walk through the process of performing the backup.\n","link":"http://jadenetworksolutions.co.uk/archive/2020/powervcf-backup-restore-01/","section":"archive","tags":["API","PowerShell","VCF","Backup","Restore"],"title":"PowerVCF v2.0 - Backup and Restore of SDDC Manager - Configuration (Part 1)"},{"body":" For those that follow my blog posts you will be aware that I’m involved with the development of PowerVCF a collection of PowerShell cmdlets created to expose the Public APIs of VMware Cloud Foundation. Whilst working on PowerVCF v2.0 I started to take a look at the Public APIs for VMware Cloud Builder, I’ve been heavily involved with the development team for a number of years now and knew there were both Public and Private APIs but just never had the time to dig deeper. First thing to note is that the Public APIs for VMware Cloud Builder are actually documented within the Public APIs for VMware Cloud Foundation here. From within the documentation refer to the section named 2.3. SDDCs (Management Domain), there is support for the following API calls:\nGET /v1/sddcs - Retrieve all SDDCsPOST /v1/sddcs - Create SDDCGET /v1/sddcs/{id} - Retrieve a SDDCPATCH /v1/sddcs/{id} - Retry failed SDDC creationGET /v1/sddcs/validations - Get all SDDC specification validationsPOST /v1/sddcs/validations - Validate SDDC specification before creationGET /v1/sddcs/validations/{id} - Get SDDC specification validation status by IDDELETE /v1/sddcs/validations/{id} - Cancel SDDC specification validationPATCH /v1/sddcs/validations/{id} - Retry SDDC validation Based on these APIs, I built a number of new PowerVCF cmdlets as follows:\nGet-CloudBuilderSDDCStart-CloudBuilderSDDCRestart-CloudBuilderSDDCGet-CloudBuilderSDDCValidationStart-CloudBuilderSDDCValidationStop-CloudBuilderSDDCValidationRestart-CloudBuilderSDDCValidation Next I needed to work on building a valid JSON spec to be used both during the validation and deployment phases, sounds like a simple task based on the fact that VMware Cloud Builder already takes the Deployment Parameters Workbook and converts it into a JSON file through the utility called JsonGenerator however not quite so. The biggest challenge here is that in VMware Cloud Foundation 4.0 the User Interface still uses the Private APIs which means there are a number of differences between the JSON elements used for the Private API versus the Public API so just taking and reusing the JSON file was not possible. A couple of examples include:\n\"VLANId\" versus \"vlanId\"\"dvsId\" versus \"dvsName\"\"niocSpec\" versus \"niocSpecs\" After walking through and doing a comparison section by section I finally had what I hoped to be a working JSON and was ready to perform end to end testing using the new PowerVCF cmdlets and the JSON spec. For the working JSON sample, see the bottom of this post.\nI will now cover the process of using the new PowerVCF cmdlets to drive the deployment of a VMware Cloud Foundation 4.0 Management Domain.\nAssumption: You have already installed or imported PowerVCF on your system.\nPerforming Validations using PowerVCF v2.0 The following procedure demonstrates the process of using PowerVCF to perform the validation of the JSON spec and target environment using VMware Cloud Builder.\nProcedure\n1. Before performing any operations on VMware Cloud Builder using PowerVCF you must enter the credentials, the PowerVCF cmdlet Connect-CloudBuilder takes these credentials and stores them as a base64 string which is then used for each subsequent cmdlet. Enter the following syntax.\nConnect-CloudBuilder -fqdn sfo-cb01.sfo.rainpole.io -username admin -password VMw@re1! 2. Taking a copy of the sample JSON file from the bottom of this post, copy and paste into an editor (I use Notepad++), make changes as they correspond to your environment and save the file. I'm using sfo-managementDomain.json for the purpose of this blog post and saving it to the root of my E: Drive.\n3. Next we want trigger the validation process, this is achieved using the Start-CloudBuilderSDDCValidation cmdlet and passing it the json file we created in the previous step. Enter the following syntax.\nStart-CloudBuilderSDDCValidation -json E:\\sfo-managementDomain.json Here we can see the output of the Start-CloudBuilderSDDCValidation cmdlet, the task has a unique ID which can be used with the Get-CloudBuilderSDDCValidation cmdlet to get updates on the validation process.\nWe can also log into the VMware Cloud Builder user interface where we also see the validation workflow in progress.\n4. Now using the Get-CloudBuilderSDDCValidation cmdlet and the unique ID shown during the triggering of the validation workflow we can check the status using the following syntax.\nGet-CloudBuilderSDDCValidation -id 9f13aac9-3d9c-43f1-b41a-d152d418b4b6 We can see based on the executionStatus the validation has COMPLETED, we can verify this further through the VMware Cloud Builder user interface.\nWhen looking at status of the validation using the VMware Cloud Builder user interface you will see that there are a number of validations performed, each with their own status. 5. We can view the same level of detail using the PowerVCF cmdlet by simply adding ConvertTo-Json to the command as follows:\nGet-CloudBuilderSDDCValidation -id 9f13aac9-3d9c-43f1-b41a-d152d418b4b6 | ConvertTo-Json Once your audit has finished and has the COMPLETED status we can move on to trigger the actual deployment.\nPerforming Deployment using PowerVCF 2.0 Now we have the json spec and the infrastructure validated we are ready trigger the actual deployment.\nProcedure\n1. Using the PowerVCF cmdlet Connect-CloudBuilder connect to the VMware Cloud Builder appliance using the following syntax.\nConnect-CloudBuilder -fqdn sfo-cb01.sfo.rainpole.io -username admin -password VMw@re1! 2. Using the Start-CloudBuilderSDDC cmdlet and passing it the json file we start the deployment workflow using the following syntax.\nStart-CloudBuilderSDDC -json E:\\sfo-managementDomain.json Here we can see the output of the Start-CloudBuilderSDDC cmdlet, the task has a unique ID which can be used with the Get-CloudBuilderSDDC cmdlet to get updates on the validation process.\nAnd again we can see the status of the deployment by logging into the VMware Cloud Builder user interface.\n3. Now using the Get-CloudBuilderSDDC cmdlet and the unique ID shown during the trigger of the workflow we can check the status using the following syntax.\nGet-CloudBuilderSDDC -id d5b175e1-a966-4845-85c3-43e98e616267 After some time, we can see based on the status the deployment has COMPLETED_WITH_SUCCESS, we can verify this further through the VMware Cloud Builder user interface.\nAnd there you have it, using the new VMware Cloud Builder cmdlets released with PowerVCF 2.0 it's now possible to script the automation of the validation and deployment of a VMware Cloud Foundation 4.0 Management Domain.\nHope you have found this post useful, if you have comments then please feel free to get in touch.\nSample JSON File { \"excludedComponents\": [ \"NSX-V\" ], \"dvSwitchVersion\": \"7.0.0\", \"skipEsxThumbprintValidation\": true, \"managementPoolName\": \"sfo-m01-np01\", \"sddcManagerSpec\": { \"secondUserCredentials\": { \"username\": \"vcf\", \"password\": \"VMw@re1!\" }, \"ipAddress\": \"172.20.11.59\", \"netmask\": \"255.255.255.0\", \"hostname\": \"sfo-vcf01\", \"rootUserCredentials\": { \"username\": \"root\", \"password\": \"VMw@re1!\" }, \"restApiCredentials\": { \"username\": \"admin\", \"password\": \"VMw@re1!\" } }, \"sddcId\": \"sfo-m01\", \"ceipEnabled\": true, \"esxLicense\": \"XXXXX-XXXXX-XXXXX-XXXXX-XXXXX\", \"taskName\": \"workflowconfig/workflowspec-ems.json\", \"ntpServers\": [ \"ntp.sfo.rainpole.io\" ], \"dnsSpec\": { \"subdomain\": \"sfo.rainpole.io\", \"domain\": \"sfo.rainpole.io\", \"nameserver\": \"172.20.11.4\", \"secondaryNameserver\": \"172.20.11.5\" }, \"networkSpecs\": [{ \"subnet\": \"172.20.11.0/24\", \"vlanId\": \"3061\", \"mtu\": \"1500\", \"networkType\": \"MANAGEMENT\", \"gateway\": \"172.20.11.1\", \"portGroupKey\": \"sfo-m01-cl01-vds01-pg-mgmt\", \"association\": \"sfo-m01-dc01\" }, { \"subnet\": \"172.20.13.0/24\", \"includeIpAddressRanges\": [ {\"startIpAddress\": \"172.20.13.101\", \"endIpAddress\": \"172.20.13.104\" } ], \"vlanId\": \"3063\", \"mtu\": \"9000\", \"networkType\": \"VSAN\", \"gateway\": \"172.20.13.253\", \"portGroupKey\": \"sfo-m01-cl01-vds01-pg-vsan\", \"association\": \"sfo-m01-dc01\" }, { \"subnet\": \"172.20.12.0/24\", \"includeIpAddressRanges\": [ {\"startIpAddress\": \"172.20.12.101\", \"endIpAddress\": \"172.20.12.104\" } ], \"vlanId\": \"3062\", \"mtu\": \"9000\", \"networkType\": \"VMOTION\", \"gateway\": \"172.20.12.253\", \"portGroupKey\": \"sfo-m01-cl01-vds01-pg-vmotion\", \"association\": \"sfo-m01-dc01\" }, { \"networkType\": \"UPLINK01\", \"subnet\": \"172.27.24.0/24\", \"gateway\": \"172.27.24.253\", \"vlanId\": \"3284\", \"mtu\": \"9000\", \"portGroupKey\": \"sfo-m01-cl01-vds01-pg-uplink01\", \"association\": \"sfo-m01-dc01\" }, { \"networkType\": \"UPLINK02\", \"subnet\": \"172.27.25.0/24\", \"gateway\": \"172.27.25.253\", \"vlanId\": \"3285\", \"mtu\": \"9000\", \"portGroupKey\": \"sfo-m01-cl01-vds01-pg-uplink02\", \"association\": \"sfo-m01-dc01\" }, { \"networkType\": \"REGION_SPECIFIC\", \"subnet\": \"192.168.31.0/24\", \"gateway\": \"192.168.31.1\", \"mtu\": \"9000\", \"vlanId\": \"0\", \"association\": \"sfo-m01-dc01\" }, { \"networkType\": \"X_REGION\", \"subnet\": \"192.168.11.0/24\", \"gateway\": \"192.168.11.1\", \"mtu\": \"9000\", \"vlanId\": \"0\", \"association\": \"sfo-m01-dc01\" }, { \"networkType\": \"NSXT_EDGE_TEP\", \"subnet\": \"172.20.15.0/24\", \"mtu\": \"9000\", \"gateway\": \"172.20.15.253\", \"vlanId\": \"3065\", \"association\": \"sfo-m01-dc01\" } ], \"nsxtSpec\": { \"nsxtManagerSize\": \"medium\", \"nsxtManagers\": [ { \"hostname\": \"sfo-m01-nsx01a\", \"ip\": \"172.20.11.66\" }, { \"hostname\": \"sfo-m01-nsx01b\", \"ip\": \"172.20.11.67\" }, { \"hostname\": \"sfo-m01-nsx01c\", \"ip\": \"172.20.11.68\" } ], \"rootNsxtManagerPassword\": \"VMw@re1!VMw@re1!\", \"nsxtAdminPassword\": \"VMw@re1!VMw@re1!\", \"nsxtAuditPassword\": \"VMw@re1!VMw@re1!\", \"rootLoginEnabledForNsxtManager\": \"true\", \"sshEnabledForNsxtManager\": \"true\", \"overLayTransportZone\": { \"zoneName\": \"sfo-m01-tz-overlay01\", \"networkName\": \"sfo-m01-cl01-nvds01-pg-edge\" }, \"vlanTransportZone\": { \"zoneName\": \"sfo-m01-tz-vlan01\", \"networkName\": \"netName-vlan\" }, \"vip\": \"172.20.11.65\", \"vipFqdn\": \"sfo-m01-nsx01\", \"nsxtLicense\": \"XXXXX-XXXXX-XXXXX-XXXXX-XXXXX\", \"transportVlanId\": 3064, \"nsxtEdgeSpec\": { \"edgeClusterName\": \"sfo-m01-ec01\", \"edgeRootPassword\": \"VMw@re1!VMw@re1!\", \"edgeAdminPassword\": \"VMw@re1!VMw@re1!\", \"edgeAuditPassword\": \"VMw@re1!VMw@re1!\", \"edgeFormFactor\": \"MEDIUM\", \"tier0ServicesHighAvailability\": \"ACTIVE_ACTIVE\", \"asn\": 65003, \"edgeServicesSpecs\": { \"tier0GatewayName\": \"sfo-m01-ec01-t0-gw01\", \"tier1GatewayName\": \"sfo-m01-ec01-t1-gw01\" }, \"edgeNodeSpecs\": [{ \"edgeNodeName\": \"sfo-m01-en01\", \"edgeNodeHostname\": \"sfo-m01-en01.sfo.rainpole.io\", \"managementCidr\": \"172.20.11.69/24\", \"edgeVtep1Cidr\": \"172.20.15.2/24\", \"edgeVtep2Cidr\": \"172.20.15.3/24\", \"interfaces\": [{ \"name\": \"uplink-edge1-tor1\", \"interfaceCidr\": \"172.27.24.2/24\" }, { \"name\": \"uplink-edge1-tor2\", \"interfaceCidr\": \"172.27.25.3/24\" } ] }, { \"edgeNodeName\": \"sfo-m01-en02\", \"edgeNodeHostname\": \"sfo-m01-en02.sfo.rainpole.io\", \"managementCidr\": \"172.20.11.70/24\", \"edgeVtep1Cidr\": \"172.20.15.4/24\", \"edgeVtep2Cidr\": \"172.20.15.5/24\", \"interfaces\": [{ \"name\": \"uplink-edge2-tor1\", \"interfaceCidr\": \"172.27.24.3/24\" }, { \"name\": \"uplink-edge2-tor2\", \"interfaceCidr\": \"172.27.25.2/24\" } ] } ], \"bgpNeighbours\": [{ \"neighbourIp\": \"172.27.24.1\", \"autonomousSystem\": 65001, \"password\": \"VMw@re1!\" }, { \"neighbourIp\": \"172.27.25.1\", \"autonomousSystem\": 65001, \"password\": \"VMw@re1!\" } ] }, \"logicalSegments\": [{ \"name\": \"sfo-m01-seg01\", \"networkType\": \"REGION_SPECIFIC\" }, { \"name\": \"xreg-m01-seg01\", \"networkType\": \"X_REGION\" } ] }, \"vsanSpec\": { \"vsanName\": \"vsan-1\", \"licenseFile\": \"XXXXX-XXXXX-XXXXX-XXXXX-XXXXX\", \"vsanDedup\": \"false\", \"datastoreName\": \"sfo-m01-cl01-ds-vsan01\" }, \"dvsSpecs\": [{ \"mtu\": 9000, \"niocSpecs\": [{ \"trafficType\": \"VSAN\", \"value\": \"HIGH\" }, { \"trafficType\": \"VMOTION\", \"value\": \"LOW\" }, { \"trafficType\": \"VDP\", \"value\": \"LOW\" }, { \"trafficType\": \"VIRTUALMACHINE\", \"value\": \"HIGH\" }, { \"trafficType\": \"MANAGEMENT\", \"value\": \"NORMAL\" }, { \"trafficType\": \"NFS\", \"value\": \"LOW\" }, { \"trafficType\": \"HBR\", \"value\": \"LOW\" }, { \"trafficType\": \"FAULTTOLERANCE\", \"value\": \"LOW\" }, { \"trafficType\": \"ISCSI\", \"value\": \"LOW\" } ], \"dvsName\": \"sfo-m01-cl01-vds01\", \"vmnics\": [ \"vmnic0\", \"vmnic1\" ], \"networks\": [ \"MANAGEMENT\", \"VSAN\", \"VMOTION\", \"UPLINK01\", \"UPLINK02\", \"NSXT_EDGE_TEP\" ] }], \"clusterSpec\": { \"vmFolders\": { \"MANAGEMENT\": \"sfo-m01-fd-mgmt\", \"NETWORKING\": \"sfo-m01-fd-nsx\", \"EDGENODES\": \"sfo-m01-fd-edge\" }, \"clusterName\": \"sfo-m01-cl01\", \"clusterEvcMode\": \"\", \"resourcePoolSpecs\": [{ \"cpuSharesLevel\": \"high\", \"cpuSharesValue\": 0, \"name\": \"sfo-m01-cl01-rp-sddc-mgmt\", \"memorySharesValue\": 0, \"cpuReservationPercentage\": 0, \"memoryLimit\": -1, \"memoryReservationPercentage\": 0, \"cpuReservationExpandable\": true, \"memoryReservationExpandable\": true, \"memorySharesLevel\": \"normal\", \"cpuLimit\": -1, \"type\": \"management\" }, { \"cpuSharesLevel\": \"high\", \"cpuSharesValue\": 0, \"name\": \"sfo-m01-cl01-rp-sddc-edge\", \"memorySharesValue\": 0, \"cpuReservationPercentage\": 0, \"memoryLimit\": -1, \"memoryReservationPercentage\": 0, \"cpuReservationExpandable\": true, \"memoryReservationExpandable\": true, \"memorySharesLevel\": \"normal\", \"cpuLimit\": -1, \"type\": \"network\" }, { \"cpuSharesLevel\": \"normal\", \"cpuSharesValue\": 0, \"name\": \"sfo-m01-cl01-rp-user-edge\", \"memorySharesValue\": 0, \"cpuReservationPercentage\": 0, \"memoryLimit\": -1, \"memoryReservationPercentage\": 0, \"cpuReservationExpandable\": true, \"memoryReservationExpandable\": true, \"memorySharesLevel\": \"normal\", \"cpuLimit\": -1, \"type\": \"compute\" }, { \"name\": \"sfo-m01-cl01-rp-user-vm\", \"type\": \"compute\", \"cpuReservationPercentage\": 0, \"cpuLimit\": -1, \"cpuReservationExpandable\": true, \"cpuSharesLevel\": \"normal\", \"cpuSharesValue\": 0, \"memoryReservationPercentage\": 0, \"memoryLimit\": -1, \"memoryReservationExpandable\": true, \"memorySharesLevel\": \"normal\", \"memorySharesValue\": 0 } ] }, \"pscSpecs\": [{ \"pscId\": \"psc-1\", \"vcenterId\": \"vcenter-1\", \"pscSsoSpec\": { \"ssoSiteName\": \"sfo-m01\", \"ssoDomainPassword\": \"VMw@re1!\", \"ssoDomain\": \"vsphere.local\", \"isJoinSsoDomain\": false }, \"adminUserSsoPassword\": \"VMw@re1!\" }], \"vcenterSpec\": { \"vcenterIp\": \"172.20.11.62\", \"vcenterHostname\": \"sfo-m01-vc01\", \"vcenterId\": \"vcenter-1\", \"licenseFile\": \"XXXXX-XXXXX-XXXXX-XXXXX-XXXXX\", \"rootVcenterPassword\": \"VMw@re1!\", \"vmSize\": \"small\" }, \"hostSpecs\": [{ \"credentials\": { \"username\": \"root\", \"password\": \"VMw@re1!\" }, \"ipAddressPrivate\": { \"subnet\": \"255.255.255.0\", \"cidr\": \"172.20.11.0/24\", \"ipAddress\": \"172.20.11.101\", \"gateway\": \"172.20.11.1\" }, \"hostname\": \"sfo01-m01-esx01\", \"vSwitch\": \"vSwitch0\", \"serverId\": \"host-0\", \"association\": \"sfo-m01-dc01\" }, { \"credentials\": { \"username\": \"root\", \"password\": \"VMw@re1!\" }, \"ipAddressPrivate\": { \"subnet\": \"255.255.255.0\", \"cidr\": \"172.20.11.0/24\", \"ipAddress\": \"172.20.11.102\", \"gateway\": \"172.20.11.1\" }, \"hostname\": \"sfo01-m01-esx02\", \"vSwitch\": \"vSwitch0\", \"serverId\": \"host-1\", \"association\": \"sfo-m01-dc01\" }, { \"credentials\": { \"username\": \"root\", \"password\": \"VMw@re1!\" }, \"ipAddressPrivate\": { \"subnet\": \"255.255.255.0\", \"cidr\": \"172.20.11.0/24\", \"ipAddress\": \"172.20.11.103\", \"gateway\": \"172.20.11.1\" }, \"hostname\": \"sfo01-m01-esx03\", \"vSwitch\": \"vSwitch0\", \"serverId\": \"host-2\", \"association\": \"sfo-m01-dc01\" }, { \"credentials\": { \"username\": \"root\", \"password\": \"VMw@re1!\" }, \"ipAddressPrivate\": { \"subnet\": \"255.255.255.0\", \"cidr\": \"172.20.11.0/24\", \"ipAddress\": \"172.20.11.104\", \"gateway\": \"172.20.11.1\" }, \"hostname\": \"sfo01-m01-esx04\", \"vSwitch\": \"vSwitch0\", \"serverId\": \"host-3\", \"association\": \"sfo-m01-dc01\" } ] } Useful Links If you would like to learn more about VMware Cloud Foundation or PowerVCF, check out these links:\nVMware Cloud Foundation DocumentationVMware Cloud Foundation General FAQVMware Cloud Foundation 4.0 Release NotesPowerVCF DocumentationPowerVCF v2.0 PowerShell Library Download ","link":"http://jadenetworksolutions.co.uk/archive/2020/powervcf-cb-apis/","section":"archive","tags":["API","PowerShell","VCF"],"title":"PowerVCF v2.0 - Using VMware Cloud Builder with Public APIs"},{"body":" I'm pleased to announce the general availability of PowerVCF v2.0.0 for download from the PowerShell Library. PowerVCF is a open source project and the team works on adding support when time permits.\nDownload It Here: PowerVCF PowerShell Library Download\nWhat's New in PowerVCF v2.0\u0026lt; Along with a number of new or modified cmdlets the following enhancements have been made:\nGrouped cmdlets based on order of API documentationEnhancements to reuse duplicate codeUpdated for consistency in the use of codeSupport for the new token-based authentication model The following table provides a detailed breakdown of all the cmdlet changes for this release.\nCategorycmdlet NameDescriptionCommentBackup and RestoreStart-VCFRestoreStarts the restore process of SDDC ManagerNEWBackup and RestoreGet-VCFRestoreTasksGets the status of the restore processNEWConnectivityConnect-VCFManagerCreate authentication header for SDDC Manager applianceUPDATED - Support the new token / bearer authentication model and basicAuth switch for restore processConnectivityConnect-CloudBuilderCreate authentication header for Cloud Builder applianceNEWCertificatesGet-VCFCertificateAuthorityGet Certificate Authority informationUPDATED - Added support for getting the details by idCertificatesRemove-VCFCertificateAuthorityDeletes Certificate Authority configurationNEWCertificatesGet-VCFCertificateView certificate of all the resources in a domainUPDATED - Added support for get certificate details by resourceCredentialsGet-VCFCredentialGet the credentialsUPDATED- Added support for getting the details by idCredentialsStop-VCFCredentialTaskCancels a failed update or rotate passwords taskRENAMED - From Cancel-VCFCredentialTaskCredentialsRestart-VCFCredentialTaskRetry a failed rotate/update passwords taskRENAMED - From Retry-VCFCredentialTaskHostsCommission-VCFHostCommissions a list of hostsUPDATED - Added support for validating the input spec for host operations (-validate switch)NSX-T Edge ClustersGet-VCFEdgeClusterGet an Edge ClusterNEWNSX-T Edge ClustersNew-VCFEdgeCluster creates an NSX-T edge clusterNEWPersonalitiesGet-VCFPersonalityGet the vSphere Lifecycle Manager PersonalitiesNEWSDDC (Cloud Builder)Get-CloudBuilderSDDCRetrieve all SDDCsNEWSDDC (Cloud Builder)Start-CloudBuilderSDDCCreate SDDCNEWSDDC (Cloud Builder)Restart-CloudBuilderSDDCRetry failed SDDC creationNEWSDDC (Cloud Builder)Get-CloudBuilderSDDCValidationGet all SDDC specification validationsNEWSDDC (Cloud Builder)Start-CloudBuilderSDDCValidationValidate SDDC specification before creationNEWSDDC (Cloud Builder)Stop-CloudBuilderSDDCValidationCancel SDDC specification validationNEWSDDC (Cloud Builder)Restart-CloudBuilderSDDCValidationRetry SDDC validationNEWSystem PrechecksStart-VCFSystemPrecheckPerform System PrecheckRENAMED - From Start-PreCheckVCFSystemSystem PrechecksGet-VCFSystemPrecheckTaskGet System Precheck TaskRENAMED - From Get-PreCheckVCFSystemTaskTasksRestart-VCFTaskRetry a previously failed taskRENAMED - From Retry-VCFTaskUsersGet-VCFRoleGet all rolesNEWUsersGet-VCFUserGet all UsersNEWUsersNew-VCFUserAdds a new userNEWUsersNew-VCFServiceUserAdds a new service userNEWUsersDelete-VCFUserDeletes a userNEWvRealize Suite Lifecycle ManagerReset-VCFvRSLCMRedeploy vRealize Suite Lifecycle ManagerNEWvRealize Suite Lifecycle ManagerNew-VCFvRSLCMValidate the input specification for vRealize Suite Lifecycle Manager deploymentUPDATED - Added support for validating the json spec (-validate switch). If you would like to learn more about VMware Cloud Foundation or PowerVCF, check out these links:\nVMware Cloud Foundation DocumentationVMware Cloud Foundation General FAQVMware Cloud Foundation 4.0 Release NotesPowerVCF DocumentationPowerVCF v2.0 PowerShell Library Download ","link":"http://jadenetworksolutions.co.uk/post/powervcf/powervcf-ga-200./","section":"post","tags":["API","PowerShell","VCF"],"title":"PowerVCF v2.0.0 - General Availability"},{"body":"","link":"http://jadenetworksolutions.co.uk/categories/vmware-validated-design/","section":"categories","tags":null,"title":"VMware Validated Design"},{"body":" On April 14, VMware made VMware Validated Design 6.0 Generally Available (GA), but how does this latest release differ to those before it?\nVMware Validated Design is a family of solutions for data center designs that span compute, storage, networking, and management, serving as a blueprint for your Software-Defined Data Center (SDDC) implementation\nI will provide a high-level run down of what’s new across the design as follows:\nGreenfield Deployments Only Bill of Materials Planning and Preparation Workbook vSphere 7.0 Design vSAN 7.0 Design NSX-T Data Center 3.0 Design vRealize Suite 8.1 Workspace ONE Access 3.3 VMware Cloud Foundation 4.0 Anything Else to be Aware of? Greenfield Deployments Only The first thing to note is that this release is only for greenfield deployments and does not include an upgrade process from previous versions of the VMware Validated Design at this current time. There are a number of reasons for this but read on to find out more.\nBill of Materials One of the most significant changes relates to the Bill of Materials (BoM) and this centers around, vSphere 7.0, NSX-T Data Center 3.0, vRealize Suite 8.1, Workspace ONE Access 3.3, and the most significant change the inclusion of VMware Cloud Foundation 4.0 at the heart of the solution.\nPlanning and Preparation Workbook Starting with this release the static Planning and Preparation document has been ported over into an Excel Workbook, this has been done to enable customers to use it as more of a tool allowing customer inputs along side the VMware Validated Design examples to aid with the deployment process. The workbook is also shared between VMware Cloud Foundation and VMware Validated Design.\nvSphere 7.0 Design From an vSphere 7.0 architecture perspective the biggest change is the deprecation of external Platform Services Controllers in vCenter Server and as a result all vCenter Servers now use an embedded Platform Services Controller which also means there is no longer a requirement for an NSX based Load Balancer.\nvSAN 7.0 Design The design changes for VSAN include All-Flash by default and a minimum of two disk groups in line with VMware best practices.\nNSX-T Data Center 3.0 Design NSX-V has been completely removed, both the Management Domain and Workload Domains now use NSX-T Data Center for all Software-Defined Networking capabilities.\nvRealize Suite 8.1 The design to the vRealize Suite includes vRealize Suite Lifecycle Manager, vRealize Operations Manager, vRealize Log Insight, and vRealize Automation.\nThe biggest change here is in relation to vRealize Automation where the Windows based DEMs, Orchestrators, and Agents are gone so is the requirement for a Microsoft SQL Server.\nThere are minimal changes for vRealize Operations Manager and vRealize Log Insight but a point of note is that vRealize Business for Cloud is no longer a part of the solution.\nWorkspace ONE Access 3.3 New to the VMware Validated Design we have included Workspace ONE Access to provide a single entry point for authentication from an external provider such as Active Directory. Workspace ONE Access is also used to deliver Role Based Access Control (RBAC) for NSX-T Data Center specifically as without there is no way to provide such controls.\nVMware Cloud Foundation 4.0 Whilst I’ve not mentioned anything about VMware Cloud Foundation 4.0 until now this is probably the most significant change to the VMware Validation Design. From this release forward the design will include VMware Cloud Foundation at the heart, which means that all architecture design elements between what VMware Cloud Foundation implements are 100% aligned with the VMware Validated Design. In a nutshell this means where VMware Cloud Foundation has an automated workflow the end state maps directly to the architecture design documented in the VMware Validated Design Architecture and Design documentation.\nMore importantly where VMware Cloud Foundation has no automated workflow then the VMware Validated Design will contain complimentary architecture design and deployment guidance covering the gaps\nAnything Else to be Aware of? Multi-Region - Unfortunately due to constraints in underlying products this release of the VMware Validated Design is only applicable for a single region, the plan is to add multi region support in a future release once support is available.\nModular Documentation Structure - The Architecture and Design, and Deployment Guides are broken up into modular components covering Management Domain, Workload Domain and Cloud Operations and Automation Solution which should make it easier to consume.\nUseful Links VMware Validated Design Documentation VMware Validated Design 6.0 Release Notes Planning and Preparation Workbook ","link":"http://jadenetworksolutions.co.uk/archive/2020/vvd-whats-new-600/","section":"archive","tags":["VVD"],"title":"VMware Validated Design 6.0 - What’s New"},{"body":"","link":"http://jadenetworksolutions.co.uk/tags/vvd/","section":"tags","tags":null,"title":"VVD"},{"body":" If you follow my posts you will know that in January I posted about the release of PowerVCF which is a PowerShell based CLI that exposes the public APIs of VMware Cloud Foundation to be easily consumed by VI Admins (see Introducing PowerVCF – Power to VI Admins).\nAs mentioned before PowerVCF is a open source project and the team has been working hard in their spare time to continue to evolve the cmdlets it offers. I'm pleased to announce that as a result of all this hard work we have made v1.2.0 available on the PowerShell Library for download.\nDownload It Here: PowerVCF PowerShell Library Download\nWhat's New in PowerVCF v1.2.0 The latest release introduces a number of new cmdlets:\nCategorycmdlet NameDescriptionBackup and RestoreSet-VCFBackupConfigurationConfigure backup settings for NSX and SDDC managerCredentialsRetry-VCFCredentialTaskConnects to the specified SDDC Manager and retry a failed rotate/update passwords taskCredentialsGet-VCFCredentialTaskConnects to the specified SDDC Manager and retrieves a list of credential tasks in reverse chronological orderFederationSet-VCFFederationBootstrap a VMware Cloud Foundation to form a federationSystem PrechecksStart-PreCheckVCFSystemPerforms system level health checksSystem PrechecksGet-PreCheckVCFSystemTaskPerforms retrieval of a system precheck task that can be polled and monitoredAVNGet-VCFApplicationVirtualNetworkRetrieves all Application Virtual NetworksvRSLCMNew-VCFvRSLCMDeploy vRealize Suite Lifecycle ManagervRSLCMRemove-VCFvRSLCMRemove a failed vRealize Suite Lifecycle Manager deployment VMware Cloud Foundation Documentation VMware Cloud Foundation General FAQ VMware Cloud Foundation 3.9 Release Notes VMware Cloud Foundation 3.9.1 Release Notes PowerVCF Documentation PowerVCF PowerShell Library Download ","link":"http://jadenetworksolutions.co.uk/post/powervcf/powervcf-ga-120/","section":"post","tags":["API","PowerShell","VCF"],"title":"PowerVCF v1.2.0 - General Availability"},{"body":"Whilst working with VMware Cloud Foundation recently I wanted to implement an additional level of security around the process of certificate management. For those that don't know in the current release in order to integrate SDDC Manager with your Microsoft Certificate Authority you have to enable basic authentication (see PowerVCF – Configure the Microsoft Certificate Authority for VMware Cloud Foundation Integration (Part 1) on reviewing the official documentation I found nothing to explain the minimum requirements as is it related to least privilege access so I set about trying to figure it out.\nWhat I found is that it is indeed possible but it has to be done in two specific locations as follows:\nConfigure Microsoft Certificate Authority Server Configure Microsoft Certificate Authority Template Let's now take a look at what you need to do. In this example I'm using a dedicated service account called svc-mgr-ca which is just a Domain User.\nConfigure Microsoft Certificate Authority Server Log in to the Microsoft Certificate Authority server by using a Remote Desktop Protocol (RDP) client.Configure least privilege access for svc-mgr-ca on the Microsoft Certificate Authority.Click Start \u0026gt; Run, enter certsrv.msc, and click OK.Right-click the certificate authority and click Properties.Click the Security tab, and click Add.Enter the svc-mgr-ca service account and click OK.In the Permissions for svc-mgr-ca section configure the following permissions and click OK. Configure Microsoft Certificate Authority Template Configure least privilege access for svc-mgr-ca on the Microsoft Certificate Authority Template.Click Start \u0026gt; Run, enter certtmpl.msc, and click OK.Right-click the VMware template and click Properties.Click the Security tab, and click Add.Enter the svc-mgr-ca service account and click OK.In the Permissions for svc-mgr-ca section configure the following permissions and click OK. Now you should be able to configure SDDC Manager to use the svc-mgr-ca service account and perform all certificate operations.\nUseful Links If you would like to learn more about VMware Cloud Foundation or PowerVCF, check out these links:\nVMware Cloud Foundation Documentation VMware Cloud Foundation General FAQ VMware Cloud Foundation 3.9 Release Notes VMware Cloud Foundation 3.9.1 Release Notes PowerVCF Documentation PowerVCF PowerShell Library Download ","link":"http://jadenetworksolutions.co.uk/archive/2020/vcf-ca-serviceaccount/","section":"archive","tags":["VCF"],"title":"Creating a Service Account for Certificate Management with VMware Cloud Foundation"},{"body":"","link":"http://jadenetworksolutions.co.uk/series/vcf-certificate-management/","section":"series","tags":null,"title":"VCF Certificate Management"},{"body":" This is the fifth and final blog in this series that discusses the process of Certificate Management with VMware Cloud Foundation. The series looks at the end to end process that you follow to take a freshly installed VMware Cloud Foundation platform (Management Domain) and replace the components with signed certificates using a Microsoft Certificate Authority.\nIn this post we will look at the process of installing the signed certificates using SDDC Manager.\nInstall Signed Certificates using the User Interface The following procedure demonstrates the process through the SDDC Manager User Interface.\nProcedure\nLog in to SDDC Manager using a web browser.Open a Web browser and go to\u0026nbsp;https://lax01mgr01.lax.rainpole.local.Log in using the administrator@vsphere.local user accountNavigate to Inventory \u0026gt; Workload Domains.In the Workload Domains window, under Virtual Infrastructure VI select View Details. In the Virtual Infrastructure (VI) window, select MGMT from the Domain column. Select the Security tab. Select the checkbox in the table header to select all resource types and click Install Certificates. NOTE: If you have not completed the Generate CSR and Generate Signed Certificates steps then refer to Parts 3 and Part 4 of this series.\nOnce complete the User Interface is updated with a status message of Certificate Installation is successful along with the message Added root certificate chain to the SDDC Manager keystore, you need to restart the SDDC Manager services manually (refer documentation).\nConnect to SDDC Manager lax01mgr01.lax.rainpole.local using an SSH client such as Putty.Log in using the vcf user account.Switch to root using the su command.Restart all the SDDC Manager services. Enter the following command and enter Y. /opt/vmware/vcf/operationsmanager/scripts/cli/sddcmanager_restart_services.sh Wait for the services to restart, then on logging back into the User Interface you will see the warning message has gone and just the Certificate Installation is successful remains.\nInstall Signed Certificates using using PowerVCF The following procedure demonstrates the process through PowerVCF.\nAssumption: You have already installed or imported PowerVCF on your system.\nProcedure\nBefore performing any operations on SDDC Manager using PowerVCF you must enter the credentials, the PowerVCF cmdlet Request-VCFToken takes these credentials and stores them as a base64 string which is then used for each subsequent cmdlet. Enter the following syntax.\nConnect-VCFManager -fqdn lax01mgr01.lax.rainpole.local -username admin -password \"VMw@re1!\" The process of generating the signed certificates via PowerVCF requires passing a JSON spec containing the required input details as follows:\n{ \"operationType\": \"\", \"resources\": [ { \"fqdn\": \"\", \"name\": \"\", \"resourceId\": \"\", \"type\": \"\" }] } The operationType element supports INSTALL. In our example we will now enter INSTALL as follows.\n{ \"operationType\": \"INSTALL\", \"resources\": [ { \"fqdn\": \"\", \"name\": \"\", \"resourceId\": \"\", \"type\": \"\" }] } Next we need to populate the resources part of the JSON spec for each component we want to install the certificate for. To achieve this we need the following four elements of information for each component (just like we did for generating the CSR files and creating the signed certificates):\nfqdn - The fully distinguished domain name as it relates to the information stored in the SDDC Manager inventory.name - The hostname which can be derived from the fqdnresourceId - The unique id assigned to the component and stored in the SDDC Manager inventory.type - The flag to identify what type of component the resources is, SDDC Manager has the following resource types SDDC_MANAGER, PSC, VCENTER, NSX_MANAGER, NSXT_MANAGER, VRA, VRLI, VROPS, VRSLCM, VXRAIL_MANAGER In this example we are going to include VCENTER and SDDC_MANAGER resource types, and using the Get-VCFvCenter and Get-VCFManager cmdlets we can obtain the fqdn and resourceIds details.\nFirst lets look at the Get-VCFvCenter cmdlet. Enter the following syntax:\nGet-VCFvCenter | select id,fqdn Using the select command we can return just the id and fqdn details which is all we need for the JSON spec, using this information we can now build the resource section like this:\n{ \"operationType\": \"INSTALL\", \"resources\": [ { \"fqdn\": \"lax01m01vc01.lax.rainpole.local\", \"name\": \"lax01m01vc01\", \"resourceId\": \"a0652869-dc9b-426a-a9f6-f2866830dceb\", \"type\": \"VCENTER\" } ] } Next we want to do the same for SDDC Manager using the Get-VCFManager cmdlet. Enter the following syntax:\nGet-VCFManager | select id,fqdn Add this additional information to our JSON spec file as follows, and then save the file in this example I call it updateCertificateSpec.json.\n{ \"operationType\": \"INSTALL\", \"resources\": [ { \"fqdn\": \"lax01m01vc01.lax.rainpole.local\", \"name\": \"lax01m01vc01\", \"resourceId\": \"a0652869-dc9b-426a-a9f6-f2866830dceb\", \"type\": \"VCENTER\" },{ \"fqdn\": \"lax01mgr01.lax.rainpole.local\", \"name\": \"lax01mgr01\", \"resourceId\": \"41290562-a6a5-4d3b-8f3c-25b0dd5535f6\", \"type\": \"SDDC_MANAGER\" } ] } Now we have our JSON spec ready we can perform the process of installing the signed certificates using the Set-VCFCertificate cmdlet. When executing this cmdlet we need to provide two inputs, first the name of the Workload Domain, in this example we are using MGMT and the json file we have just created. Enter the following syntax:\nSet-VCFCertificate -domainName MGMT -json E:\\MyLab\\updateCertificateSpec.json After executing this command you are presented with a response which relates to a Task ID and the status of the request, you can check the status of the request using the Get-VCFTask cmdlet. Enter the following syntax:\nGet-VCFTask d6c66f48-e95f-4382-8945-45ca2efc12e0 | select id,name,status Here we can see a task is named Certificate Operation: REPLACE_CERTIFICATE and it has a status of IN_PROGRESS. This step takes some time as it cycles through the components, you can issue the same Get-VCFTask command over and over until the status changes to SUCCESSFUL as follows.\nThe final step in the process is to restart the SDDC Manager services.\nConnect to SDDC Manager lax01mgr01.lax.rainpole.local using an SSH client such as Putty.Log in using the vcf user account.Switch to root using the su command.Restart all the SDDC Manager services. Enter the following command and enter Y. /opt/vmware/vcf/operationsmanager/scripts/cli/sddcmanager_restart_services.sh And there you have it we have successfully replaced the vCenter Server and SDDC Manager systems with CA Signed Certificates using both the User Interface and PowerVCF.\nI hope you have found this series of posts helpful.\nUseful Links If you would like to learn more about VMware Cloud Foundation or PowerVCF, check out these links:\nVMware Cloud Foundation Documentation VMware Cloud Foundation General FAQ VMware Cloud Foundation 3.9 Release Notes VMware Cloud Foundation 3.9.1 Release Notes PowerVCF Documentation PowerVCF PowerShell Library Download ","link":"http://jadenetworksolutions.co.uk/archive/2020/powervcf-certificates-05/","section":"archive","tags":["API","PowerShell","VCF"],"title":"PowerVCF - Install Signed Certificates on Each Component Managed by SDDC Manager (Part 5)"},{"body":" This is the fourth of five blogs in the series that discusses the process of Certificate Management with VMware Cloud Foundation. The series looks at the end to end process that you follow to take a freshly installed VMware Cloud Foundation platform (Management Domain) and replace the components with signed certificates using a Microsoft Certificate Authority.\nIn this post we will look at the process of requesting the signed certificates from the Microsoft Certificate Authority using SDDC Manager either using the SDDC Manager User Interface or via the Public APIs using PowerVCF.\nGenerate Signed Certificates using the User Interface Generate Signed Certificates using using PowerVCF Generate Signed Certificates using the User Interface Procedure\nLog in to SDDC Manager using a web browser.Open a Web browser and go to\u0026nbsp;https://lax01mgr01.lax.rainpole.local.Log in using the administrator@vsphere.local user accountNavigate to Inventory \u0026gt; Workload Domains.In the Workload Domains window, under Virtual Infrastructure VI select View Details. In the Virtual Infrastructure (VI) window, select MGMT from the Domain column. Select the Security tab. Select the checkbox in the table header to select all resource types and click Generate Signed Certificates. NOTE: If you have not completed the Generate CSR step then the Generate Signed Certificates option is not available. See my PowerVCF - Generate Certificate Signing Request (CSR) Files for Each Component Managed by SDDC Manager (Part 3) post.\nIn the Generate Certificates dialog, using the Select Certificate Authority dropdown and select Microsoft, then click Generate Certificates. Once complete the User Interface is updated with a status message of Certificate Generation is successful.\nGenerate Signed Certificates using using PowerVCF Assumption: You have already installed or imported PowerVCF on your system.\nProcedure\nBefore performing any operations on SDDC Manager using PowerVCF you must enter the credentials, the PowerVCF cmdlet Connect-VCFManager takes these credentials and stores them as a base64 string which is then used for each subsequent cmdlet. Enter the following syntax.\nConnect-VCFManager -fqdn lax01mgr01.lax.rainpole.local -username admin -password \"VMw@re1!\" The process of generating the signed certificates via PowerVCF requires passing a JSON spec containing the required input details as follows:\n{ \"caType\": \"\", \"resources\": [ { \"fqdn\": \"\", \"name\": \"\", \"resourceId\": \"\", \"type\": \"\" } ] } The caType element supports only Microsoft or OpenSSL. In this example we will enter Microsoft as follows.\n{ \"caType\": \"Microsoft\", \"resources\": [ { \"fqdn\": \"\", \"name\": \"\", \"resourceId\": \"\", \"type\": \"\" } ] } Next we need to populate the resources part of the JSON spec for each component we want to generate the certificate for. To achieve this we need the following four elements of information for each component (just like we did for generating the CSR files):\nfqdn - The fully distinguished domain name as it relates to the information stored in the SDDC Manager inventory.name - The hostname which can be derived from the fqdnresourceId - The unique id assigned to the component and stored in the SDDC Manager inventory.type - The flag to identify what type of component the resources is, SDDC Manager has the following resource types SDDC_MANAGER, PSC, VCENTER, NSX_MANAGER, NSXT_MANAGER, VRA, VRLI, VROPS, VRSLCM, VXRAIL_MANAGER In this example we are going to include VCENTER and SDDC_MANAGER resource types, and using the Get-VCFvCenter and Get-VCFManager cmdlets we can obtain the fqdn and resourceIds details.\nFirst lets look at the Get-VCFvCenter cmdlet. Enter the following syntax:\nGet-VCFvCenter | select id,fqdn Using the select command we can return just the id and fqdn details which is all we need for the JSON spec, using this information we can now build the resource section like this:\n{ \"caType\": \"Microsoft\", \"resources\": [ { \"fqdn\": \"lax01m01vc01.lax.rainpole.local\", \"name\": \"lax01m01vc01\", \"resourceId\": \"a0652869-dc9b-426a-a9f6-f2866830dceb\", \"type\": \"VCENTER\" } ] } Next we want to do the same for SDDC Manager using the Get-VCFManager cmdlet. Enter the following syntax:\nGet-VCFManager | select id,fqdn Add this additional information to our JSON spec file as follows, and then save the file in this example I call it requestCertificateSpec.json.\n{ \"caType\": \"Microsoft\", \"resources\": [ { \"fqdn\": \"lax01m01vc01.lax.rainpole.local\", \"name\": \"lax01m01vc01\", \"resourceId\": \"a0652869-dc9b-426a-a9f6-f2866830dceb\", \"type\": \"VCENTER\" },{ \"fqdn\": \"lax01mgr01.lax.rainpole.local\", \"name\": \"lax01mgr01\", \"resourceId\": \"41290562-a6a5-4d3b-8f3c-25b0dd5535f6\", \"type\": \"SDDC_MANAGER\" } ] } Now we have our JSON spec ready we can perform the process of creating the signed certificates using the Request-VCFCertificates cmdlet. When executing this cmdlet we need to provide two inputs, first the name of the Workload Domain, in this example we are using MGMT and the json file we have just created. Enter the following syntax:\nRequest-VCFCertificate -domainName MGMT -json E:\\MyLab\\requestCertificateSpec.json After executing this command you are presented with a response which relates to a Task ID and the status of the request, you can check the status of the request using the Get-VCFTask cmdlet. Enter the following synatx:\nGet-VCFTask 4b8f38fc-3c8f-4df5-9228-639a5af5b5d3 | select id,name,status Here we can see a task is named Certificate Operation: GENERATE_CERTIFICATE and it has a status of SUCCESSFUL. So there you have it we have successfully generated the signed certificates using PowerVCF.\nUseful Links If you would like to learn more about VMware Cloud Foundation or PowerVCF, check out these links:\nVMware Cloud Foundation Documentation VMware Cloud Foundation General FAQ VMware Cloud Foundation 3.9 Release Notes VMware Cloud Foundation 3.9.1 Release Notes PowerVCF Documentation PowerVCF PowerShell Library Download ","link":"http://jadenetworksolutions.co.uk/archive/2020/powervcf-certificates-04/","section":"archive","tags":["API","PowerShell","VCF"],"title":"PowerVCF - Request Signed Certificates from Microsoft Certificate Authority (Part 4)"},{"body":" This is the third of five blogs in the series that discusses the process of Certificate Management with VMware Cloud Foundation. The series looks at the end to end process that you follow to take a freshly installed VMware Cloud Foundation platform (Management Domain) and replace the components with signed certificates using a Microsoft Certificate Authority.\nIn this post we will look at the process of generating the Certificate Signing Request (CSR) files using SDDC Manager.\nGenerate Certificate Signing Request (CSR) Files using the User Interface The following procedure demonstrates the process through the SDDC Manager User Interface.\nProcedure\nLog in to SDDC Manager using a web browser.Open a Web browser and go to\u0026nbsp;https://lax01mgr01.lax.rainpole.local.Log in using the administrator@vsphere.local user accountNavigate to Inventory \u0026gt; Workload Domains.In the Workload Domains window, under Virtual Infrastructure VI select View Details. In the Virtual Infrastructure (VI) window, select MGMT from the Domain column. Select the Security tab. Select the checkbox in the table header to select all resource types and click Generate CSR. In the Generate CSR dialog, configure the values as appropriate and click Generate CSR. Once complete the User Interface is updated with a status message.\nGenerate Certificate Signing Request (CSR) Files using using PowerVCF The following procedure demonstrates the process through PowerVCF.\nAssumption: You have already installed or imported PowerVCF on your system.\nProcedure\nBefore performing any operations on SDDC Manager using PowerVCF you must enter the credentials, the PowerVCF cmdlet Connect-VCFManager takes these credentials and stores them as a base64 string which is then used for each subsequent cmdlet. Enter the following syntax.\nConnect-VCFManager -fqdn lax01mgr01.lax.rainpole.local -username admin -password \"VMw@re1!\" The process of generating the Certificate Signing Request (CSR) files via PowerVCF requires passing a JSON spec containing the required input details as follows:\n{ \"csrGenerationSpec\": { \"country\": \"\", \"email\": \"\", \"keyAlgorithm\": \"\", \"keySize\": \"\", \"locality\": \"\", \"organization\": \"\", \"organizationUnit\": \"\", \"state\": \"\" }, \"resources\": [ { \"fqdn\": \"\", \"name\": \"\", \"resourceId\": \"\", \"type\": \"\" } ] } The csrGenerationSpec maps directly to the same details we entered via the User Interface and would look like this:\n{ \"csrGenerationSpec\": { \"country\": \"US\", \"email\": \"\", \"keyAlgorithm\": \"RSA\", \"keySize\": \"2048\", \"locality\": \"Palo Alto\", \"organization\": \"VMware\", \"organizationUnit\": \"HCIBU\", \"state\": \"CA\" } } Next we need to populate the resources part of the JSON spec for each component we want to generate a CSR for. To achieve this we need the following four elements of information for each component:\nfqdn - The fully distinguished domain name as it relates to the information stored in the SDDC Manager inventory.name - The hostname which can be derived from the fqdnresourceId - The unique id assigned to the component and stored in the SDDC Manager inventory.type - The flag to identify what type of component the resources is, SDDC Manager has the following resource types SDDC_MANAGER, PSC, VCENTER, NSX_MANAGER, NSXT_MANAGER, VRA, VRLI, VROPS, VRSLCM, VXRAIL_MANAGER In this example we are going to include VCENTER and SDDC_MANAGER resource types, and using the Get-VCFvCenter and Get-VCFManager cmdlets we can obtain the fqdn and resourceIds details.\nFirst lets look at the Get-VCFvCenter cmdlet. Enter the following syntax:\nGet-VCFvCenter | select id,fqdn Using the select command we can return just the id and fqdn details which is all we need for the JSON spec, using this information we can now build the resource section like this:\n{ \"csrGenerationSpec\": { \"country\": \"US\", \"email\": \"\", \"keyAlgorithm\": \"RSA\", \"keySize\": \"2048\", \"locality\": \"Palo Alto\", \"organization\": \"VMware\", \"organizationUnit\": \"HCIBU\", \"state\": \"CA\" }, \"resources\": [ { \"fqdn\": \"lax01m01vc01.lax.rainpole.local\", \"name\": \"lax01m01vc01\", \"resourceId\": \"a0652869-dc9b-426a-a9f6-f2866830dceb\", \"type\": \"VCENTER\" } ] } Next we want to do the same for SDDC Manager using the Get-VCFManager cmdlet. Enter the following syntax:\nGet-VCFManager | select id,fqdn Add this additional information to our JSON spec file as follows, and then save the file in this example I call it requestCsrSpec.json.\n{ \"csrGenerationSpec\": { \"country\": \"US\", \"email\": \"\", \"keyAlgorithm\": \"RSA\", \"keySize\": \"2048\", \"locality\": \"Palo Alto\", \"organization\": \"VMware\", \"organizationUnit\": \"HCIBU\", \"state\": \"CA\" }, \"resources\": [ { \"fqdn\": \"lax01m01vc01.lax.rainpole.local\", \"name\": \"lax01m01vc01\", \"resourceId\": \"a0652869-dc9b-426a-a9f6-f2866830dceb\", \"type\": \"VCENTER\" },{ \"fqdn\": \"lax01mgr01.lax.rainpole.local\", \"name\": \"lax01mgr01\", \"resourceId\": \"41290562-a6a5-4d3b-8f3c-25b0dd5535f6\", \"type\": \"SDDC_MANAGER\" } ] } Now we have our JSON spec ready we can perform the process of creating the Certificate Signing Request (CSR) files using the Request-VCFCertificateCSRs cmdlet. When executing this cmdlet we need to provide two inputs, first the name of the Workload Domain, in this example we are using MGMT and the json file we have just created. Enter the following syntax:\nRequest-VCFCertificateCSRs -domainName MGMT -json E:\\MyLab\\requestCsrSpec.json After executing this command you are presented with a response which relates to a Task ID and the status, the generation is pretty quick but you can check the status of the task using the Get-VCFTask cmdlet. Enter the following synatx:\nGet-VCFTask e87379ea-ad57-422d-bbfa-bff8c39c810a | select id,name,status Here we can see a task is named Certificate Operation: GENERATE_CSR and it has a status of SUCCESSFUL. So there you have it we have successfully generated the Certificate Signing Request (CSR) files using PowerVCF.\nUseful Links If you would like to learn more about VMware Cloud Foundation or PowerVCF, check out these links:\nVMware Cloud Foundation Documentation VMware Cloud Foundation General FAQ VMware Cloud Foundation 3.9 Release Notes VMware Cloud Foundation 3.9.1 Release Notes PowerVCF Documentation PowerVCF PowerShell Library Download ","link":"http://jadenetworksolutions.co.uk/archive/2020/powervcf-certificates-03/","section":"archive","tags":["API","PowerShell","VCF"],"title":"PowerVCF - Generate Certificate Signing Request (CSR) Files for Each Component Managed by SDDC Manager (Part 3)"},{"body":" This is the second of five blogs in the series that discusses the process of Certificate Management with VMware Cloud Foundation. The series looks at the end to end process that you follow to take a freshly installed VMware Cloud Foundation platform (Management Domain) and replace the components with signed certificates using a Microsoft Certificate Authority.\nIn this post we will look at the process of configuring SDDC Manager integration with the Microsoft Certificate Authority. SDDC Manager must be configured with the Microsoft Certificate Authority so that you can automate the process of generating and replacing signed certificates across the deployed components.\nConnecting SDDC Manager to the Microsoft Certificate Authority using the User Interface The following procedure demonstrates the process through the SDDC Manager User Interface.\nProcedure\nLog in to SDDC Manager using a web browser.Open a Web browser and go to\u0026nbsp;https://lax01mgr01.lax.rainpole.local.Log in using the administrator@vsphere.local user account Navigate to Administration \u0026gt; Security \u0026gt; Certificate Management. Configure the Microsoft Certificate Authority.Click Edit.Configure the following values and click Save. Certificate Authority MicrosoftCA Server URLhttps://rpl-dc01.rainpole.local/certsrvUsernameadministratorPasswordadministrator_passwordTemplate NameVMware In the CA Server Certificate Details dialog, click Accept. Connect SDDC Manager to the Microsoft Certificate Authority using PowerVCF The following procedure demonstrates the process through PowerVCF.\nAssumption: You have already installed or imported PowerVCF on your system.\nProcedure\nBefore performing any operations on SDDC Manager using PowerVCF you must enter the credentials, the PowerVCF cmdlet Connect-VCFManager takes these credentials and stores them as a base64 string which is then used for each subsequent cmdlet. Enter the following syntax.\nConnect-VCFManager -fqdn lax01mgr01.lax.rainpole.local -username admin -password \"VMw@re1!\" The configuration for the Microsoft Certificate Authority can be performed using the Set-VCFMicrosoftCA cmdlet. Enter the following syntax.\nSet-VCFMicrosoftCA -serverUrl https://rpl-dc01.rainpole.local/certsrv -username Administrator -password VMw@re1! -templateName VMware We can then verify the configuration using the Get-VCFCertificateAuthConfiguration cmdlet. Enter the following syntax.\nGet-VCFCertificateAuthConfiguration And there we have it, we’ve now configured the Microsoft Certificate Authority in SDDC Manager.\nUseful Links If you would like to learn more about VMware Cloud Foundation or PowerVCF, check out these links:\nVMware Cloud Foundation Documentation VMware Cloud Foundation General FAQ VMware Cloud Foundation 3.9 Release Notes VMware Cloud Foundation 3.9.1 Release Notes PowerVCF Documentation PowerVCF PowerShell Library Download ","link":"http://jadenetworksolutions.co.uk/archive/2020/powervcf-certificates-02/","section":"archive","tags":["API","PowerShell","VCF"],"title":"PowerVCF - Connect SDDC Manager to the Microsoft Certificate Authority (Part 2)"},{"body":" This is the first of five blogs in a series that discusses Certificate Management with VMware Cloud Foundation. The series looks at the end to end process that you follow to take a freshly installed VMware Cloud Foundation platform (Management Domain) and replace the components with signed certificates using a Microsoft Certificate Authority.\nIn this post we will look at the configuration requirements on the Microsoft Certificate Authority server itself, failure to perform these additional configuration steps prior to attempting any procedures within the SDDC Manager User Interface or PowerVCF cmdlets will result in failures.\nFrom a high level this involves performing the following prerequisite configuration tasks:\nConfigure the Microsoft Certificate Authority for Basic Authentication Create and Add a Microsoft Certificate Authority Template Configure the Microsoft Certificate Authority for Basic Authentication Configure the Microsoft Certificate Authority for Certification Authority Web Enrollment and Basic Authentication, this is a requirement of SDDC Manager to allow it to talk to the Microsoft Certificate Authority to generate the signed certificates automatically.\nProcedure\nLog in to the Active Directory server by using a Remote Desktop Protocol (RDP) client. Add Active Directory Certificate Services. Click Start \u0026gt; Run, enter ServerManager, and click OK. From the Dashboard, select Add roles and features. In the Before you begin dialog, click Next. In the Select installation type dialog, click Next. In the Select destination server dialog, click Next. In the Select server roles dialog. Expand Active Directory Certificate Services, select Certification Authority and Certification Authority Web Enrollment. Add Roles and Features Wizard - Active Directory Certificate Services\nAdd Basic Authentication Feature to the Web Server (IIS). Expand Web Server (IIS) \u0026gt; Web Server \u0026gt; Security, select Basic Authentication. Click Next. Add Roles and Features Wizard - Web Server\nIn the Select features dialog, click Next. In the Confirm installation selections dialog, click Install. Configure the Certificate Authority Web Service and all sites (including default web site) for basic authentication.\nClick Start \u0026gt; Run, enter Inetmgr.exe and click OK. Expand Server \u0026gt; Sites \u0026gt; Default Web Site, and select CertSrv. Under the IIS section double-click Authentication. Under the Authentication widow, right-click Basic Authentication and select Enable. Restart the site to enable the basic authentication change.\nIn the navigator select Default Web Site. In the Actions window, under Manage Website click Restart. Create and Add a Microsoft Certificate Authority Template Next we need to set up a Microsoft Certificate Authority template on the Active Directory (AD) server. The template contains the certificate authority (CA) attributes for signing certificates for the SDDC components. After you create the template, you add it to the certificate templates of the Microsoft Certificate Authority.\nProcedure\nLog in to the Active Directory server by using a Remote Desktop Protocol (RDP) client.Click Start \u0026gt; Run, enter certtmpl.msc, and click OK.In the Certificate Template Console window, under Template Display Name, right-click Web Server and select Duplicate Template.In the Duplicate Template dialog box, and click OK.In the Properties of New Template dialog box, click the General tab.In the Template display name text box, enter VMware.Click the Extensions tab and configure the following.Select Application Policies and click Edit.Select Server Authentication, click Remove, and click OK.If present, select the Client Authentication policy, click Remove, and click OK.Select Key Usage and click Edit.Select the Signature is proof of origin (nonrepudiation) check box.Leave the defaults for all other options.Click OK.Click the Subject Name tab, ensure that the Supply in the request option is selected, and click OK to save the template.Add the new template to the certificate templates of the Microsoft CA.Click Start \u0026gt; Run, enter certsrv.msc, and click OK.In the Certification Authority window, expand the left pane, right-click Certificate Templates, and select New \u0026gt; Certificate Template to Issue.In the Enable Certificate Templates dialog box, select VMware, and click OK. And there we have it, we've now configured the Microsoft Certificate Authority server with the required configuration changes to allow SDDC Manager the ability to connect and interact.\nIf you would like to learn more about VMware Cloud Foundation or PowerVCF, check out these links:\nVMware Cloud Foundation Documentation VMware Cloud Foundation General FAQ VMware Cloud Foundation 3.9 Release Notes VMware Cloud Foundation 3.9.1 Release Notes PowerVCF Documentation PowerVCF PowerShell Library Download ","link":"http://jadenetworksolutions.co.uk/archive/2020/powervcf-certificates-01/","section":"archive","tags":["API","PowerShell","VCF"],"title":"PowerVCF - Configure the Microsoft Certificate Authority for VMware Cloud Foundation Integration (Part 1)"},{"body":" In this blog series I’m going to explore the capabilities provided in VMware Cloud Foundation that allow you to perform certificate management across components managed by SDDC Manager.\nThe capability to manage certificates was introduced a number of releases ago but with the release of version 3.9 the ability to perform these same operations were exposed via a number Public APs and now with the introduction of PowerVCF (see Introducing PowerVCF - Power to VI Admins) these operations can now be scripted using PowerShell.\nThis series of blogs will look at the end to end process that you follow to take a freshly installed VMware Cloud Foundation platform (Management Domain) and replace the components with signed certificates from a Microsoft Certificate Authority, this process is valid for other components deployed but for simplicity I’m going to focus on the Management Domain only. From a high-level the process is as follows:\nConfigure the Microsoft Certificate Authority for VMware Cloud Foundation Integration (Part 1) Connect SDDC Manager to the Microsoft Certificate Authority (Part 2) Generate Certificate Signing Request (CSR) Files for Each Component Managed by SDDC Manager (Part 3) Request Signed Certificates from Microsoft Certificate Authority (Part 4) Install Signed Certificates on Each Component Managed by SDDC Manager (Part 5) Each post in the series will focus on one of the specific steps from the above list and will provide the steps as it pertains to both the SDDC Manager User Interface and then the corresponding process using the PowerVCF cmdlets.\nUseful Links If you would like to learn more about VMware Cloud Foundation or PowerVCF, check out these links:\nVMware Cloud Foundation Documentation VMware Cloud Foundation General FAQ VMware Cloud Foundation 3.9 Release Notes VMware Cloud Foundation 3.9.1 Release Notes PowerVCF Documentation PowerVCF PowerShell Library Download ","link":"http://jadenetworksolutions.co.uk/archive/2020/powervcf-certificates/","section":"archive","tags":["API","PowerShell","VCF"],"title":"PowerVCF - Introduction to Certificate Management with VMware Cloud Foundation"},{"body":"","link":"http://jadenetworksolutions.co.uk/tags/cloud-builder/","section":"tags","tags":null,"title":"Cloud Builder"},{"body":" Back in December I was chatting with my good friend and colleague Brian O'Connell about automating a bunch of post configuration tasks within VMware Cloud Foundation using the new Public APIs, and it was during that conversation he shared a pet project he had been working on called PowerVCF, the idea behind PowerVCF being a way to allow VI Admin's to easily consume the new public APIs we began shipping with VMware Cloud Foundation much in the same way PowerNSX and PowerVRA come about.\nNOTE\nContributors working on PowerVCF are doing so during their spare time, and have day jobs.\nBrian started the project when v3.8.x was initially released but with v3.9 more Public APIs were added and he was struggling to find time to extend the capabilities of what he had started on his own. Based on my needs I agreed to roll up my sleeves and help out. Over the course of just over a month or so along with help from Giuliano Berteo we have added support for about 70% of the current Public APIs and to coincide with the release of VMware Cloud Foundation v3.9.1 have decided to release v1.0 of PowerVCF.\nTo make it easy to download and install, PowerVCF can be obtained from the PowerShell Gallery and documentation can be found on ReadTheDocs which is available at https://powervcf.readthedocs.io.\nNOTE\nPlease note that PowerVCF is not officially supported by VMware. It is provided without warranty and should not be used in a production environment without thoroughly testing first.\nOnce installed running the following command Get-Command -Module PowerVCF you will presented with this list of cmdlets, we plan to add more capabilities over the coming months, if your interested in contributing then please reach out! Useful Links VMware Cloud Foundation API Documentation PowerVCF GitHub Repository PowerVCF PowerShell Gallery Download PowerVCF Documentation Other PowerVCF Blog Posts Introducing PowerVCF – A PowerShell Module for the VMware Cloud Foundation API by Brian O'Connell Introducing PowerVCF by Giuliano Berteo Automating VMware Cloud Foundation with PowerVCF by by Brandon Willmott ","link":"http://jadenetworksolutions.co.uk/post/powervcf/powervcf-intro/","section":"post","tags":["API","PowerShell","VCF"],"title":"Introducing PowerVCF - Power to VI Admins"},{"body":"VMware Cloud Builder supports both VMware Cloud Foundation and VMware Validated Design deployments each of which have their own version numbers. VMware Cloud Builder also has its own version and build number and as we release new versions keeping track of which version supports which VMware Cloud Foundation and VMware Validated Design will become difficult. In attempt to keep track of this and help our customers I've created the below table:\nVMware Cloud Builder VCF VCF on VxRail VVD VVD on VxRail Version: 1.0.0.0 - Build: 11852205 X X v5.0.0 v5.0.0 - VxRail - v4.7.100 Version: 1.0.0.1 - Build: 12915705 X X v5.0.0 v5.0.0 - VxRail - v4.7.100 Version: 2.0.0.0 - Build: 12696155 v3.7.0.0 v3.7.0.0 v5.0.1 v5.0.1 - VxRail - v4.7.110 Version: 2.0.1.0 - Build: 13532358 v3.7.1.0 v3.7.1.0 v5.0.1 v5.0.1 - VxRail - v4.7.110 Version: 2.0.2.0 - Build: 13774914 v3.7.2.0 v3.7.2.0 X X Version: 2.1.0.0 - Build: 14172583 v3.8.0.0 v3.8.0.0 v5.1.0 v5.1.0 - VxRail - v4.7.212 Version: 2.1.1.0 - Build: 14487798 v3.8.1.0 v3.8.1.0 X X Version: 2.2.0.0 - Build: 14866160 v3.9.0.0 v3.9.0.0 X X Version: 2.2.1.0 - Build: 15345960 v3.9.1.0 v3.9.1.0 v5.1.1 v5.1.1 - VxRail - v4.7.410 ","link":"http://jadenetworksolutions.co.uk/archive/2020/cb-version-matrix/","section":"archive","tags":["Cloud Builder"],"title":"VMware Cloud Builder - Version Matrix"},{"body":"In order to implement a Software-Defined Data Center (SDDC) there are many VMware components that get implemented along with a number of prerequisite requirements. Some of the prerequisites we have full control over but many fall within the responsibility of the end customer. As a result in order to ensure the smoothest possible deployment its imperative that we have the ability to perform various pre-flight checks to help minimize and reduce the risk of costly failures during the deployment process.\nFor around 3 years within my business unit we had an internal deployment tool to automate the build out of the VMware Validated Design (VVD). Utilized by the VVD team, VMware Professional Services Organization and Certified Partners it has been used in numerous deployments both for internal and customer facing scenarios, during this time we have experienced first hand the impact of not having the ability to perform some level of pre-flight checking and as a direct result spent a lot of time developing auditing functionality built into the tool, with the shift to VMware Cloud Builder there was a gap as no such auditing functionality existed.\nPlatformAudit was originally a command line only utility developed to perform these various validation tasks against the platform being prepared and the data provided in the Deployment Parameter XLS file which is converted into a JSON file. Later we extended the reach with the introduction of REST APIs to allow us to expose the functionality into the web based user interface for VMware Validated Designs and VMware Cloud Foundation.\nThere you have it, a quick intro into what PlatformAudit is and why it exists, I will add some further posts around this topic so stay tuned.\n","link":"http://jadenetworksolutions.co.uk/archive/2019/cb-platformaudit-series-01/","section":"archive","tags":["Cloud Builder"],"title":"Part 1 - What is PlatformAudit?"},{"body":"","link":"http://jadenetworksolutions.co.uk/series/platformaudit/","section":"series","tags":null,"title":"PlatformAudit"},{"body":"","link":"http://jadenetworksolutions.co.uk/archive/2019/","section":"archive","tags":["index"],"title":"Posts"},{"body":"At VMworld 2019 in the US this year I was lucky enough to be able to present the breakout session HBI1259BU - Accelerate VMware Cloud Foundation with VMware Cloud Builder (don't worry if you were not able to attend and will be going to VMworld Europe in Barcelona in November I will be presenting again), during which a did a live demo on how to use PlatformAudit from the command line to speed up troubleshooting. The feedback I got was very positive so decided to write a few blog posts on the topic.\nPart 1 - What is PlatformAudit? Part 2 - Running PlatformAudit from the Command Line Basics Part 3 - PlatformAudit Modules Explained ","link":"http://jadenetworksolutions.co.uk/archive/2019/cb-platformaudit-series/","section":"archive","tags":["Cloud Builder"],"title":"VMware Cloud Builder - PlatformAudit Series"},{"body":"The question concerning what versions of VMware Validated Design are supported on what versions of VxRail has come up a number of times over the last couple of weeks, as a result we have had a new VMware Support KB article created to track. And for those that were not aware a similar VMware Support KB article already exists for VMware Cloud Foundation on VxRail, links to both KBs are here for future reference.\nSupported versions of VMware Validated Design on VxRail - KB74877 Supported versions of VMware Cloud Foundation on VxRail - KB67854 ","link":"http://jadenetworksolutions.co.uk/archive/2019/cb-vxrail-support/","section":"archive","tags":["Cloud Builder","VVD","VCF"],"title":"VxRail Support - VMware Cloud Foundation and VMware Validated Designs"},{"body":"VMware Cloud Builder - Logging and Log Collection\nVMware Cloud Builder is used to automate the deployment of VMware Cloud Foundation and VMware Validated Designs, during the initial bringup phase both solutions use the same components of the VMware Cloud Builder appliance:\nJsonGenerator - used to take the Excel file and generate the JSON file used by the bringup service PlatformAudit - used to perform both validation on the JSON file and the physical environment Bringup - orchestration service that carries out the installation and configuration of the VMware components Each of these components generate log files, should you encounter issues then these log files can be used to perform your troubleshooting and can also be provided to VMware Global Support Services (GSS).\nThe following illustrates the key path locations:\nComponent Log Name Location JsonGenerator jsongenerator-[time-stamp] /var/log/vmware/vcf/sddc-support/ PlatformAudit platform-audit-[time-stamp] /var/log/vmware/vcf/sddc-support/ Bringup Service vcf-bringup.log /opt/vmware/bringup/logs/ vcf-bringup-debug.log /opt/vmware/bringup/logs/ rest-api-debug.log /opt/vmware/bringup/logs/ Web UI server.log /opt/vmware/vvd/vvd-ui/server/user_data/logs/ access.log /opt/vmware/vvd/vvd-ui/server/user_data/logs/\nIn addition to reviewing the log files locally you can also generate a log bundle that can be provided to GSS, this is done using the Supportability and Serviceability Utility (SoS) from the command line of the appliance as follows:\nConnect to the VMware Cloud Builder Appliance using an SSH utility such as Putty. Login using admin and enter your password. Switch to root using su and enter your password. Change into the SoS Utility folder: cd /opt/vmware/sddc-support\nExecute SoS to collect the logs ./sos --cloud-builder-logs ","link":"http://jadenetworksolutions.co.uk/archive/2019/cb-logs/","section":"archive","tags":["Cloud Builder"],"title":"VMware Cloud Builder - Logging and Log Collection"},{"body":"Back in January VMware released VMware Cloud Builder v1.0, today March 19th VMware Cloud Builder v2.0 went GA, this is just a quick write up on the main What's New items for this release. If you didn't see my initial blog article on VMware Cloud Builder v1.0 you can find it here.\nWhat's New Supports for VMware Cloud Foundation v3.7 and VMware Validated Design v5.0.1 using the same OVA. With the release of VMware Cloud Builder v2.0 the biggest change is that we now support the automated deployment of both VMware Cloud Foundation and VMware Validated Designs using the same base OVA. When you deploy the OVA you pass a SKU value of vcf for VMware Cloud Foundation, vcf-vxrail for VMware Cloud Foundation on VxRail and vvd for VMware Validated Designs, depending on the value chosen the appliance on first boot will install and configured the correct user interface.\nMultiple software bundles. In this release we have broken down iso bundle from a single 24GB file into multiple files. Contained within the VMware Cloud Builder OVA itself we have the sddc-foundation-bundle.x.x.x.x-xxxxxxxx.iso file which contains the binaries for the foundation layer including ESXi, vCenter, NSX and SDDC Manager. This is used by both VMware Cloud Foundation and VMware Validated Designs. The sddc-vrealize-bundle.x.x.x.x-xxxxxxxx.iso file is downloaded separately and contains the binaries for the vRealize Suite and is used by the VMware Validated Designs workflows. The sddc-dr-bundle.x.x.x.x-xxxxxxxx.iso file is also downloaded separately and contains the binaries for Site Recovery Manager and vSphere Replication. Useful Links VMware Cloud Foundation 3.7 Release Notes VMware Cloud Foundation 3.7.0 Downloads VMware Validated Design for Software-Defined Data Center 5.0.1 Release Notes VMware Validated Design 5.0.1 Downloads ","link":"http://jadenetworksolutions.co.uk/archive/2019/cb-whats-new-v2/","section":"archive","tags":["Cloud Builder","VVD","VCF"],"title":"VMware Cloud Builder 2.0 - What's New"},{"body":"","link":"http://jadenetworksolutions.co.uk/categories/vmware-validated-designs/","section":"categories","tags":null,"title":"VMware Validated Designs"},{"body":"On January 23rd 2019 I posted the below blog article on blogs.vmware.com.\nBlog Post from blogs.vmware.com On January 22nd the Integrated Systems Business Unit (ISBU) released version 1.0 of VMware Cloud Builder a free virtual appliance that allows our customers to automate the deployment of VMware Validated Designs. In this post I will provide some background history and provide a bit of detail as to exactly what VMware Cloud Builder is and how it can be used.\nHistory Nearly four years ago, the ISBU embarked on a journey to develop a blueprint architecture for implementing a Software-Defined Data Center (SDDC) and thus VMware Validated Designs were born. As you can imagine the work involved to validate the blueprint required the team to repeatedly tear down and build up environments to validate operationally and develop the documentation we have come to know and love, an idea of using automation was hatched and a small team of developers set about building a tool that became known internally as VVD Deployment Toolkit (DTK). A short time after its inception whilst working for another team outside of the ISBU I convinced my now manager to release the DTK to VMware Professional Services and for around two and half years they used the DTK to implement many VMware Validated Design deployments delivering faster time-to-value for our customers. About twelve months ago we took the decision to migrate all of the automation from DTK over into the same orchestration engine that is used by VMware Cloud Foundation and with the release of VMware Validated Design v4.3 we replaced DTK with VMware Cloud Builder however this continued to be only made available for internal ISBU use and VMware Professional Services only until now….\nWhat is VMware Cloud Builder? VMware Cloud Builder is an appliance distributed as an Open Virtualization Appliance (OVA) package that manages the orchestration of deployment and configuration of an SDDC platform that adheres to the blueprint set out by VMware Validated Designs. What this means is that it’s not a general-purpose automation tool for just laying down some VMware products but rather it configures them based on the VMware Validated Design chosen. Once the appliance has been deployed you upload the VMware Validated Design Software Bundle which is a single ISO file containing all the VMware product binaries defined for that release of the VMware Validated Design, upload signed-certificates generated using CertGen (see KB 2146215) run the reconfigure.sh script to mount the ISO and perform some configuration steps and your all set. Only requirement is that you own the licenses for each component that is deployed and that you need to gather the deployment configuration using the relevant Deployment Parameters XLS file for the architecture, these can be download from my.vmware.com or directly from the VMware Cloud Builder appliance once deployed.\nThe VMware Validated Design Software Bundle contains the following VMware software binaries:\nVMware ESXi VMware vCenter Server VMware NSX for vSphere VMware vRealize Suite Lifecycle Manager VMware vRealize Operations Manager Management Packs for vRealize Operations Manager VMware vRealize Log Insight Content Packs for vRealize Log Insight VMware vRealize Automation VMware vRealize Business for Cloud VMware Site Recovery Manager VMware vSphere Replication What architectures can I deploy with VMware Cloud Builder? The VMware Validated Designs support a number of different architectures that have been developed to support different customer profiles. VMware Cloud Builder has been developed to be flexible enough to handle these different architectures and today supports the following:\nVMware Validated Design for Software-Defined Data Center – Region A VMware Validated Design for Software-Defined Data Center – Region B VMware Validated Design for Management and Workload Consolidation Home Page - VMware Cloud Builder User Interface\nWhat is the Deployment Parameters XLS File? When deploying the VMware Validated Designs using VMware Cloud Builder we provide levels of flexibility in that we can configure using customer defined naming conventions for objects such as hostnames, datacenters, clusters, datastores as well as allocation of IP addresses and networks. This customer specific information is captured in the excel workbook known as the Deployment Parameters XLS file.\nThe process of gathering this custom configuration involves siting down and populating the relevant Deployment Parameters XLS file. The configuration gathering process has been developed using an excel workbook as it provides the most flexible method for data gathering due to its portability and ease of updates.\nThe Deployment Parameters XLS file consists of a number of worksheets or tabs, each defined to collect specific types of data typically aligned with the discussions you have during the data gathering process with the target audiences such as roles and responsibilities within the organization.\nThe Deployment Parameters XLS file contains the following worksheets:\nPrerequisites Checklist – contains details concerning the preparation phase of the deployment and used to track the status of the preparation work. Management Workloads – from a data gathering stand-point used to capture the license keys used by each VMware solution. Also contains a footprint breakdown of all the management component virtual machines deployed as part of the architecture for reference. Users and Groups – captures service accounts and groups in Active Directory that are required by the deployment as well as all the passwords that are used. Hosts and Networks – captures all VLAN configuration details pertaining to the environment and the configuration details for each ESXi host. Deployment Parameters – captures product specific configuration options exposed for customization including hostnames, IP address, Active Directory, DNS and NTP configuration, vCenter objects and more. vRA Configuration – captures configuration details that should be applied to a tenant that is created within vRealize Automation. Run Parameters – provides the ability to manipulate how VMware Cloud Builder implements the SDDC platform such as instructing it to not use VSAN or not deploying a specific product. CertConfig – auto populated worksheet that pulls the required details for using the CertConfig utility to automate the creation of the configuration files used by CertGen to generate the signed certificates across all VMware solutions. Microsoft Excel - Deployment Parameter Workbook How does this all come together? Now we have a better understanding of VMware Cloud Builder and the supporting files that are available for download from my.vmware.com let’s describe the end-to-end workflow. The general flow is as follows:\nPrepare the environment by performing all the prerequisites as documented in the Deployment Guides: Prepare ESXi hosts Prepare UMDS virtual machine Prepare vRealize Automation IaaS Master VM Prepare SQL Server for vRealize Automation Prepare Site Recovery Manager Generate signed certificates Populate the Deployment Parameters XLS file. Download and deploy the VMware Cloud Builder appliance Upload the software bundle Upload the signed certificates Deploy the Software-Defined Data Center Generate the JSON file Audit the deployment parameters and target environment Deploy the Software-Defined Data Center Perform manual post-deployment procedures As you can see VMware Cloud Builder drastically reduces the procedures for deploying an SDDC platform allowing you to focus more of your time on delivering business benefits.\nConclusion With the release of VMware Cloud Builder, customers have a new tool to automate the deployment of a VMware Validated Design. Using VMware Cloud Builder not only accelerates the time to value for our customers, but it also ensures consistency with the VMware Validated Design from a deployment, configuration and operational readiness perspective.\n","link":"http://jadenetworksolutions.co.uk/archive/2019/cb-vvd-automation/","section":"archive","tags":["Cloud Builder","VVD"],"title":"Introducing VMware Cloud Builder, Automated Deployment of VMware Validated Designs"},{"body":"I work at VMware in the UK as a Senior Staff Solution Architect within the Cloud Infrastructure Business Group (CIBG) which is a global team responsible for the solution design for VMware Cloud Foundation, VMware Validated Solutions. I have been working in the IT industry for over 20+ years spending a large amount of this time working for various consulting organizations. Since 2005 I have specialized in Virtualization technologies. My blog is used to simply share my experiences and knowledge with others.\n","link":"http://jadenetworksolutions.co.uk/about/","section":"","tags":null,"title":"About"},{"body":"I recently had a requirement to get VMware PowerCLI installed and configured in order to work on developing some scripts. VMware introduced a new way of performing the installation which is well documented on the VMware official blog post however its still took me a little bit of time to work out the actual procedure. After a bit of googling and experimenting I decided to document the steps for future reference.\nPlatform: Windows Server 2012 R2 \u0026amp; Windows Server 2016\nDetermine the version of PowerShell currently installed, if your not running PowerShell 5.1 then perform step 2. 1$PSVersionTable.PSVersion Update PowerShell, in order to install modules using the new PowerShell Library I needed to update the version of PowerShell, this is done by installing a newer WMF. Download and install the WMF 5.1 package.\nSet the PowerShell execution policy to 'RemoteSigned'\n1Set-ExecutionPolicy RemoteSigned -Confirm:$false -Force To install the new PowerCLI for all users, open an administrative PowerShell session and use the -Scope command for AllUsers. 1Install-Module -Name VMware.PowerCLI -Scope AllUsers To import the modules and start using them run the following command: 1Get-Module -Name VMware* -ListAvailable | Import-Module To remove the 'Customer Experience Improvement Program (CEIP)' message run the following command: 1Set-PowerCLIConfiguration -Scope AllUsers -ParticipateInCEIP $true -Confirm:$false ","link":"http://jadenetworksolutions.co.uk/archive/2017/powercli-01/","section":"archive","tags":["PowerShell"],"title":"Installing PowerCLI 6.5.1"},{"body":"","link":"http://jadenetworksolutions.co.uk/archive/2017/","section":"archive","tags":["index"],"title":"Posts"},{"body":"","link":"http://jadenetworksolutions.co.uk/archive/2016/","section":"archive","tags":["index"],"title":"Posts"},{"body":"","link":"http://jadenetworksolutions.co.uk/tags/vra/","section":"tags","tags":null,"title":"vRA"},{"body":"","link":"http://jadenetworksolutions.co.uk/categories/vrealize-automation/","section":"categories","tags":null,"title":"vRealize Automation"},{"body":"Its been some months since I've had the opportunity to spend much time with vRealize Automation and so I was not aware of this apparent known issue but I thought I would post this blog anyway because I've seen some small differences with some of the blogs out there.\nFollowing the successful installation of vRealize Automation in a distributed configuration, when logging into the portal the Infrastructure tab displays the incorrect name as follows: The workaround is to reboot the vRealize Automation Appliances. In some cases this may require a couple of reboots. My recommendation is to reboot one at a time waiting for the first appliance to come back up before rebooting the second appliance.\n","link":"http://jadenetworksolutions.co.uk/archive/2016/vra-01/","section":"archive","tags":["vRA"],"title":"vRealize Automation Infrastructure Tab Appears with Incorrect Name"},{"body":"","link":"http://jadenetworksolutions.co.uk/tags/plugin/","section":"tags","tags":null,"title":"Plugin"},{"body":"","link":"http://jadenetworksolutions.co.uk/archive/2015/","section":"archive","tags":["index"],"title":"Posts"},{"body":"I recently had some issues trying to install the vCenter Server Appliance (VCSA) using the latest Update 1 release of vSphere.\nThe first problem I had was that even though I had the VMware Client Integration Plugin installed, on launching the install wizard it would not get detected. I had seen this issue in the past and started to do some research but was not able to find anything at the time to help fix it, but was able to overcome it by switching from Firefox to IE on that occasion, but this time I decided to have a dig around again and was pleasantly surprised to find a new KB2125623 article released on the 10-Sep-2015 with the fix.\nWith my second problem the issue itself did not appear when first launching the install wizard but rather after supplying the details for the target ESXi host in the Connect to target server dialog I got a yellow error banner across the top with no message. On this occasion I reached out to William Lam as I knew he had been doing some testing himself and he made me aware of an issue he had found where VMware Client Integration Plugin stopped functioning after update 45 of Chrome see his post http://www.virtuallyghetto.com/2015/09/quick-tip-fix-for-cip-no-longer-functioning-in-vsphere-web-client-after-chrome-45-update.htm. It turned out that the issue had been already identified and an updated version of the VMware Client Integration Plugin was needed to address it, whilst his post includes the links I thought I would add here also.\nClient Integration Plugin for Windows Client Integration Plugin for Mac OS X ","link":"http://jadenetworksolutions.co.uk/archive/2015/vcenter-01/","section":"archive","tags":["Plugin"],"title":"Quick Fix - VMware Client Integration Plugin Stops Working (vSphere 6 U1)"},{"body":"","link":"http://jadenetworksolutions.co.uk/categories/vcenter-server/","section":"categories","tags":null,"title":"vCenter Server"},{"body":"","link":"http://jadenetworksolutions.co.uk/tags/cloudclient/","section":"tags","tags":null,"title":"CloudClient"},{"body":"Now we have our tenant created, identity source added and roles assigned we can create a fabric group to assign access to the underlying computer resources.\nThe first step is to change the context of which we are connecting to the vRealize Automation system, this involves connecting to our newly created tenant instead of the system. Enter the following command-line syntax to authenticate to the tenant and the IaaS system. In this example we used the 'vra login userpass' command. For easy reference here are the parameters explained. Notice in the example above we are specifying the same credentials for both the tenant and the IaaS Service, this is because we assigned both the 'Tenant Admin' and Infrastructure Admin' roles to the account in my previous post. Now we are authenticated we can create the fabric group, enter the following command-line syntax: In this example we used the 'vra fabricgroup add' command. For easy reference here are the parameters explained. Notice when you issue the command a hexadecimal value is returned, make a note of this value as we will need it later. The previous step created the fabric group, but in order to allocate compute resources we need to perform a second step to tie the fabric group and compute resource together. For this we need to establish the unique identifier or Id for the compute resource. Enter the following command-line syntax to list all compute resources and make a note of the Id associated with the compute resource you want to assign. Finally we need to issue an update command to the fabric group to link the compute resource, for this process we need to supply the Id of the fabric group (the hexadecimal value displayed on completion of step 2) and the Id of the compute resource from the table in step 3. For the purpose of this we are going to assign the compute resource Id associated with the Payload-01 friendly name which relates to my vSphere Cluster. Enter the following command-line syntax: In this example we used the 'vra fabricgroup update' command. For easy reference here are the parameters explained. Once complete this is what it look likes inside the vRealize Automation UI. ","link":"http://jadenetworksolutions.co.uk/archive/2015/vcac-cloudclient-04/","section":"archive","tags":["vCAC","CloudClient"],"title":"Creating a Fabric Group and Assigning a Compute Resource - Part 4"},{"body":"","link":"http://jadenetworksolutions.co.uk/tags/vcac/","section":"tags","tags":null,"title":"vCAC"},{"body":"","link":"http://jadenetworksolutions.co.uk/categories/vcloud-automation-center/","section":"categories","tags":null,"title":"vCloud Automation Center"},{"body":"In my previous post, I covered the creation of a tenant using the CloudClient but before you can authenticate to the tenant you need to first assign the Identity Store that you want to use for assigning access rights, then you need to assign access for the two tenant roles 'Tenant Admin' and 'Infrastructure Admin'.\nAdding an Identity Store Launch the CloudClient and authenticate to the vRealize Automation system. (Refer to my previous article here). Enter the following command-line syntax to add an Identity Store to a tenant. In this example we used the 'vra tenant identitystore add' command. For easy reference here are the parameters explained. Assigning access to a Tenant Enter the following command-line syntax to assign access to the 'Tenant Admin' role of a tenant. Enter the following command-line syntax to assign access to the 'Infrastructure Admin' role of a tenant. In this example we used the 'vra tenant admin update' command. For easy reference here are the parameters explained. NOTE\nWith the release of v3.x of CloudClient some of the old command-line syntax associated with the 'vra tenant admin update' command have been deprecated. See the official documentation for further details.\n","link":"http://jadenetworksolutions.co.uk/archive/2015/vcac-cloudclient-03/","section":"archive","tags":["vCAC","CloudClient"],"title":"Adding an Identity Store and Assigning Access to a Tenant - Part 3"},{"body":"In this article I'm going to walk through the process of using CloudClient to create and delete tenants from vRealize Automation. I personally use this procedure to setup a consistent and repeatable environment when doing internal testing or building demo environments for developing our professional services offerings.\nCreating a Tenant Launch the CloudClient and authenticate to the vRealize Automation system. (Refer to my previous article here). Enter the following command-line syntax to create a new tenant. In this example we used the 'vra tenant add' command. For easy reference here are the parameters explained. Deleting a Tenant To delete the tenant we just created, enter the following command-line syntax. In this example we used the 'vra tenant remove' command. We only need to use one parameter as defined below. ","link":"http://jadenetworksolutions.co.uk/archive/2015/vcac-cloudclient-02/","section":"archive","tags":["vCAC","CloudClient"],"title":"Creating and Deleting a Tenant with CloudClient - Part 2"},{"body":"Before you can start using the CloudClient to perform command-line actions against your vRealize Automation (vRA) platform you have to authenticate to it. Whilst complete documentation is provided with the CloudClient download it does lack some examples of how to use the syntax, this post and others I'm yet to write will look to provide some of these examples based on my specific use cases.\nThe first step is to launch CloudClient, there are a couple of things to note here:\na) you will need a Java Runtime Environment installed on the system where you re running the command-line too from. b) the tool has two start-up scripts provide, one for Windows and one for Linux and these are now located in the /bin folder\nExecute the correct start-up script, for my scenario I'm using a Windows server so we need to run C:\\CloudClient\\bin\\cloudclient.bat. Assuming you have JVM installed correctly the CloudClient command-line tool will load and you will be presented with the following screen. Next we need to run the following command-line syntax to authenticate to the default tenant of the vRealize Automation system, from there we can run many commands against the platform. If you wanted to connect to a specific tenant and not the default tenant, then you can use the '--tenant' parameter as follows. In the examples above we used the 'vra login userpass' command, but the tool also provides the ability to use a keyfile with the 'vra login keyfile' command. Now lets look at each of the parameters used in this example. ","link":"http://jadenetworksolutions.co.uk/archive/2015/vcac-cloudclient-01/","section":"archive","tags":["vCAC","CloudClient"],"title":"Launching CloudClient and Authenticating to vRealize Automation - Part 1"},{"body":"Do you have the need for performing multiple tasks in an efficient manner, tired of using the web-based GUI interface to perform common tasks in vRealize Automation? Help is at hand in the shape of the vRealize CloudClient.\nvRealize CloudClient is a command–line utility that provides simplified command line access to vRealize Automation, vRealize Orchestrator and vCenter Site Recovery Manager functions. Essentially its an easy to use command-line wrapper for performing API functions across VMware's products and can easily be expanded to extend to further products in the future. It can be downloaded from here and is shipped independently from the vRealize Automation Release.\nA number of my colleagues have written some great blog posts over the last few months (see below) and I plan to add some very specific use cases of my own on this site in the coming months based on my day-to-day job.\nLaunching CloudClient and Authenticating to vRealize Automation - Part 1 Creating and Deleting a Tenant with CloudClient - Part 2 Adding an Identity Store and Assigning Access to a Tenant - Part 3 Creating a Fabric Group and Assigning a Compute Resource - Part 4 Andrea Sivero, a Senior Solutions Architect from VMware’s Professional Service Organization put together a great blog post that will jump start your CloudClient use.\nHave a Chat with Your SDDC (Automating the Management of the Management Portal-Part 2) Omer Kushmaro an Integration Engineering Architect at VMware discusses common use cases and provides examples on how to get started.\nvCAC (vRA) Cloud Client is GA! Looking for additional use case examples? Tom O’Rourke’s one of the founders of vRealize Automation (formally Dynamic Ops) has some sample scripts on his Clear as a Cloud Blogs.\nCloudClient is GA ","link":"http://jadenetworksolutions.co.uk/archive/2015/vcac-cloudclient/","section":"archive","tags":["vCAC","CloudClient"],"title":"What is the vRealize CloudClient"},{"body":"Prior to the release of vCloud Automation Center (vCAC) v5.2 there was no awareness or understanding of virtual machines protected through vCenter Site Recovery Manager. With the introduction of v5.2, VMware provided enhanced integration so that vCAC would correctly discover the relationship between the primary and recovery virtual machines.\nThese enhancements consisted of what could be considered minor modifications, albeit minor they were fundamental to ensuring that vCenter Site Recovery Manager (SRM) could successfully be implemented to the deliver disaster recovery of virtual machines managed by vCAC. So What’s Changed? When a virtual machine is protected by SRM a ‘Managed Object Reference ID’ or ‘MoRefID’ is created against the virtual machine record in the vCenter Server database.\nPrior to SRM v5.5 a single virtual machine property was created on the placeholder virtual machine object in the recovery site vCenter Server database called ‘ManagedBy:SRM,placeholderVM’, but vCAC did not inspect this value and so would attempt to add a second duplicate entry into its database, with the introduction of vCAC 5.2 when a data collection is run vCAC now ignores virtual machines with this value set to avoid this.\nIn addition to this SRM v5.5 introduced a second managed by property value which is placed on the virtual machine vCenter Server database record called ‘ManagedBy:SRM,testVM’ when a test recovery process is performed and data collection is run at the recovery site vCAC inspects this value and also ignores the virtual machines with this set to avoid creating a duplicate entry in the vCAC database.\nWith the changes highlighted above, SRM v5.5 and later and vCAC 5.2 and later can now be implemented in tandem with full awareness of the other. However one limitation still remains when moving a virtual machine into recovery or reprotect mode, vCAC does not properly recognize the move. To successfully perform these machine operations and continue being able to manage the machine life cycle, you must use the ‘Change Reservation’ operation, however this is still a manual task.\nIntroducing the CloudClient In performing the investigation around the enhancements between SRM and vCAC above, and on uncovering the need for the manual change of reservation I spent some time with our Cloud Solution Engineering team discussing the need for finding a way to automate this step. They were already developing a tool called CloudClient, which is essentially a wrapper for our API’s allowing simple command line driven steps to be performed and suggested that this could be developed to support this use case.\nConclusion In order to achieve a fully functional integration between vCloud Automation Center (5.2 or later) and vCenter Site Recovery Manager adhere to the following design decisions:\nConfigure vCloud Automation Center with endpoints for both the protected and recovery sites. Perform a manual / automatic change reservation following a vCenter Site Recovery Manager planned or disaster migration. Frequently Asked Questions Q: When I fail over my VMs from the protected site to the recovery site what happens when I request the built in vCAC machine operations?\nA: Once you have performed a ‘Planned Migration’ or a ‘Disaster Recovery’ process, as long as you have changed the reservation within the vCAC Admin UI for the VM, machine operations will be performed in the normal way on the recovered VM.\nQ: What happens if I do not perform the Change Reservation step to a VM once I’ve completed a ‘Planned Migration’ or ‘Disaster Recovery’ process and I then attempt to perform the built in vCAC machine operations on the VM?\nA: Depending on which tasks you perform, some things are blocked by vCAC and you see an error message in the log “The method is disabled by ‘com.vmware.vcDR’” and some actions look like they are being processed but nothing happens. There are also a few actions, which are processed regardless of the VM failure scenario; these are Change Lease and Expiration Reminder.\nQ: What happens if I perform a reprovision action on a VM that is currently in a ‘Planned Migration’ or ‘Disaster Recovery’ state?\nA: VCAC will reprovision the VM in the normal manner, which is that the hostname and IP Address (if assigned through vCAC) will be maintained. However the SRM recovery plan will now fail if you attempt to reprotect the VM back to the protected site as the original object being managed is replaced. It’s recommended that for blueprints where SRM protection is a requirement that you disable the ‘Reprovision’ machine operation.\n","link":"http://jadenetworksolutions.co.uk/archive/2015/vcac-dr/","section":"archive","tags":["vCAC"],"title":"vCloud Automation Center Disaster Recovery"},{"body":"","link":"http://jadenetworksolutions.co.uk/archive/2014/","section":"archive","tags":["index"],"title":"Posts"},{"body":"Replacing the self-signed certificate of any product with a CA Signed alterative is common place and in most security conscious organizations mandatory, whilst working on an internal project recently I attempted to achieve just that for my vCenter Log Insight Virtual Appliance.\nThe official VMware documentation posted here, in my opinion its very light in content on this subject in fact it only really describes how to replace the certificate by browsing for the .pem file and restarting the appliance. I’m no expert when it comes to SSL Certificates and so the whole process was a little bit of trial an error but thought I would share the process with the community in an effort to save others some time.\nFirstly, there are some specific requirements which are well documented these are:\nThe certificate file must contain both a valid private key and a valid certificate chain. The private key is generated by the RSA or the DSA algorithm. The private key is not encrypted by a pass phrase. If the certificate is signed by a chain of other certificates, all other certificates are included in the certificate file that you plan to import. The private key and all the certificates that are included in the certificate file are PEM-encoded. Log Insight does not support DER-encoded certificates and private keys. The private key and all the certificates that are included in the certificate file are in the PEM format. Log Insight does not support certificates in the PFX, PKCS12, PKCS7, or other formats. For the whole process I will be using OpenSSL tool for Windows, which I have installed to the C:\\OpenSSL folder.\nI also use the C:\\Certs folder to store the files being generated throughout the process, if you have ever read one of the VMware KB articles this will look familiar.\nThe end to end process can be split into following three stages, which is pretty standard of all VMware products where you want to replace the self-signed certificate:\nStage 1 – Generating the .csr file Launch a command prompt and navigate into the OpenSSL directory. In the C:\\Certs folder, create a folder for your Log Insight certificate files (C:\\Certs\\Log-Insight) Open a text editor on the system where OpenSSL is installed. Create a configuration file vCenter Log Insight containing the following values (items in red must be altered to match your environment), save the file. 1[ req ] 2default_md = sha512 3default_bits = 2048 4default_keyfile = rui.key 5distinguished_name = req_distinguished_name 6encrypt_key = no 7prompt = no 8string_mask = nombstr 9req_extensions = v3_req 10[ v3_req ] 11basicConstraints = CA:false 12keyUsage = digitalSignature, keyEncipherment, dataEncipherment 13extendedKeyUsage = serverAuth, clientAuth 14subjectAltName = DNS:hostname, IP: xx.xx.xx.xx, DNS: hostname.domain.com 15[ req_distinguished_name ] 16countryName = UK 17stateOrProvinceName = London 18localityName = London 190.organizationName = VMware 20organizationalUnitName = vCenter Log Insight 21commonName = hostname.domain.com Generate the .csr file by running the following command: 1openssl req -new -nodes -out C:\\Certs\\Log-Insight\\rui.csr -keyout C:\\Certs\\Log-Insight\\rui-orig.key -config C:\\Certs\\Log-Insight\\openssl-loginsight.cfg Convert the orig_rui.key into RSA format by running the following command: 1openssl rsa -in C:\\Certs\\Log-Insight\\rui-orig.key -out C:\\Certs\\Log-Insight\\rui.key Stage 2 – Obtaining the Certificate Now you have your .csr file, using the Microsoft Certificate Authority generate your certificate file. I've not documented the process as this is document in many other blog posts, for reference take a look at Derek Seaman's blog here.\nStage 3 – Installing the Certificate Launch a command prompt and navigate into the OpenSSL directory. Next we need to merge the certificate, private key and CA Chain by generating a .pfx file by issuing the following command: 1openssl pkcs12 -export -in C:\\Certs\\Log-Insight\\rui.crt -inkey C:\\Certs\\Log-Insight\\rui.key -certfile C:\\Certs\\Root64.cer -name rui -passout pass:testpassword -out C:\\Certs\\Log-Insight\\rui.pfx Now we need to convert the .pfx file into the format that the vCenter Log Insight Appliance accepts which is a .pem file by issuing the following command: 1openssl pkcs12 -nodes -in C:\\Certs\\Log-Insight\\rui.pfx -out C:\\Certs\\Log-Insight\\rui.pem Finally, you need to upload the rui.pem file into the appliance as per the VMware documentation. ","link":"http://jadenetworksolutions.co.uk/archive/2014/vrli-ssl-certs/","section":"archive","tags":["SSL Certificates"],"title":"Replacing the SSL Certificate for Microsoft CA Signed on vCenter Log Insight 1.5 Virtual Appliance"},{"body":"","link":"http://jadenetworksolutions.co.uk/tags/ssl-certificates/","section":"tags","tags":null,"title":"SSL Certificates"},{"body":"","link":"http://jadenetworksolutions.co.uk/categories/vmware-log-insight/","section":"categories","tags":null,"title":"VMware Log Insight"},{"body":"Ever wanted to limit the number of VMs being requested via the Self Service portal per request. I had a customer who wanted to do this recently, their use case was to prevent user input mistakes when requesting services. The default value in vCloud Automation Center (vCAC) 5.x is 999.\nJust to be clear this is not limiting the number of VMs a user can request based on a blueprint as a total or setting the number of VMs on a reservation.\nNOTE\nThis procedure needs to be performed on all Web Servers if you have multiple deployed.\nBrowse to the folder D:\\Program Files (x86)\\VMware\\vCAC\\Self-Service Portal\\Views\\Shared Make a copy of the ‘SpinEditRow.cshtml’ file and call it ‘SpinEditRow - vCAC 5.2 Original’ Edit the ‘SpinEditRow.cshtml’ file and amend the following line located on line 7: From: var spinnerMaxValue = this.Model.MaxValue.HasValue ? this.Model.MaxValue.Value : 999; To: var spinnerMaxValue = this.Model.MaxValue.HasValue ? this.Model.MaxValue.Value : 5;\nThen test the process of making a new request from the Self-Service portal, the ‘# of machines:’should now be restricted to a maximum of 5\nNOTE\nThis is not officially support by VMware and careful consideration should be given before making this alteration. An upgrade of vCAC 5.2 would alter this change back to its default value.\n","link":"http://jadenetworksolutions.co.uk/archive/2013/vcac-vm-requests/","section":"archive","tags":["vCAC"],"title":"Limiting VMs per request within the vCAC 5.2 Self-Service Portal"},{"body":"","link":"http://jadenetworksolutions.co.uk/archive/2013/","section":"archive","tags":["index"],"title":"Posts"},{"body":"Recently I had some fun and games with what should have been a pretty routine process of upgrading a customer’s vCenter 4.1 Server to vCenter 5.0 Update 1, as it turned out it was far from straightforward. The main background to my issue was that when performing the upgrade of the database, the progress bar did not move after twenty minutes, which indicated that there was an issue somewhere. There are various VMware KB available in relation to the symptoms I observed but none that actually provided the solution. As a general rule before proceeding with an upgrade I would recommend the following:\nCheck the Database Size and reduce where you can (The customer in question had a DB of 74GB and Transaction Log of 236GB) Run the upgrade logged in as the Service Account used to start the vCenter Services Elevate the Database account to ‘sysadmin’ for the purposes of the upgrade only Some suggested VMware KB Articles include: Database Size 1007453, Upgrade Issues 2011533, 1003960, 1025139 ","link":"http://jadenetworksolutions.co.uk/archive/2013/vcenter-upgrade/","section":"archive","tags":[],"title":"vCenter Upgrade to v5.x Failed - Useful Tips"},{"body":"To help manage your vCloud Automation Center (vCAC) implementation and the resources on which it depends, vCAC by default places limits on the number of concurrent instances of two particularly resource-intensive operations, machine provisioning and data collection. During a recent vCloud Suite implementation this particular default behavior caught my colleagues and I out as throughput when testing was very slow. On further investigation we established that the default value was two (2). For our implementation, we were looking to ensure the largest amount of throughput we could possible achieve without unnecessary impact to the platform. We have successfully tested setting this limit to eight (8) which allows eight machines to be provisioned at once. In order to amend this value here’s what you need to do:\nLog into your vCAC Server where the vCAC Manager Service (vCloud Automation Center) is running Locate the file ‘MachineService.exe.config’ file which can be located in the following directory ‘%SystemDrive%\\Program Files x86\\DynamicOps\\DCAC Server’ Locate the following value ‘MaxOutstandingResourceIntensiveWorkItems’ and amend the value to the desired requirement Save the file Restart the ‘vCloud Automation Center’ service Remember if you’re running a High Availability implementation to amend the setting on the ‘Stand-by’ system.\n","link":"http://jadenetworksolutions.co.uk/archive/2013/vcac-resources/","section":"archive","tags":["vCAC"],"title":"vCloud Automation Center 5.x – Resource Intensive Limits"},{"body":"Enabling PowerShell Functions with SRM - DR of the Cloud When calling PowerShell functions as part of a Site Recovery Manager (SRM) v5.1 recovery plan, you need to perform some additional configurations within PowerShell.\nThis can be achieved using the following procedures.\nStep 1 - Set the execution level Launch the 32-bit version of PowerShell. Set the execution policy to RemoteSigned. 1Set-ExecutionPolicy RemoteSigned Step 2 - Create and configure a PowerShell profile Verify if a profile already exists for the user. (assuming that one does not exist go to step 2) 1Test-Path $profile Force the creation of a new profile file. 1New-Item $profile -type file -force Open the new file in a Notepad session. 1Notepad $profile Enter the following syntax into the file, then save and close: 1Import-Module vCloudDR 2Add-PSSnapin -name VMware.VimAutomation.Core Next time you start a new PowerShell session, it will load in our custom functions from the vCloudDR module and add in the VMware core cmdlets.\nStep 3 - Install the custom modules for PowerShell to call Locate the folder path 'C:\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\Modules' Create a new folder called 'vCloudDR'. NOTE\nThis folder name must match the name used for the Import-Module command used in the profile in Step 2.\nCopy your custom module file into the newly created folder To test that the module has been loaded correctly, restart PowerShell and verify your custom module is listed by running the following command: 1Get-Module -ListAvailable ","link":"http://jadenetworksolutions.co.uk/archive/2013/srm-powershell/","section":"archive","tags":["SRM","PowerShell"],"title":" Enabling PowerShell Functions with SRM - DR of the Cloud"},{"body":"","link":"http://jadenetworksolutions.co.uk/categories/site-recovery-manager/","section":"categories","tags":null,"title":"Site Recovery Manager"},{"body":"","link":"http://jadenetworksolutions.co.uk/tags/srm/","section":"tags","tags":null,"title":"SRM"},{"body":"","link":"http://jadenetworksolutions.co.uk/archive/2012/","section":"archive","tags":["index"],"title":"Posts"},{"body":"Over the last few months I’ve had the opportunity to develop various commands to be run within Site Recovery Manager (SRM) recovery plans, during this time I’ve uncovered some interesting results and gotcha’s.\nCommand generated Errors If you look around there at various blog posts and community pages which provide an insight to running commands on the SRM Server, most of these suggest using a batch (.bat) or command (.cmd) file to call the script or run the command that you desire.\nThe problem with this approach is that the error state reported within the SRM recovery plan relates only to the success of failure of calling the batch or command file provided within the recovery plan.\nFor example, the following command, will call a file called callout.cmd located in the c:\\srm-scripts folder, if this file exists and can be called a 0 is returned to SRM and the step gets a Success status, if SRM is not able to call the file a 1 is returned and the SRM step gets a Warning status.\n1c:\\windows\\system32\\cmd.exe /c c:\\srm-scripts\\callout.cmd Calling PowerShell If you have ever used SRM you will know that currently (5.0 or earlier) SRM is still a 32-bit application even though it can run within a 64-bit operating system.\nMost of you will realize this when you setup the environment as it requires a 32-bit ODBC system DSN to connect to database. Well this run’s true when calling PowerShell, in order to call PowerShell you must use the following syntax otherwise nothing will happen.\n1C:\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\Powershell.exe Single Quotes v Double Quotes When running commands that have switches where you provide a value I’ve had different levels of success depending on the contents of the value being passed to the command. If you’re a programmer (which I’m not) you will know single quotes tell the command not to interpret anything inside the quotation marks whereas double quotes can be used to interpret the variables contained within.\nUsing double quotes created unusual behavior on some of our PowerShell commands recently for values that contained a space and passwords with strange characters. I’ve not been able to find any SRM documentation that provides guidance on this but would suggest always using single quotes.\nCalling Linux Scripts Traditionally my clients have been 100% Windows shops, and when looking for guidance on SRM and calling scripts on Linux machines there is a distinct lack of discussions or information available. On a recent engagement this is exactly what I needed to do, but thanks to my colleague and SRM guru Lee Dilworth the answer is very simply use the following syntax:\n1/bin/sh /srm-scripts/callout.sh ","link":"http://jadenetworksolutions.co.uk/archive/2012/srm-commands/","section":"archive","tags":["SRM"],"title":"Running Commands with SRM 5.x "},{"body":"Question. According to this KB http://kb.vmware.com/kb/1026326, Windows VMs in vCloud Director need to be configured with DHCP to be able to join a Microsoft Active Directory domain. I have a VM with a static IP address. How do I get around this requirement?\nAnswer. The issue around DHCP is Microsoft-related and not VMware. The problem is that we rely on Sysprep to perform the customization and this is where the DHCP requirement comes in. As a workaround, we ran a script called SetupCommand.cmd which calls the netdom.exe command with the following syntax:\n1netdom.exe join %COMPUTERNAME% /Domain:vmware.com /OU:OU=vApp-VMs,DC=vmware,DC=com /Userd:???? /PasswordD:???? /Reboot To configure this: Before submitting the vApp to the catalog. Right click the VM and select Properties. Select the Guest OS Customization tab. Scroll down to the Customization Script sections and enter the command. ","link":"http://jadenetworksolutions.co.uk/archive/2012/join-vcd-ad/","section":"archive","tags":["vCloud Director"],"title":"Joining a VM to a Domain with vCloud Director"},{"body":"","link":"http://jadenetworksolutions.co.uk/tags/vcloud-director/","section":"tags","tags":null,"title":"vCloud Director"},{"body":"","link":"http://jadenetworksolutions.co.uk/tags/dell-compellent/","section":"tags","tags":null,"title":"Dell Compellent"},{"body":"I was recently involved in an engagement to implement Site Recovery Manager (SRM) 5 with a Dell Compellent storage solution. During the engagement we had various issues around how to implement the Dell components. Dell have produced a best practice document but some elements of the document are a little light on the ground. This blog is a collection of tested procedures that we followed to prove the solution.\nSetting up the Environment During our testing we setup the environment using the following steps:\nSet up the LUNs and replication using Compellent Enterprise Manager client. Save the restore points using Enterprise Manager client. This is a manual process that Dell talks about within their Best Practice guide and must be done after all major SRM events. Set up datastores in vSphere and present them to the appropriate hosts. Create a Protection Group(s) in SRM for the newly created datastores. Create a Recovery Plan(s) in SRM for the newly created datastores. Configure SRM debug logging in both Data Collectors to collect SRM information. (We did this step in order to capture detailed logging to provide Dell if required.) Confirmed that the SiteA SRA was talking to the remote data collector (hosted in SiteA) and the SiteB SRA was talking to primary data collector (hosted in SiteB, as per Compellent Best Practice. NOTE\nThis configuration is not 100% clear in the best practice document and we were provided conflicting information from Dell Support when we asked for verification, the document did not define Primary vs Remote Data Collectors and simply referred to Enterprise Manager in both sites.\nDefining the Failover Procedure We defined the following procedure to be run during a failover type of Disaster Recovery:\nRun the Recovery Plan, selecting Disaster Recovery as the recovery type. Save the restore points using Enterprise Manager client, ignoring the inactive ones flagged. NOTE\nThe Compellent Best Practice document says that these can be removed, but our testing showed that this created errors at the re-protect stage so we skipped this process.\nRe-protect (to reverse replication) Save the restore points using Enterprise Manager client. Defining the Failback Procedure We defined the following procedure to be run during a failback type of Disaster Planned Migration:\nRun the same Recovery Plan as used for the Failover procedure, selecting Planned Migration as the recovery type. Save the restore points using Enterprise Manager client, ignoring the inactive ones flagged. NOTE\nThe Compellent Best Practice document says that these can be removed, but our testing showed that this created errors at the re-protect stage so we skipped this process.\nRe-protect (to reverse replication). Save the restore points using Enterprise Manager client. Test Scenarios After defining the procedures we then carried out the following tests to verify the process.\nTest 1 - Both Compellent Enterprise Manager Data Collectors Running Ensuring both data collectors were up and running, the failover procedure was run for the following scenarios:\nDR from SiteB to SiteA, virtual machine TESTVM001, hosted on datastore SRMTest_1 DR from SiteA to SiteB, virtual machine TESTVM001, hosted on datastore SRMTest_2 Both failovers completed without error, so we then followed the failback procedure to bring everything back to where it started. Both failback procedures completed without error.\nTest 2 - Primary Data Collector Shut Down Shutting down the primary data collector hosted at SiteB, we simulated a failure of SiteB and then ran the following scenario:\nDR from SiteB to SiteA, virtual machine TESTVM001, hosted on datastore SRMTest_1 The failover completed successfully, but with a number of errors at the following stages of the recovery plan:\nPre-Synchronise Storage Prepare Protected Site FMs for Migration Synchronise Storage None of these errors were fatal but they did mean that a re-protect of the protection group could not be completed until they had been resolved. This meant running a second Recovery once the Primary data collector was back online, this then completed successfully and then allowed a re-protect to run.\nWith both data collectors online, the failback procedure was then run to bring everything back to where it started. This completed without error.\nTest 3 - Remote Data Collector Shut Down Shutting down the remote data collector hosted in SiteA, we simulated a failure of SiteA and then ran the following scenario:\nDR from SiteA to SiteB, virtual machine TESTVM002, hosted on datastore SRMTest_2 This failover completed successfully, but with the same non-critical errors as seen in test 2 along the way. Resolution was the same as test 2, bringing the remote data collector back online and then running a second Recovery. This completed successfully and allowed a re-protect to run.\nWith both data collectors online, the failback procedure was then run to bring everything back to where it started. This completed without error.\n","link":"http://jadenetworksolutions.co.uk/archive/2012/srm-dell-compellent/","section":"archive","tags":["SRM","Dell Compellent"],"title":"SRM 5 \u0026 Dell Compellent Best Practice Procedures"},{"body":"","link":"http://jadenetworksolutions.co.uk/tags/hds-storage/","section":"tags","tags":null,"title":"HDS Storage"},{"body":"These are notes on how to setup Site Recovery Manager (SRM) with HDS Storage using a command control device.\nIf using a VM for the SRM server ensure the following are configured before attempting to install the SRM components:\nRDM presented to the SRM VM, attached, initialized, but not formatted or assigned a drive letter. Install Hitachi RAID-Manger/Command Control Interface to setup the HORCM service (Protected site HORCM0 \u0026amp; Recovery Site HORCM1). Configure the horcm0.conf and horcm1.conf files on the respective SRM Servers. Start HORCM service (you will need to alter the name of the run config file located in the C:\\HORCM\\Tools, to match the service name 0 or 1. Test connection locally using C:\\HORCM\\Tools\\pairdisplay –g GRP1 –l (for local check) and pairdisplay –g GRP1 –fcx (remote side check), alter GRP1 to match the Group defined in your HORCM.conf file. Frequently Asked Questions Q: Does the SRA work at an individual Hitachi LUN level or HUR (Hitachi Universal Replicator) journal level ?\nA: HUR keeps all LUN pairs in the JNL group in the same status so if the pairs are split for a failover, all pairs in the JNL groups are split. The SRA cannot override this behavior. To split a single LUN it must be in a JNL group without any other LUNs.\nQ: Can SRA do split/sync for just one LUN ?\nA: Yes, depending on the configuration of HORCM but this is possible. The HUR pairs need to be created as single LUN/JNL group.\nQ: If we have multiple LUN's in same journal does it split all LUN's at same time?\nA: Yes\nQ: Does the SRA start a reverse sync immediately (Reverse P-VOL and S-VOL) once the secondary site is brought up?\nA: With SRM 4, HUR / TC do horctakeover so replication is reversed and if possible resync is run in the reverse direction. This behavior was changed for SRM 5 to support the additional functions. SRM 5 will only split and reverse the replication but will not resync until the reverseReplication function is called.\nQ: Do we have to create a separate HUR journal for each LUN, for individual LUN failover/failback?\nA: A separate JNL Group.\nUseful links http://www.hds.com/assets/pdf/hitachi-storage-replication-adapter-software-vmware-vcenter-site-recovery-manager-deployment-guide.pdf http://www.hds.com/solutions/applications/vmware/download.html\n","link":"http://jadenetworksolutions.co.uk/archive/2012/srm-hds-storage/","section":"archive","tags":["SRM","HDS Storage"],"title":"Installing SRM with HDS Storage"},{"body":"I don’t know how much experience any of you have in delivering the Spring Source Pet Clinic application which can be used as a good sample application when delivering VMware vCloud Director (vCD). Based on recent experience I thought I would share:\nPet Clinic Spring Source Sample Application – The Pet Clinic application is a simple two VM application running on CentOS, it consist of a one VM running Tomcat and IMDB and a second VM running Apache Web Server.\nThe application is deployed using OVF import into a vSphere infrastructure and has the default configuration:\nVM Description Tomcat and IMDB Server Apache Server Hostname pc-vm-0-0 pc-vm-1-0 IP Address 192.168.2.101 192.168.2.100 Root Password napa napa Deploy the application and alter the IP Address as in my case to test the vSphere Infrastructure the following files need to be edited: Tomcat \u0026amp; Apache Server /etc/hosts (Alter the local host entry to match new IP Address) /etc/sysconfig/network (Alter the default gateway) /etc/sysconfig/networking/network-scripts/ifcfg-eth0 (Alter the servers IP Address) Apache Server Only /etc/httpd/conf.d/proxy.conf (Alter the IP Address of the DB Server) Deploying the Pet Clinic application and proving the web service. If you know much about vCD then you will be aware that there are many ways to hook up network connectivity, on a recent engagement I devised the following scenario’s to demonstrate to my customer, the key element I was looking to show was the ability to deploy multiple copies of the Pet Clinic application with the default system configuration detailed in my earlier post. Scenario One – Internal Organisation Network\nMultiple Pet Clinic vApps with a vApp Network of 192.168.2.x, each vApp Network is connected to the Internal Organisation Network through a vShield Edge with only NAT enabled, this allocates an IP address from the Org Network to each VM within the vApp.\nWindows management VM deployed directly on the Org Network, application proving is then done through vCD Remote Console onto this VM. A web connection is then made using a NATed IP to test the Pet Clinic application.\nScenario Two – External Organisation Network directly connected\nAdd a Windows VM into the Pet Clinic vApp and then deploy multiple Pet Clinic vApps with two vApp Networks. Network one using 192.168.2.x, and network two using 192.168.3.x. All three VMs are attached to the 192.168.2.0 network to allow the application to function as normal and the Windows VM has a second NIC set as the primary to the 192.168.3.x network.\nThe vApp is then connected to the External Organisation Network through a vShield Edge with NAT enabled on the 192.168.3.x network only. This provide the Windows VM with an IP address on the customers corporate LAN giving a direct RDP connection to the Windows VM in order to test and alter the application. The reason for creating the second vApp network was to limit the number of IPs needed when the vApp is powered as the customer could only provide 10 IPs.\nAdditional Management\nI additionally deployed a second management VM directly on the External Organisation Network and allocated two network cards one connected to it and the second attached to the Internal Organisation Network, this provided the added benefit of a jump box to allow access to the vApps deployed within the Internal Organisation. From the jump box the NATed IP of the Pet Clinic application can be used to access the application.\nAs I said before there are plenty of choices when configuring vCD and the above is just what I’ve set up recently to demonstrating the capabilities.\n","link":"http://jadenetworksolutions.co.uk/archive/2011/pet-clinic/","section":"archive","tags":["vCloud Director"],"title":"Pet Clinic Application - vCloud PoC"},{"body":"","link":"http://jadenetworksolutions.co.uk/archive/2011/","section":"archive","tags":["index"],"title":"Posts"},{"body":"","link":"http://jadenetworksolutions.co.uk/tags/vcd/","section":"tags","tags":null,"title":"vCD"},{"body":"In November 2011 VMware released the latest version of their free tool called vCloud Connector. The purpose of this application is to enable customers to migrate virtual machines between vSphere, Private vCloud and Public vCloud platforms. With the latest release there have been various enhancements which include:\nDirect Connectivity to vcloud.vmware.com New Architecture With the release of v1.5 the vCloud Connector architecture has been re-designed. VMware has created three distinct components:\nvCloud Connector UI - The vCloud Connector UI is the user interface, this can be presented to the vSphere Client or vcloud.vmware.com. vCloud Connector Server - The vCloud Connection Server is a virtual appliance that is deployed to manage and coordinate tasks. vCloud Connector Node - The vCloud Connector Nodes are virtual appliances that handle the transfer of content from one cloud to another. ","link":"http://jadenetworksolutions.co.uk/archive/2011/vcloud-connector/","section":"archive","tags":["vCD"],"title":"vCloud Connector v1.5"},{"body":"","link":"http://jadenetworksolutions.co.uk/categories/vcloud-director/","section":"categories","tags":null,"title":"vCloud Director"},{"body":"As I continue to help customers build out their private clouds using VMware vCloud Director I'm finding that I'm personally needing to build up my Linux skills (I come from a Windows background like a lot of VMware users) so I've created this post to bring all this information into one spot. As I find additional useful commands I will update. Enjoy !!\nDisable Firewall By default the Firewall service within Red Hat is enabled, when setting up the vCloud Director cells this will stop you from being able to hit the url once installed. Use the following commands to check and configure the firewall:\nCheck the firewall status 1/etc/init.d/iptables status Disable the firewall service 1/etc/init.d/iptables save 2/etc/init.d/iptables stop 3chkconfig iptables off or\n1service iptables save 2service iptables stop 3chkconfig iptables off Viewing Logs Using Tail When deploying the VMware vCloud Director cells, you will need to monitor the services starting in case any issues occur (DNS is always a good one). The Linux tail command is useful in this situation, by default tail will print the last 10 lines but with some additional values we can display more lines and follow the output as it changes. This can be achieved using the following commands:\n1tail –f -n 50 /opt/vmware/vcloud-director/logs/cell.log Checking Version of Red Hat If you want to double check the version of Red Hat your running then the following command can be issued:\n1tail /etc/redhat-release ","link":"http://jadenetworksolutions.co.uk/archive/2011/redhat-cmds/","section":"archive","tags":["Linux"],"title":"Handy RedHat Commands"},{"body":"","link":"http://jadenetworksolutions.co.uk/tags/linux/","section":"tags","tags":null,"title":"Linux"},{"body":"","link":"http://jadenetworksolutions.co.uk/tags/index/","section":"tags","tags":null,"title":"index"},{"body":"","link":"http://jadenetworksolutions.co.uk/series/vcf-backup/restore/","section":"series","tags":null,"title":"VCF Backup/Restore"}]